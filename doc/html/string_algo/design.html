<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Design Topics（设计讨论）</title>
<link rel="stylesheet" href="../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.73.2">
<link rel="start" href="../index.html" title="The Boost C++ Libraries BoostBook Documentation Subset">
<link rel="up" href="../string_algo.html" title="Chapter 17. Boost String Algorithms Library">
<link rel="prev" href="quickref.html" title="Quick Reference">
<link rel="next" href="concept.html" title="Concepts">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../boost.png"></td>
<td align="center"><a href="../../../index.html">Home</a></td>
<td align="center"><a href="../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="quickref.html"><img src="../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../string_algo.html"><img src="../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="concept.html"><img src="../../../doc/html/images/next.png" alt="Next"></a>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="string_algo.design"></a>Design Topics（设计讨论）</h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="design.html#string_algo.string">string 表示法</a></span></dt>
<dt><span class="section"><a href="design.html#string_algo.sequence_traits">序列特征</a></span></dt>
<dt><span class="section"><a href="design.html#string_algo.find">查找算法</a></span></dt>
<dt><span class="section"><a href="design.html#string_algo.replace">替换算法</a></span></dt>
<dt><span class="section"><a href="design.html#string_algo.split">查找迭代器 &amp; 分割算法</a></span></dt>
<dt><span class="section"><a href="design.html#string_algo.exception">异常安全</a></span></dt>
</dl></div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="string_algo.string"></a>string 表示法</h3></div></div></div>
<p>顾名思义，本库主要是和 strings 一起工作的。然而，在本库的语境中，一个 string 并不局限于任何特定的实现（比如 <code class="computeroutput">std::basic_string</code>），而是一个概念。这就允许本库的算法为任何满足给定要求的 string 类型所复用。</p>
<p><span class="bold"><strong>定义：</strong></span>一个 string 就是一个可以用连续有序方式访问的 characters 的 <a href="../../../libs/range/doc/range.html" target="_top">range</a>。character 是任何带有“廉价”拷贝和赋值的值类型（基于上文所述原因，译文中的 character 和 string 一律保留原文，而不译为字符和字符串——译者）。</p>
<p>string-type 的第一个要求是必须可以用 <a href="../../../libs/range/index.html" target="_top">Boost.Range</a> 访问。这一便利条件允许以一种统一的给予迭代器的方式访问 string 中的元素。这对于我们的库来说已经足够了。</p>
<p>第二个要求清楚地规定了 characters 存储在 string 中的方法。本库中的算法在工作时假设拷贝一个 character 是比较廉价的，并因此分配额外的存储空间以缓存结果。对于普通字符类型来说这是一个正常的假设。即使这个要求没有被满足，算法也可以工作，但要付出性能降低的代价。</p>
<p>另外，有些算法对 string-type 有额外的要求。特别是，那些可以创建一个给定类型的新 string 的算法。在这种情况下，它要求这个类型满足序列 (Std §23.1.1) 要求。</p>
<p>在参考和代码中，对 string 类型的要求通过模板参数的名字表现出来。<code class="computeroutput">RangeT</code> 意味着基本的 range 要求必须有效。<code class="computeroutput">SequenceT</code> 表明扩展的序列要求。</p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="string_algo.sequence_traits"></a>序列特征</h3></div></div></div>
<p><code class="computeroutput">std::list</code> 和 <code class="computeroutput">std::vector</code> 的最大不同不在于它们提供的接口，而在于类的内部细节以及它执行各种操作的方法。问题是不依靠任何特殊机制而仅仅通过类的定义不可能推断出这些不同。但是，有些算法在了解了特定容器的性质后运行速度会有大幅度的提升。</p>
<p>序列特征允许开发者指定一个序列容器的额外性质（参见 Std §23.2）。因此这些性质可以被算法用来为某些操作选择优化处理。这些序列特性声明在头文件 <code class="computeroutput"><a class="link" href="reference.html#header.boost.algorithm.string.sequence_traits.hpp" title="Header &lt;boost/algorithm/string/sequence_traits.hpp&gt;">boost/algorithm/string/sequence_traits.hpp</a></code> 中。</p>
<p>在下表中，C 表示一个容器，而 c 是 C 的一个对象。</p>
<div class="table">
<a name="id3487009"></a><p class="title"><b>Table 17.12. 序列特征</b></p>
<div class="table-contents"><table class="table" summary="Sequence Traits">
<colgroup>
<col>
<col>
</colgroup>
<thead><tr>
<th align="left">特征</th>
<th align="left">说明</th>
</tr></thead>
<tbody>
<tr>
<td align="left">
<code class="computeroutput"><a class="link" href="../boost/algorithm/has_native_replace.html" title="Class template has_native_replace">has_native_replace&lt;C&gt;</a></code>::value</td>
<td align="left">表明这个序列具有类似 std::string 的替换方法。</td>
</tr>
<tr>
<td align="left">
<code class="computeroutput"><a class="link" href="../boost/algorithm/has_stable_iterators.html" title="Class template has_stable_iterators">has_stable_iterators&lt;C&gt;</a></code>::value</td>
<td align="left">表明这个序列具有稳定的迭代器。这也就意味着，像 <code class="computeroutput">insert</code>/<code class="computeroutput">erase</code>/<code class="computeroutput">replace</code> 这样的操作不会导致迭代器失效。</td>
</tr>
<tr>
<td align="left">
<code class="computeroutput"><a class="link" href="../boost/algorithm/has_const_time_insert.html" title="Class template has_const_time_insert">has_const_time_insert&lt;C&gt;</a></code>::value</td>
<td align="left">表明序列的 insert 方法具有常量时间复杂度。</td>
</tr>
<tr>
<td align="left">
<code class="computeroutput"><a class="link" href="../boost/algorithm/has_const_time_erase.html" title="Class template has_const_time_erase">has_const_time_erase&lt;C&gt;</a></code>::value</td>
<td align="left">表明序列的 erase 方法具有常量时间复杂度。</td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><p>
            Current implementation contains specializations for std::list&lt;T&gt; and
            std::basic_string&lt;T&gt; from the standard library and SGI's std::rope&lt;T&gt; and std::slist&lt;T&gt;.
        </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="string_algo.find"></a>Find Algorithms</h3></div></div></div>
<p>
            Find algorithms have similar functionality to <code class="computeroutput">std::search()</code> algorithm. They provide a different 
            interface which is more suitable for common string operations. 
            Instead of returning just the start of matching subsequence they return a range which is necessary 
            when the length of the matching subsequence is not known beforehand. 
            This feature also allows a partitioning of  the input sequence into three 
            parts: a prefix, a substring and a suffix. 
        </p>
<p>
            Another difference is an addition of various searching methods besides find_first, including find_regex. 
        </p>
<p>
            It the library, find algorithms are implemented in terms of 
            <a class="link" href="concept.html#string_algo.finder_concept" title="Finder Concept">Finders</a>. Finders are used also by other facilities 
            (replace,split).
            For convenience, there are also function wrappers for these finders to simplify find operations.
        </p>
<p>
            Currently the library contains only naive implementation of find algorithms with complexity 
            O(n * m) where n is the size of the input sequence and m is the size of the search sequence. 
            There are algorithms with complexity O(n), but for smaller sequence a constant overhead is 
            rather big. For small m &lt;&lt; n (m by magnitude smaller than n) the current implementation 
            provides acceptable efficiency. 
            Even the C++ standard defines the required complexity for search algorithm as O(n * m). 
            It is possible that a future version of library will also contain algorithms with linear 
            complexity as an option
        </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="string_algo.replace"></a>Replace Algorithms</h3></div></div></div>
<p>
            The implementation of replace algorithms follows the layered structure of the library. The 
            lower layer implements generic substitution of a range in the input sequence. 
            This layer takes a <a class="link" href="concept.html#string_algo.finder_concept" title="Finder Concept">Finder</a> object and a 
            <a class="link" href="concept.html#string_algo.formatter_concept" title="Formatter concept">Formatter</a> object as an input. These two 
            functors define what to replace and what to replace it with. The upper layer functions 
            are just wrapping calls to the lower layer. Finders are shared with the find and split facility. 
        </p>
<p>
            As usual, the implementation of the lower layer is designed to work with a generic sequence while
            taking advantage of specific features if possible 
            (by using <a class="link" href="design.html#string_algo.sequence_traits" title="Sequence Traits">Sequence traits</a>)
        </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="string_algo.split"></a>Find Iterators &amp; Split Algorithms</h3></div></div></div>
<p>
            Find iterators are a logical extension of the <a class="link" href="design.html#string_algo.find" title="Find Algorithms">find facility</a>.
            Instead of searching for one match, the whole input can be iteratively searched for multiple matches.
            The result of the search is then used to partition the input. It depends on the algorithms which parts 
            are returned as the result. They can be the matching parts (<code class="computeroutput"><a class="link" href="../boost/algorithm/find_iterator.html" title="Class template find_iterator">find_iterator</a></code>) of the parts in
            between (<code class="computeroutput"><a class="link" href="../boost/algorithm/split_iterator.html" title="Class template split_iterator">split_iterator</a></code>). 
        </p>
<p>
            In addition the split algorithms like <code class="computeroutput"><a class="link" href="../boost/algorithm/find_all.html" title="Function template find_all">find_all()</a></code> and <code class="computeroutput"><a class="link" href="../boost/algorithm/split_id2965593.html" title="Function template split">split()</a></code>
            can simplify the common operations. They use a find iterator to search the whole input and copy the 
            matches they found into the supplied container.
        </p>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h3 class="title">
<a name="string_algo.exception"></a>Exception Safety</h3></div></div></div>
<p>
            The library requires that all operations on types used as template
            or function arguments provide the <span class="emphasis"><em>basic exception-safety guarantee</em></span>. 
            In turn, all functions and algorithms in this library, except where stated
            otherwise, will provide the <span class="emphasis"><em>basic exception-safety guarantee</em></span>.
            In other words:
            The library maintains its invariants and does not leak resources in
            the face of exceptions.  Some library operations give stronger
            guarantees, which are documented on an individual basis.
        </p>
<p>
            Some functions can provide the <span class="emphasis"><em>strong exception-safety guarantee</em></span>.
            That means that following statements are true:    
            </p>
<div class="itemizedlist"><ul type="disc">
<li>
                    If an exception is thrown, there are no effects other than those
                    of the function 
                </li>
<li>
                    If an exception is thrown other than by the function, there are no effects
                </li>
</ul></div>
<p>
            This guarantee can be provided under the condition that the operations 
            on the types used for arguments for these functions either
            provide the strong exception guarantee or do not alter the global state .
         </p>
<p>
            In the reference, under the term <span class="emphasis"><em>strong exception-safety guarantee</em></span>, we mean the
            guarantee as defined above.            
        </p>
<p>
            For more information about the exception safety topics, follow this 
            <a href="http://www.boost.org/more/generic_exception_safety.html" target="_top">link</a>
        </p>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"><p><small>Last revised: February 27, 2008 at 15:00:24 -0500</small></p></td>
<td align="right"><div class="copyright-footer">Copyright © 2002-2004 Pavol Droba<p>Use, modification and distribution is subject to the Boost
                Software License, Version 1.0. (See accompanying file
                <code class="filename">LICENSE_1_0.txt</code> or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
            </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="quickref.html"><img src="../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../string_algo.html"><img src="../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="concept.html"><img src="../../../doc/html/images/next.png" alt="Next"></a>
</div>
</body>
</html>
