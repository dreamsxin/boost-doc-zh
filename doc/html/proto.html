<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Chapter 15. Boost.Proto</title><link rel="stylesheet" href="boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.73.2">
<link rel="start" href="index.html" title="The Boost C++ Libraries BoostBook Documentation Subset">
<link rel="up" href="libraries.html" title="Part&nbsp;I.&nbsp;The Boost C++ Libraries (BoostBook Subset)">
<link rel="prev" href="BOOST_PROGRAM_OPTIONS_VERSION.html" title="Macro BOOST_PROGRAM_OPTIONS_VERSION">
<link rel="next" href="proto/users_guide.html" title="Users' Guide"></head>
<body alink="#0000ff" bgcolor="white" link="#0000ff" text="black" vlink="#840084">
<table cellpadding="2" width="100%"><tbody><tr>
<td valign="top"><img alt="Boost C++ Libraries" src="../../boost.png" height="86" width="277"></td>
<td align="center"><a href="../../index.html">Home</a></td>
<td align="center"><a href="../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../more/index.htm">More</a></td>
</tr></tbody></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="boost/property_tree/xml_parser/write_xml_id957066.html"><img style="border: 0px solid ; width: 19px; height: 19px;" src="../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="libraries.html"><img src="../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="index.html"><img src="../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="proto/users_guide.html"><img src="../../doc/html/images/next.png" alt="Next"></a>
</div>
<div class="chapter" lang="en">
<div class="titlepage"><div>
<div><h2 class="title">
<a name="proto"></a>Chapter&nbsp;15.&nbsp;Boost.Proto</h2></div>
<div><div class="author"><h3 class="author">
<span class="firstname">Eric</span> <span class="surname">Niebler</span>
</h3></div></div>
<div><p class="copyright">Copyright © 2008 Eric Niebler</p></div>
<div><div class="legalnotice">
<a name="id3472942"></a><p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></div>
</div></div>
<div class="toc">
<p><b>Table of Contents 目录</b></p>
<dl>
<dt><span class="section"><a href="proto.html#boost_proto.preface">Preface 前言</a></span></dt>
<dt><span class="section"><a href="proto/users_guide.html"> Users' Guide 用户指南</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="proto/users_guide.html#boost_proto.users_guide.getting_started"> Getting Started 入门</a></span></dt>
<dt><span class="section"><a href="proto/users_guide.html#boost_proto.users_guide.front_end"> Fronts Ends: Defining
      Terminals and Non-Terminals of Your DSEL 前端：为你的DSEL定义终结符和非终结符</a></span></dt>
<dt><span class="section"><a href="proto/users_guide.html#boost_proto.users_guide.intermediate_form"> Intermediate
      Form: Understanding and Introspecting Expressions 中间格式：理解和窥探表达式</a></span></dt>
<dt><span class="section"><a href="proto/users_guide.html#boost_proto.users_guide.back_end"> Back Ends: Making
      Expression Templates Do Useful Work 后端：让表达式模板做有用的事</a></span></dt>
<dt><span class="section"><a href="proto/users_guide.html#boost_proto.users_guide.examples">Examples 示例</a></span></dt>
<dt><span class="section"><a href="proto/users_guide.html#boost_proto.users_guide.resources"> Background and Resources 背景及资源</a></span></dt>
<dt><span class="section"><a href="proto/users_guide.html#boost_proto.users_guide.glossary">Glossary 术语</a></span></dt>
</dl></dd>
<dt><span class="section"><a href="proto/reference.html">Reference 参考手册</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="proto/reference.html#proto.concepts">Concepts 概念</a></span></dt>
</dl><span class="section"><a href="proto/reference.html#proto.reference.classes">Classes 类</a></span><dl><dt><span class="section"><a href="proto/reference.html#proto.reference.functions">Functions 函数</a></span> </dt></dl><dl><dt><span class="section"><a href="proto/reference.html#header.boost.proto.args_hpp">Header &lt;boost/proto/args.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.core_hpp">Header &lt;boost/proto/core.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.debug_hpp">Header &lt;boost/proto/debug.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.deep_copy_hpp">Header &lt;boost/proto/deep_copy.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.domain_hpp">Header &lt;boost/proto/domain.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.eval_hpp">Header &lt;boost/proto/eval.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.expr_hpp">Header &lt;boost/proto/expr.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.extends_hpp">Header &lt;boost/proto/extends.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.fusion_hpp">Header &lt;boost/proto/fusion.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.generate_hpp">Header &lt;boost/proto/generate.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.literal_hpp">Header &lt;boost/proto/literal.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.make_expr_hpp">Header &lt;boost/proto/make_expr.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.matches_hpp">Header &lt;boost/proto/matches.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.operators_hpp">Header &lt;boost/proto/operators.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.proto_hpp">Header &lt;boost/proto/proto.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.proto_fwd_hpp">Header &lt;boost/proto/proto_fwd.hpp&gt;</a></span></dt>
</dl><dl><dt><span class="section"><a href="proto/reference.html#header.boost.proto.proto_typeof_hpp">Header 
&lt;boost/proto/proto_typeof.hpp&gt;</a></span> 
</dt><dt><span class="section"><a href="proto/reference.html#header.boost.proto.repeat_hpp">Header 
&lt;boost/proto/repeat.hpp&gt;</a></span> </dt></dl><dl><dt><span class="section"><a href="proto/reference.html#header.boost.proto.tags_hpp">Header &lt;boost/proto/tags.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.traits_hpp">Header &lt;boost/proto/traits.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.transform.arg_hpp">Header &lt;boost/proto/transform/arg.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.transform.call_hpp">Header &lt;boost/proto/transform/call.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.transform.default_hpp">Header &lt;boost/proto/transform/default.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.transform.fold_hpp">Header &lt;boost/proto/transform/fold.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.transform.fold_tree_hpp">Header &lt;boost/proto/transform/fold_tree.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.transform.impl_hpp">Header &lt;boost/proto/transform/impl.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.transform.lazy_hpp">Header &lt;boost/proto/transform/lazy.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.transform.make_hpp">Header &lt;boost/proto/transform/make.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.transform.pass_through_hpp">Header &lt;boost/proto/transform/pass_through.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.transform.when_hpp">Header &lt;boost/proto/transform/when.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.context.callable_hpp">Header &lt;boost/proto/context/callable.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.context.default_hpp">Header &lt;boost/proto/context/default.hpp&gt;</a></span></dt>
<dt><span class="section"><a href="proto/reference.html#header.boost.proto.context.null_hpp">Header &lt;boost/proto/context/null.hpp&gt;</a></span></dt>
</dl></dd>
<dt><span class="section"><a href="proto/appendices.html">Appendices 附录</a></span></dt>
<dd><dl>
<dt><span class="section"><a href="proto/appendices.html#boost_proto.appendices.history"> Appendix A: History 附录A：历史</a></span></dt>
<dt><span class="section"><a href="proto/appendices.html#boost_proto.appendices.rationale"> Appendix B: Rationale 附录B：基本原理</a></span></dt>
<dt><span class="section"><a href="proto/appendices.html#boost_proto.appendices.implementation"> Appendix C: Implementation
      Notes 附录C：实现说明</a></span></dt>
<dt><span class="section"><a href="proto/appendices.html#boost_proto.appendices.acknowledgements"> Appendix D:
      Acknowledgements 附录D：鸣谢</a></span></dt>
</dl></dd>
</dl>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h2 class="title" style="clear: both;">
<a name="boost_proto.preface"></a><a class="link" href="proto.html#boost_proto.preface" title="Preface">Preface 前言</a>
</h2></div></div></div>
<div class="blockquote"><blockquote class="blockquote">
<p>
        </p>
<p>
          “<span class="quote">There are more things in heaven and earth, Horatio, than are dreamt
          of in your philosophy.</span>”
        </p>
<p>
      </p>
</blockquote></div>
<div class="blockquote"><blockquote class="blockquote">
<p>
        </p>
<p>
          <span class="bold"><strong><span class="emphasis"><em>-- William Shakespeare</em></span></strong></span>
        </p>
<p>
      </p>
</blockquote></div>
<a name="boost_proto.preface.description"></a><h4>
<a name="id3473015"></a>
      <a class="link" href="proto.html#boost_proto.preface.description">Description 概述</a>
    </h4>
<p>
      Proto is a framework for building Domain Specific Embedded Languages in C++.
      It provides tools for constructing, type-checking, transforming and executing
      <span class="emphasis"><em>expression templates</em></span>
      <sup>[<a name="id3473038" href="proto.html#ftn.id3473038" class="footnote">2</a>]</sup>
      . More specifically, Proto provides:<br>Proto 是一个在C++中构建专用领域嵌入式语言的框架。它提供了构造、类型检查、转化和执行 <span class="emphasis"><em>表达式模板</em></span><sup>[<a name="id3473038" href="proto.html#ftn.id3473038" class="footnote">2</a>]</sup>
的工具。具体地说，Proto 提供了：
    </p>
<div class="itemizedlist"><ul type="disc">
<li>
        An expression tree data structure.<br>一个表达式树的数据结构。
      </li>
<li>
        A mechanism for giving expressions additional behaviors and members.<br>一个为给定的表达式添加行为和成员的机制。
      </li>
<li>
        Operator overloads for building the tree from an expression.<br>从一个表达式构建表达式树所需的操作符重载。
      </li>
<li>
        Utilities for defining the grammar to which an expression must conform.<br>对表达式必须遵守的语法进行定义的工具。
      </li>
<li>
        An extensible mechanism for immediately executing an expression template.<br>一个可扩展的机制，用于立即执行一个表达式模板。
      </li>
<li>
        An extensible set of tree transformations to apply to expression trees.<br>一个应用于表达式树的，可扩展的树转化操作集。
      </li>
</ul></div>
<a name="boost_proto.preface.motivation"></a><h4>
<a name="id3473092"></a>
      <a class="link" href="proto.html#boost_proto.preface.motivation">Motivation 动机</a>
    </h4>
<p>
      Expression Templates are an advanced technique that C++ library developers
      use to define embedded mini-languages that target specific problem domains.
      The technique has been used to create efficient and easy-to-use libraries for
      linear algebra as well as to define C++ parser generators with a readable syntax.
      But developing such a library involves writing an inordinate amount of unreadable
      and unmaintainable template mumbo-jumbo. Boost.Proto eases the development
      of <a class="link" href="proto/users_guide.html#boost_proto.users_guide.glossary.dsel">domain-specific embedded
      languages (DSELs)</a>. Use Proto to define the primitives of your mini-language
      and let Proto handle the operator overloading and the construction of the expression
      parse tree. Immediately evaluate the expression tree by passing it a function
      object. Or transform the expression tree by defining the grammar of your mini-language,
      decorated with an assortment of tree transforms provided by Proto or defined
      by you. Then use the grammar to give your users short and readable syntax errors
      for invalid expressions! No more mumbo-jumbo -- an expression template library
      developed with Proto is declarative and readable.<br>表
达式模板是一种高级技术，C++库开发者所使用它来定义以某个特定问题域为目标的嵌入式小型语言。该技术已被用于创建高效且易用的线性代数库，还被用于以
可读的语法来定义 C++ 分析器的生成器。但是，开发这样一个库需要编写大量难以阅读且难以维护的模板。Boost.Proto 使得 <a class="link" href="proto/users_guide.html#boost_proto.users_guide.glossary.dsel">专用领域嵌入式语言(DSELs)</a>
的开发变得容易。使用 Proto 来定义你的小型语言的基本组件，并让 Proto
处理操作符的重载和表达式分析树的构造。通过将表达式树传递给一个函数对象，可以立即对它进行求值。或者通过定义定义你的小型语言的语法，再以由
Proto
所提供的或由你定义的各种各样的树变换操作来对表达式树进行变换。然后，使用该语法给你的用户带来对无效表达式的简短易读的语法错误提示！没有更多的繁文
缛节了 -- 用 Proto 开发出来的表达式模板库是具有宣示性和可读性的。 </p>
<p>
      In short, Proto is a DSEL for defining DSELs.<br>简而言之，Proto 是一个用于定义 DSELs 的 DSEL。
    </p>
<a name="boost_proto.preface.how_to_use_this_documentation"></a><h4>
<a name="id3473148"></a>
      <a class="link" href="proto.html#boost_proto.preface.how_to_use_this_documentation">How to Use
      This Documentation 如何使用本文档</a>
    </h4>
<p>
      This documentation makes use of the following naming and formatting conventions.<br>本文档使用了以下命名约定和格式约定。
    </p>
<div class="itemizedlist"><ul type="disc">
<li>
        Code is in <code class="computeroutput"><span class="identifier">fixed</span> <span class="identifier">width</span>
        <span class="identifier">font</span></code> and is syntax-highlighted.<br>代码采用 <code class="computeroutput"><span class="identifier">fixed</span> <span class="identifier">width</span>
        <span class="identifier">font</span></code> 并具有语法高亮。
      </li>
<li>
        Replaceable text that you will need to supply is in
        <em class="replaceable"><code>
          italics
        </code></em>
        .<br>要由你提供的可替换文本采用
        <em class="replaceable"><code>
          italics&nbsp;</code></em>。
      </li>
<li>
        If a name refers to a free function, it is specified like this: <code class="computeroutput"><span class="identifier">free_function</span><span class="special">()</span></code>;
        that is, it is in code font and its name is followed by <code class="computeroutput"><span class="special">()</span></code>
        to indicate that it is a free function.<br>如果某个名字代表一个普通函数，则写为：<code class="computeroutput"><span class="identifier">free_function</span><span class="special">()</span></code>; 即采用代码的字体并在名字后跟 <code class="computeroutput"><span class="special">()</span></code>
        以表示它是一个普通函数。
      </li>
<li>
        If a name refers to a class template, it is specified like this: <code class="computeroutput"><span class="identifier">class_template</span><span class="special">&lt;&gt;</span></code>;
        that is, it is in code font and its name is followed by <code class="computeroutput"><span class="special">&lt;&gt;</span></code>
        to indicate that it is a class template.<br>如果某个名字代表一个类模板，则写为：<code class="computeroutput"><span class="identifier">class_template</span><span class="special">&lt;&gt;</span></code>;
        即采用代码的字体并在名字后跟 <code class="computeroutput"><span class="special">&lt;&gt;</span></code> 以表示它是一个类模板。
      </li>
<li>
        If a name refers to a function-like macro, it is specified like this: <code class="computeroutput"><span class="identifier">MACRO</span><span class="special">()</span></code>;
        that is, it is uppercase in code font and its name is followed by <code class="computeroutput"><span class="special">()</span></code> to indicate that it is a function-like
        macro. Object-like macros appear without the trailing <code class="computeroutput"><span class="special">()</span></code>.<br>如果某个名字代表一个类似于函数的宏，则写为：<code class="computeroutput"><span class="identifier">MACRO</span><span class="special">()</span></code>;
        即采用代码字体的大写并在名字后跟 <code class="computeroutput"><span class="special">()</span></code> 以表示它是一个类似于函数的宏。类似于对象的宏则没有后面的 <code class="computeroutput"><span class="special">()</span></code>。
      </li>
<li>
        Names that refer to <span class="emphasis"><em>concepts</em></span> in the generic programming
        sense are specified in CamelCase.<br>代表泛型编程意义上的 <span class="emphasis"><em>概念</em></span> 的名字则以 CamelCase 表示。
      </li>
</ul></div>
<div class="note"><table summary="Note" border="0">
<tbody><tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../doc/html/images/note.png"></td>
<th align="left">Note 备注</th>
</tr>
<tr><td align="left" valign="top"><p>
        In addition, notes such as this one specify non-essential information that
        provides additional background or rationale.</p><p>此外，象这样的备注则用于指定非必要的信息，以提供额外的背景或原理的说明。
      </p></td></tr>
</tbody></table></div>
<p>
      Finally, you can mentally add the following to any code fragments in this document:<br>最后，在本文档中的所有代码片断中，你都可以认为已经增加了以下代码：
    </p>
<pre class="programlisting"><span class="comment">// Include all of Proto<br></span><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">proto</span><span class="special">/</span><span class="identifier">proto</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>

<span class="comment">// Create some namespace aliases<br></span><span class="keyword">namespace</span> <span class="identifier">mpl</span> <span class="special">=</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">mpl</span><span class="special">;</span>
<span class="keyword">namespace</span> <span class="identifier">fusion</span> <span class="special">=</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">fusion</span><span class="special">;</span>
<span class="keyword">namespace</span> <span class="identifier">proto</span> <span class="special">=</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">proto</span><span class="special">;</span>

<span class="comment">// Allow unqualified use of Proto's wildcard pattern<br></span><span class="keyword">using</span> <span class="identifier">proto</span><span class="special">::</span><span class="identifier">_</span><span class="special">;</span>
</pre>
</div>
<div class="footnotes">
<br><hr align="left" width="100">
<div class="footnote"><p><sup>[<a name="ftn.id3473038" href="#id3473038" class="para">2</a>] </sup>
          See <a href="http://www.osl.iu.edu/%7Etveldhui/papers/Expression-Templates/exprtmpl.html" target="_top">Expression
          Templates</a>&nbsp;<br>参见 <a href="http://www.osl.iu.edu/%7Etveldhui/papers/Expression-Templates/exprtmpl.html" target="_top">表达式模板</a>
        </p></div>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tbody><tr>
<td align="left"><p><small>Last revised: November 14, 2009 at 10:40:13 GMT</small></p></td>
<td align="right"><div class="copyright-footer"></div></td>
</tr></tbody></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="boost/property_tree/xml_parser/write_xml_id957066.html"><img style="border: 0px solid ; width: 19px; height: 19px;" src="../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="libraries.html"><img src="../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="index.html"><img src="../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="proto/users_guide.html"><img src="../../doc/html/images/next.png" alt="Next"></a>
</div>
</body></html>