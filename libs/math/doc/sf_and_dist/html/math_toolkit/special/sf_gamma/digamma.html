<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Digamma</title>
<link rel="stylesheet" href="../../../../../../../../doc/html/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_2006-12-17_0120">
<link rel="start" href="../../../index.html" title="Math Toolkit">
<link rel="up" href="../sf_gamma.html" title="Gamma Functions">
<link rel="prev" href="lgamma.html" title="Log Gamma">
<link rel="next" href="gamma_ratios.html" title="Ratios of Gamma Functions">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../../../../boost.png"></td>
<td align="center"><a href="../../../../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="lgamma.html"><img src="../../../../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../sf_gamma.html"><img src="../../../../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../../../index.html"><img src="../../../../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="gamma_ratios.html"><img src="../../../../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div><h4 class="title">
<a name="math_toolkit.special.sf_gamma.digamma"></a><a href="digamma.html" title="Digamma"> Digamma</a>
</h4></div></div></div>
<a name="math_toolkit.special.sf_gamma.digamma.synopsis"></a>
<h5>
<a name="id656170"></a>
          <a href="digamma.html#math_toolkit.special.sf_gamma.digamma.synopsis">概要</a>
  </h5>
<p>
          
</p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">math</span><span class="special">/</span><span class="identifier">special_functions</span><span class="special">/</span><span class="identifier">digamma</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
</pre>
<p>
  </p>
<pre class="programlisting"><span class="keyword">namespace</span> <span class="identifier">boost</span><span class="special">{</span> <span class="keyword">namespace</span> <span class="identifier">math</span><span class="special">{</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">digamma</span><span class="special">(</span><span class="identifier">T</span> <span class="identifier">z</span><span class="special">);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T</span><span class="special">,</span> <span class="keyword">class</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">digamma</span><span class="special">(</span><span class="identifier">T</span> <span class="identifier">z</span><span class="special">,</span> <span class="keyword">const</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&amp;);</span>

<span class="special">}}</span> <span class="comment">// namespaces
</span></pre>
<a name="math_toolkit.special.sf_gamma.digamma.description"></a>
<h5>
<a name="id656490"></a>
          <a href="digamma.html#math_toolkit.special.sf_gamma.digamma.description">说明</a>
  </h5>
<p>
          返回x的digamma 或 psi 函数<span class="emphasis"><em></em></span>. Digamma
        定义为γ函数的对数导数。</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/digamma1.png"></span>
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../graphs/digamma.png" align="middle"></span>
  </p>
<p>
  </p>
<p>
            最后一个<a href="../../policy.html" title="Policies">策略</a> 参数是可选的并且可以用来控制函数的行为: 如何处理错误, 使用哪种层次的精度等等. 参见<a href="../../policy.html" title="Policies">策略文档</a>了解更多信息。</p>
<p>
  </p>
<p>
          这里是这个函数的完全通用的版本：所有的这些版本都设置到一个指定的精度，最大精度为34位数字精度。</p>
<p>
          函数的返回值的类型使用<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>函数返回值推导法则</em></span></a> 来确定: 当T是整型的时候，返回值的类型是double,否则返回值的类型为T。</p>
<a name="math_toolkit.special.sf_gamma.digamma.accuracy"></a>
<h5>
<a name="id656650"></a>
          <a href="digamma.html#math_toolkit.special.sf_gamma.digamma.accuracy">精确性</a>
  </h5>
<p>
  下面的表显示了参数的不同定义域的峰值误差(单位为10的-5次方)。注意，在那些由宽浮点类型来给定窄浮点类型的系统上会有<a href="../../backgrounders/relative_error.html#zero_error">有效的零误差</a>. 除非另外指定比此处的类型更窄的浮点类型，融计算结果具有<a href="../../backgrounders/relative_error.html#zero_error">有效的零误差 </a>. </p>
<div class="informaltable"><table class="table">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  有效数字位数</p>
          </th>
<th>
                <p>
                  平台和编译器</p>
          </th>
<th>
                <p>
                  随机正数值</p>
          </th>
<th>
                <p>
                  接近于正根的值</p>
          </th>
<th>
                <p>
                  接近于0的值</p>
          </th>
<th>
                <p>
                  负值</p>
          </th>
</tr></thead>
<tbody>
<tr>
<td>
                <p>
                  53
                </p>
          </td>
<td>
                <p>
                  Win32 Visual C++ 8
                </p>
          </td>
<td>
                <p>
                  峰值=0.98 均值=0.36
                </p>
          </td>
<td>
                <p>
                  峰值=0.99 均值=0.5
                </p>
          </td>
<td>
                <p>
                  峰值=0.95 均值=0.5
                </p>
          </td>
<td>
                <p>
                  峰值=214 均值=16
                </p>
          </td>
</tr>
<tr>
<td>
                <p>
                  64
                </p>
          </td>
<td>
                <p>
                  Linux IA32 / GCC
                </p>
          </td>
<td>
                <p>
                  峰值=1.4 均值=0.4
                </p>
          </td>
<td>
                <p>
                  峰值=1.3 均值=0.45
                </p>
          </td>
<td>
                <p>
                  峰值=0.98 均值=0.35
                </p>
          </td>
<td>
                <p>
                  峰值=180 均值=13
                </p>
          </td>
</tr>
<tr>
<td>
                <p>
                  64
                </p>
          </td>
<td>
                <p>
                  Linux IA64 / GCC
                </p>
          </td>
<td>
                <p>
                  峰值=0.92 均值=0.4
                </p>
          </td>
<td>
                <p>
                  峰值=1.3 均值=0.45
                </p>
          </td>
<td>
                <p>
                  峰值=0.98 均值=0.4
                </p>
          </td>
<td>
                <p>
                  峰值=180 均值=13
                </p>
          </td>
</tr>
<tr>
<td>
                <p>
                  113
                </p>
          </td>
<td>
                <p>
                  HPUX IA64, aCC A.06.06
                </p>
          </td>
<td>
                <p>
                  峰值=0.9 均值=0.4
                </p>
          </td>
<td>
                <p>
                  峰值=1.1 均值=0.5
                </p>
          </td>
<td>
                <p>
                  峰值=0.99 均值=0.4
                </p>
          </td>
<td>
                <p>
                  峰值=64 均值=6
                </p>
          </td>
</tr>
</tbody>
</table></div>
<p>
  就像上面显示的那样，对于正数参数，误差率一般很低。对于负数参数有无限多个无理数根：相对误差将会很大，而绝对误差将会保持很低。</p>
<a name="math_toolkit.special.sf_gamma.digamma.testing"></a>
<h5>
<a name="id656954"></a>
          <a href="digamma.html#math_toolkit.special.sf_gamma.digamma.testing">测试</a>
  </h5>
<p>
          混合的抽样测试使用 functions.wolfram.com在线计算器产生的数据,
          而随机测试数据使用高精度的参考实现产生的数据(一个微分的 <a href="../../backgrounders/lanczos.html" title="The Lanczos Approximation">兰克泽斯逼近</a>，如下).</p>
<a name="math_toolkit.special.sf_gamma.digamma.implementation"></a>
<h5>
<a name="id656997"></a>
          <a href="digamma.html#math_toolkit.special.sf_gamma.digamma.implementation">实现</a>
  </h5>
<p>
  实现被分为如下的定义域：</p>
<p>
          对于负值参数，使用下面的反射方程来使得x为正值:
  </p>
<pre class="programlisting"><span class="identifier">digamma</span><span class="special">(</span><span class="number">1</span><span class="special">-</span><span class="identifier">x</span><span class="special">)</span> <span class="special">=</span> <span class="identifier">digamma</span><span class="special">(</span><span class="identifier">x</span><span class="special">)</span> <span class="special">+</span> <span class="identifier">pi</span><span class="special">/</span><span class="identifier">tan</span><span class="special">(</span><span class="identifier">pi</span><span class="special">*</span><span class="identifier">x</span><span class="special">);</span>
</pre>
<p>
          对于在范围[0,1]内的参数使用下面的迭代关系来将计算调整到范围[1,2]内:
  </p>
<pre class="programlisting"><span class="identifier">digamma</span><span class="special">(</span><span class="identifier">x</span><span class="special">)</span> <span class="special">=</span> <span class="identifier">digamma</span><span class="special">(</span><span class="identifier">x</span><span class="special">+</span><span class="number">1</span><span class="special">)</span> <span class="special">-</span> <span class="number">1</span><span class="special">/</span><span class="identifier">x</span>
</pre>
<p>
          对于在范围 [1,2]内的参数，使用一个由<a href="../../backgrounders/implementation.html#math_toolkit.backgrounders.implementation.rational_approximations_used"> JM</a> 发明的有理逼近 (如下).
  </p>
<p>
          对于在范围 [2,BIG]内的参数使用下面的迭代关系来将计算调整到范围[1,2]:
  </p>
<pre class="programlisting"><span class="identifier">digamma</span><span class="special">(</span><span class="identifier">x</span><span class="special">+</span><span class="number">1</span><span class="special">)</span> <span class="special">=</span> <span class="identifier">digamma</span><span class="special">(</span><span class="identifier">x</span><span class="special">)</span> <span class="special">+</span> <span class="number">1</span><span class="special">/</span><span class="identifier">x</span><span class="special">;</span>
</pre>
<p>
          对于大于 BIG 的参数，可以使用下面的渐近展开:
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/digamma2.png"></span>
  </p>
<p>
  然而，在一些项之后，这种展开有很多变化：到底有多少项依赖于x的大小。因此必须选定BIG的值，从而使得级数可以在一个在BIG值计算时足够小以致于不会对计算结果产生任何影响的项上截断。对于高达80-bit的实数将BIG的值选为10,对于高达128-bit的实数选择BIG的值为20可以使得级数在一个合适的小数目的项后截断且作为一个类似于在(1/x*x)的多项式内求值。</p>
<p>
          由<a href="../../backgrounders/implementation.html#math_toolkit.backgrounders.implementation.rational_approximations_used"> JM</a> 发明的在区间[1 ,2]内的有理逼近导现如下.
  </p>
<p>
  首先，使用一个60项的 <a href="../../backgrounders/lanczos.html" title="The Lanczos Approximation">兰克泽斯逼近</a>来构造一个高精度的digamma逼近，形式如下：</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/digamma3.png"></span>
  </p>
<p>
          其中P(x) 和 Q(x) 是源自于兰克泽斯求和的无理数形式的多项式，而 P'(x) 和 Q'(x)是它们的一阶导数。这个逼近的兰克泽斯部分的理论逼近精度为~100个十进制数字。然而，上面求各式中的消去运算将会减少到99-(1/y),如果y是结果。这个逼近用来计算digamma的正根，并且发现与Cody所使用的25个数字一致(参见 Math. Comp. 27, 123-127 (1973)
  by Cody, Strecok 和 Thacher)，也与Morris使用的35个数字一致(参见 TOMS Algorithm 708)。</p>
<p>
  类似地，一些抽样测试与使用unctions.wolfram.com          超过40个数字的计算结果一致。这种足够的精度可以确信逼近的精度可以达到double精度。达到128-bit long double精确度要求根的位置～70位数字，这种方法计算的数据是否满足这个要求还不太清楚：困难在于独立地获取数据。</p>
<p>
  针对于绝对误差的使用由<a href="../../backgrounders/implementation.html#math_toolkit.backgrounders.implementation.rational_approximations_used"> JM</a> 发明的有理逼近来进行，形式如下：</p>
<pre class="programlisting"><span class="identifier">digamma</span><span class="special">(</span><span class="identifier">x</span><span class="special">)</span> <span class="special">=</span> <span class="special">(</span><span class="identifier">x</span> <span class="special">-</span> <span class="identifier">X0</span><span class="special">)(</span><span class="identifier">Y</span> <span class="special">+</span> <span class="identifier">R</span><span class="special">(</span><span class="identifier">x</span> <span class="special">-</span> <span class="number">1</span><span class="special">));</span>
</pre>
<p>
          其中 X0 是digamma的正根, Y是一个常量, 而 R(x - 1)
          是有理逼近. 注意，因为X0 是无理数,在X0中我们需要两倍于x的数字位数来避免在减法中出现的消去误差  (这里假设x是一个精确值，如果不是这样，那么所有的假设都要取消 ). 这就意味着即使x是根舍入到最近的可表达的值，digamma(x)的结果<span class="emphasis"><em><span class="bold"><strong>也不会是0</strong></span></em></span>.
  </p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright ?2006 , 2007, 2008 John Maddock, Paul A. Bristow, Hubert
      Holin, Xiaogang Zhang and Bruno Lalande<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="lgamma.html"><img src="../../../../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../sf_gamma.html"><img src="../../../../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../../../index.html"><img src="../../../../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="gamma_ratios.html"><img src="../../../../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
</body>
</html>
