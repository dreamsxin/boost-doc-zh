<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>


  
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

  


  
  <title>Detailed Semantics</title>
  <link rel="stylesheet" href="../boostbook.css" type="text/css">


  
  <meta name="generator" content="DocBook XSL Stylesheets V1.73.2">


  
  <link rel="start" href="../index.html" title="Chapter&nbsp;1.&nbsp;Boost.Optional">


  
  <link rel="up" href="../index.html" title="Chapter&nbsp;1.&nbsp;Boost.Optional">


  
  <link rel="prev" href="synopsis.html" title="Synopsis">


  
  <link rel="next" href="examples.html" title="Examples">
</head>


<body style="color: black; background-color: white;" alink="#0000ff" link="#0000ff" vlink="#840084">


<table cellpadding="2" width="100%">


  <tbody>


    <tr>


      <td valign="top"><img alt="Boost C++ Libraries" src="../../../../../boost.png" height="86" width="277"></td>


      <td align="center"><a href="../../../../../index.html">Home</a></td>


      <td align="center"><a href="../../../../libraries.htm">Libraries</a></td>


      <td align="center"><a href="http://www.boost.org/people/people.htm">People</a></td>


      <td align="center"><a href="http://www.boost.org/more/faq.htm">FAQ</a></td>


      <td align="center"><a href="../../../../../more/index.htm">More</a></td>


    </tr>


  
  </tbody>
</table>


<hr>
<div class="spirit-nav"><a accesskey="p" href="synopsis.html"><img src="../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="examples.html"><img src="../../../../../doc/html/images/next.png" alt="Next"></a>
</div>


<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="boost_optional.detailed_semantics"></a><a class="link" href="detailed_semantics.html" title="Detailed Semantics">详细语义</a>
</h2>


</div>


</div>


</div>


<p>因为 <code class="computeroutput"><span class="identifier">T</span></code>
可能是引用类型，所以，那些语义与 <code class="computeroutput"><span class="identifier">T</span></code>
的类型是否为引用相关的项，将使用以下约定： </p>


<div class="itemizedlist">
<ul type="disc">


  <li>如果该项为： <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code><span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;</span></code>,
则对应的描述仅适作于T不是引用类型时的情况。 </li>


  <li>如果该项为：<code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span></code>,
则对应的描述仅适用于T是引用类型时的情况。 </li>


  <li>如果该项为：<code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span></code>,
则对应的描述适用于两种情况。 </li>


</ul>


</div>


<div class="note">
<table summary="Note" border="0">


  <tbody>


    <tr>


      <td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../../doc/html/images/note.png"></td>


      <th align="left">说明</th>


    </tr>


    <tr>


      <td align="left" valign="top">
      
      <p>以下章节中包含多个 <code class="computeroutput"><span class="identifier">assert</span><span class="special">()</span></code>，仅用于示范后续条件的例子代码。它
并不意味着类型 <code class="computeroutput"><span class="identifier">T</span></code>
必须支持每个单独的表达式，但是如果它支持某个表达式，则满足相应的条件。</p>


      </td>


    </tr>


  
  </tbody>
</table>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="boost_optional.detailed_semantics.optional_class_member_functions"></a>
<h4><a name="id2640940"></a> <a class="link" href="detailed_semantics.html#boost_optional.detailed_semantics.optional_class_member_functions">optional
类的成员函数</a> </h4>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_constructor"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">optional</span><span class="special">();</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>缺省构造一个&nbsp;<code class="computeroutput"><span class="identifier">optional</span></code>. </li>


  <li>
    <b>后续条件：</b><span class="bold"><strong></strong></span><code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code>
为 <u>未初始化的</u>。 </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li><b>说明：</b>T 的缺省构造函数未被调用。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">def</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">!</span><span class="identifier">def</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_constructor_none_t"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">optional</span><span class="special">(</span> <span class="identifier">none_t</span>
  <span class="special">);</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>构造一个未初始化的&nbsp;<code class="computeroutput"><span class="identifier">optional</span></code>. </li>


  <li>
    <b>后续条件：</b><code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code><b></b> 为 <u>未初始化的</u>。 </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <span class="bold"><strong>说明：</strong></span><code class="computeroutput"><span class="identifier">T</span></code> 的缺省构造函数未被调用。表达式 <code class="computeroutput"><span class="identifier">boost</span><span class="special">::</span><span class="identifier">none</span></code> 表示一个 <code>boost::none_t</code> 实例，可用作本构造函数的参数。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">none</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">n</span><span class="special">(</span><span class="identifier">none</span><span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">!</span><span class="identifier">n</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_constructor_value"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span> </code><span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">optional</span><span class="special">(</span> <span class="identifier">T</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">v</span> <span class="special">)</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>直接构造一个 <code class="computeroutput"><span class="identifier">optional</span></code>. </li>


  <li>
    <b>后续条件：</b><code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code><b></b> 为 <u>已初始化的</u>，它的值为&nbsp;<code class="computeroutput"><span class="identifier">v</span></code> 的拷贝。
  </li>


  <li>
    <b>抛出：</b> <code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span>
    <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span>
    <span class="special">)</span></code> 所抛出的任何异常。 </li>


  <li>
    <span class="bold"><strong>说明：</strong></span>调用<span class="bold"><strong> </strong></span><code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span> <span class="identifier">T</span>
    <span class="keyword">const</span><span class="special">&amp;</span> <span class="special">)</span></code>. </li>


  <li>
    <b>异常安全性：</b>仅会在 <code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span>
    <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span>
    <span class="special">);</span></code> 中抛出异常，这时构造函数无效。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">v</span><span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">opt</span><span class="special">(</span><span class="identifier">v</span><span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">opt</span> <span class="special">==</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;::</span><span class="identifier">optional</span><span class="special">(</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">ref</span> <span class="special">)</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>直接构造一个 <code class="computeroutput"><span class="identifier">optional</span></code>. </li>


  <li>
    <b>后续条件：</b><code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 为 <u>已初始化的</u>，它的值为某个内部类型的实例，包装了引用 <code class="computeroutput"><span class="identifier">ref</span></code>.
  </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">v</span><span class="special">;</span><br><span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">vref</span> <span class="special">=</span> <span class="identifier">v</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span> <span class="identifier">opt</span><span class="special">(</span><span class="identifier">vref</span><span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">opt</span> <span class="special">==</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span><br><span class="special">++</span> <span class="identifier">v</span> <span class="special">;</span> <span class="comment">// mutate referee<br></span><span class="identifier">assert</span> <span class="special">(*</span><span class="identifier">opt</span> <span class="special">==</span> <span class="identifier">v</span><span class="special">);</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_constructor_bool_value"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">optional</span><span class="special">(</span> <span class="keyword">bool</span>
  <span class="identifier">condition</span><span class="special">,</span> <span class="identifier">T</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">v</span> <span class="special">)</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span>
  <span class="special">::</span><span class="identifier">optional</span><span class="special">(</span> <span class="keyword">bool</span>
  <span class="identifier">condition</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">v</span> <span class="special">)</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>如果 <i>condition</i> 为 <code>true</code>, 则相当于： </li>


</ul>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">optional</span><span class="special">(</span> <span class="identifier">T</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">v</span> <span class="special">)</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span>
  <span class="special">::</span><span class="identifier">optional</span><span class="special">(</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">v</span> <span class="special">)</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>否则相当于： </li>


</ul>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span> <span class="special">[</span>#<span class="special">(</span><span class="keyword">not</span>
  <span class="identifier">a</span> <span class="identifier">ref</span><span class="special">)]&gt;::</span><span class="identifier">optional</span><span class="special">()</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span>
  <span class="special">::</span><span class="identifier">optional</span><span class="special">()</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_constructor_optional"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span> </code><span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">optional</span><span class="special">(</span> <span class="identifier">optional</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">rhs</span> <span class="special">);</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>复制构造一个 <code class="computeroutput"><span class="identifier">optional</span></code>. </li>


  <li>
    <b>后续条件：</b>如果 <b>rhs</b> 是已初始化的，则 <code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 为已初始化的，且值为 <b>rhs</b> 的值的拷贝；否则&nbsp;<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 为未初始化的。<span class="bold"><strong></strong></span> </li>


  <li>
    <b>抛出：</b><code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span>
    <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span>
    <span class="special">)</span></code>&nbsp;所抛出的任何异常。 </li>


  <li>
    <span class="bold"><strong>说明：</strong></span>如果 <b>rhs</b> 是已初始化的，则调用&nbsp;<code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="special">)</span></code>&nbsp;. </li>


  <li>
    <b>异常安全性：</b>仅会在 <code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span>
    <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span>
    <span class="special">);</span></code> 中抛出异常，这时构造函数无效。&nbsp; </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">uninit</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(!</span><span class="identifier">uninit</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">uinit2</span> <span class="special">(</span> <span class="identifier">uninit</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">uninit2</span> <span class="special">==</span> <span class="identifier">uninit</span> <span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">init</span><span class="special">(</span> <span class="identifier">T</span><span class="special">(</span><span class="number">2</span><span class="special">)</span> <span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">init</span> <span class="special">==</span> <span class="identifier">T</span><span class="special">(</span><span class="number">2</span><span class="special">)</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">init2</span> <span class="special">(</span> <span class="identifier">init</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">init2</span> <span class="special">==</span> <span class="identifier">init</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;::</span><span class="identifier">optional</span><span class="special">(</span> <span class="identifier">optional</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">rhs</span> <span class="special">);</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>复制构造一个 <code class="computeroutput"><span class="identifier">optional</span></code>. </li>


  <li>
    <b>后续条件：</b>如果 <b>rhs</b> 是已初始化的，则&nbsp;<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 为已初始化的，且值为 <b>*rhs</b> 
所引用的同一个对象的另一个引用；否则&nbsp;<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 为未初始化的。 </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <b>说明：</b>如果 <b>rhs</b> 是已初始化的，则&nbsp;<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code><b></b> 与 <b>*rhs</b> 均引向同一个对象(它们互为别名)。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span> <span class="identifier">uninit</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(!</span><span class="identifier">uninit</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span> <span class="identifier">uinit2</span> <span class="special">(</span> <span class="identifier">uninit</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">uninit2</span> <span class="special">==</span> <span class="identifier">uninit</span> <span class="special">);</span><br><span class="identifier">T</span> <span class="identifier">v</span> <span class="special">=</span> <span class="number">2</span> <span class="special">;</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">ref</span> <span class="special">=</span> <span class="identifier">v</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">init</span><span class="special">(</span><span class="identifier">ref</span><span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">init</span> <span class="special">==</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">init2</span> <span class="special">(</span> <span class="identifier">init</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">init2</span> <span class="special">==</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">v</span> <span class="special">=</span> <span class="number">3</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">init</span> <span class="special">==</span> <span class="number">3</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">init2</span> <span class="special">==</span> <span class="number">3</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_constructor_other_optional"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">template</span><span class="special">&lt;</span><span class="identifier">U</span><span class="special">&gt;</span>
  <span class="keyword">explicit</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">optional</span><span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">U</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">rhs</span> <span class="special">);</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>复制构造一个 <code class="computeroutput"><span class="identifier">optional</span></code>. </li>


  <li>
    <b>后续条件：</b>如果 <b>rhs</b> 是已初始化的，则 <code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 为已初始化的，且值为 <b>rhs</b> 
转换为类型T的值的拷贝；否则 <code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code><b></b> 为未初始化的。 </li>


  <li>
    <b>抛出：</b><code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span>
    <span class="identifier">U</span> <span class="keyword">const</span><span class="special">&amp;</span>
    <span class="special">)</span></code> 所抛出的任何异常。 </li>


  <li>
    <b>说明：</b>如果 <code class="computeroutput"><span class="identifier">rhs</span></code> 已初始化，则调用&nbsp;<span class="bold"><strong></strong></span><code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span> <span class="identifier">U</span>
    <span class="keyword">const</span><span class="special">&amp;</span> <span class="special">)</span></code>, 要求有从 <code class="computeroutput"><span class="identifier">U</span></code> 到 <code class="computeroutput"><span class="identifier">T</span></code> 的有效转换。 </li>


  <li>
    <b>异常安全性：</b>仅会在 <code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span>
    <span class="identifier">U</span> <span class="keyword">const</span><span class="special">&amp;</span>
    <span class="special">);</span></code> 中抛出异常，这时构造函数无效。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">optional</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;</span> <span class="identifier">x</span><span class="special">(</span><span class="number">123.4</span><span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">x</span> <span class="special">==</span> <span class="number">123.4</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="identifier">y</span><span class="special">(</span><span class="identifier">x</span><span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span><span class="special">(</span> <span class="special">*</span><span class="identifier">y</span> <span class="special">==</span> <span class="number">123</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_constructor_factory"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">template</span><span class="special">&lt;</span><span class="identifier">InPlaceFactory</span><span class="special">&gt;</span> <span class="keyword">explicit</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">optional</span><span class="special">(</span> <span class="identifier">InPlaceFactory</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">f</span> <span class="special">);</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">template</span><span class="special">&lt;</span><span class="identifier">TypedInPlaceFactory</span><span class="special">&gt;</span> <span class="keyword">explicit</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">optional</span><span class="special">(</span> <span class="identifier">TypedInPlaceFactory</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">f</span> <span class="special">);</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>构造一个 <code class="computeroutput"><span class="identifier">optional</span></code>，<code class="computeroutput"><span class="identifier">T</span></code> 的值从工厂获得。 </li>


  <li>
    <b>后续条件：</b><span class="bold"><strong></strong></span><code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> <u>已初始化</u> 且其值直接由工厂&nbsp;<code class="computeroutput"><span class="identifier">f</span></code> 取得(即该值<u style="text-decoration: underline;">不是复制的</u>)。<span class="bold"><strong></strong></span>
  </li>


  <li>
    <b>抛出：</b>由工厂所调用的 <code class="computeroutput"><span class="identifier">T</span></code> 构造函数所抛出的任何异常。<span class="bold"><strong></strong></span> </li>


  <li>
    <span class="bold"><strong>说明：</strong></span>请见 <a class="link" href="../index.html#optional_in_place_factories">就地创建</a>
  </li>


  <li>
    <b>异常安全性：</b>仅会在工厂调用T的构造函数时抛出异常，这时构造函数无效。&nbsp; </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="keyword">class</span> <span class="identifier">C</span> <span class="special">{</span> <span class="identifier">C</span> <span class="special">(</span> <span class="keyword">char</span><span class="special">,</span> <span class="keyword">double</span><span class="special">,</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="special">)</span> <span class="special">;</span> <span class="special">}</span> <span class="special">;</span><br><span class="identifier">C</span> <span class="identifier">v</span><span class="special">(</span><span class="char">'A'</span><span class="special">,</span><span class="number">123.4</span><span class="special">,</span><span class="string">"hello"</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">C</span><span class="special">&gt;</span> <span class="identifier">x</span><span class="special">(</span> <span class="identifier">in_place</span> <span class="special">(</span><span class="char">'A'</span><span class="special">,</span> <span class="number">123.4</span><span class="special">,</span> <span class="string">"hello"</span><span class="special">)</span> <span class="special">);</span> <span class="comment">// InPlaceFactory used<br></span><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">C</span><span class="special">&gt;</span> <span class="identifier">y</span><span class="special">(</span> <span class="identifier">in_place</span><span class="special">&lt;</span><span class="identifier">C</span><span class="special">&gt;(</span><span class="char">'A'</span><span class="special">,</span> <span class="number">123.4</span><span class="special">,</span> <span class="string">"hello"</span><span class="special">)</span> <span class="special">);</span> <span class="comment">// TypedInPlaceFactory used<br></span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">x</span> <span class="special">==</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">y</span> <span class="special">==</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_operator_equal_value"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&amp;</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="keyword">operator</span><span class="special">=</span>
  <span class="special">(</span> <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">rhs</span> <span class="special">)</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>将值&nbsp;<code class="computeroutput"><span class="identifier">rhs</span></code> 赋给一个 <code class="computeroutput"><span class="identifier">optional</span></code>.
  </li>


  <li>
    <b>后续条件：</b><code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code><b></b> 为已初始化的，其值为&nbsp;<code class="computeroutput"><span class="identifier">rhs</span></code><b>&nbsp;</b>的拷贝。 </li>


  <li>
    <b>抛出：</b>由 <code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="keyword">operator</span><span class="special">=(</span>
    <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span>
    <span class="special">)</span></code> 或 <code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span><span class="identifier">T</span>
    <span class="keyword">const</span><span class="special">&amp;)</span></code> 抛出的任何异常。
  </li>


  <li>
    <b>说明：</b>如果&nbsp;<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 是已初始化的，则使用 T 的赋值操作符，否则使用它的复制构造函数。 </li>


  <li>
    <b>异常安全性：</b>如果发生异常，<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 的初始化状态不会改变，它的值是不确定的直至&nbsp;<code class="computeroutput"><span class="identifier">optional</span></code> 被关联(由 <code class="computeroutput"><span class="identifier">T</span></code> 的&nbsp;<code class="computeroutput"><span class="keyword">operator</span><span class="special">=()</span></code> 进行)。如 <b>*</b><code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 原来是未初始化的，且 <code class="computeroutput"><span class="identifier">T</span></code> 的<i>复制构造函数</i> 失败了，则 <code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 仍为未初始化的。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">x</span><span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">def</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">opt</span><span class="special">(</span><span class="identifier">x</span><span class="special">)</span> <span class="special">;</span><br><span class="identifier">T</span> <span class="identifier">y</span><span class="special">;</span><br><span class="identifier">def</span> <span class="special">=</span> <span class="identifier">y</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">def</span> <span class="special">==</span> <span class="identifier">y</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">opt</span> <span class="special">=</span> <span class="identifier">y</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">opt</span> <span class="special">==</span> <span class="identifier">y</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;&amp;</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;::</span><span class="keyword">operator</span><span class="special">=</span>
  <span class="special">(</span> <span class="identifier">T</span><span class="special">&amp;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">rhs</span> <span class="special">)</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>(重)绑定被包装的引用。 </li>


  <li>
    <b>后续条件：</b><span class="bold"><strong></strong></span><code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 已初始化且引向由&nbsp;<code class="computeroutput"><span class="identifier">rhs</span></code><b> </b>所引向的对象。
  </li>


  <li>
    <b>说明：</b>如果&nbsp;<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 已初始化，则重绑定到新的对象。有关细节请见 <a class="link" href="../index.html#optional_refassign">这里</a>。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="keyword">int</span> <span class="identifier">a</span> <span class="special">=</span> <span class="number">1</span> <span class="special">;</span><br><span class="keyword">int</span> <span class="identifier">b</span> <span class="special">=</span> <span class="number">2</span> <span class="special">;</span><br><span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">ra</span> <span class="special">=</span> <span class="identifier">a</span> <span class="special">;</span><br><span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">rb</span> <span class="special">=</span> <span class="identifier">b</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&amp;&gt;</span> <span class="identifier">def</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&amp;&gt;</span> <span class="identifier">opt</span><span class="special">(</span><span class="identifier">ra</span><span class="special">)</span> <span class="special">;</span><br><span class="identifier">def</span> <span class="special">=</span> <span class="identifier">rb</span> <span class="special">;</span> <span class="comment">// 通过 'rb' 将 'def' 绑定到 'b'<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">def</span> <span class="special">==</span> <span class="identifier">b</span> <span class="special">)</span> <span class="special">;</span><br><span class="special">*</span><span class="identifier">def</span> <span class="special">=</span> <span class="identifier">a</span> <span class="special">;</span> <span class="comment">// 将 'b' 的值修改为 'a' 的值的拷贝<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">b</span> <span class="special">==</span> <span class="identifier">a</span> <span class="special">)</span> <span class="special">;</span><br><span class="keyword">int</span> <span class="identifier">c</span> <span class="special">=</span> <span class="number">3</span><span class="special">;</span><br><span class="keyword">int</span><span class="special">&amp;</span> <span class="identifier">rc</span> <span class="special">=</span> <span class="identifier">c</span> <span class="special">;</span><br><span class="identifier">opt</span> <span class="special">=</span> <span class="identifier">rc</span> <span class="special">;</span> <span class="comment">// 通过 'rc' 绑定到 'c'<br></span><span class="identifier">c</span> <span class="special">=</span> <span class="number">4</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">opt</span> <span class="special">==</span> <span class="number">4</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_operator_equal_optional"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&amp;</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="keyword">operator</span><span class="special">=</span>
  <span class="special">(</span> <span class="identifier">optional</span> <span class="keyword">const</span><span class="special">&amp;</span>
  <span class="identifier">rhs</span> <span class="special">)</span> <span class="special">;</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>将另一个 <code class="computeroutput"><span class="identifier">optional </span></code>赋值给一个 <code class="computeroutput"><span class="identifier">optional</span></code>.
  </li>


  <li>
    <b>后续条件：</b>如果 <code class="computeroutput"><span class="identifier">rhs </span></code>已初始化，则&nbsp;<code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>为已初始化且其值为 <code class="computeroutput"><span class="identifier">rhs</span></code>&nbsp;值的拷贝；否则&nbsp;<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 为未初始化。 </li>


  <li>
    <b>抛出：</b>由&nbsp;<code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="keyword">operator</span><span class="special">(</span>
    <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;)</span></code> 或 <code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span>
    <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span>
    <span class="special">)</span></code> 抛出的任何异常。 </li>


  <li>
    <b>说明：</b>如果<code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>和 <code class="computeroutput"><span class="identifier">rhs </span></code>均已初始化，则使用&nbsp;<code class="computeroutput"><span class="identifier">T</span></code> 的 <i>赋值操作符</i>。如果 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>已初始化而 <code class="computeroutput"><span class="identifier">rhs </span></code>未初始化，则调用&nbsp;<code class="computeroutput"><span class="identifier">T</span></code> 的 <i>析构函数</i>。如果 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>未初始化而&nbsp;<code class="computeroutput"><span class="identifier">rhs</span></code> 已初始化，则调用&nbsp;<code class="computeroutput"><span class="identifier">T</span></code> 的 
    <i>复制构造函数</i>。</li>

  <li>&nbsp;<b>异常安全性：</b>发生异常时，<code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>的初始化状态不改变，其值是不确定的直至 optional 被关联(由 <code class="computeroutput"><span class="identifier">T</span></code> 的&nbsp;<code class="computeroutput"><span class="keyword">operator</span><span class="special">=()</span></code> 进行) [如果 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>原来是未初始化的而且 <code class="computeroutput"><span class="identifier">T</span></code> 的 <i>复制构造函数</i> 失败，则 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>保持为未初始化]</li>

  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">v</span><span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">opt</span><span class="special">(</span><span class="identifier">v</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">def</span> <span class="special">;</span><br><span class="identifier">opt</span> <span class="special">=</span> <span class="identifier">def</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">!</span><span class="identifier">def</span> <span class="special">)</span> <span class="special">;</span><br><span class="comment">// 'opt'的原值('v'的拷贝)被销毁<br></span></pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span>
  <span class="special">&amp;</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;::</span><span class="keyword">operator</span><span class="special">=</span>
  <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">rhs</span> <span class="special">)</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>(重)绑定被包装的引用。 </li>


  <li>
    <b>后续条件：</b>如果&nbsp;<code class="computeroutput"><span class="special">*</span><span class="identifier">rhs </span></code>已初始化，则 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>为已初始化的且引向且引向由&nbsp;<code class="computeroutput"><span class="special">*</span><span class="identifier">rhs</span></code><b> 
    </b>所引向的对象；否则 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>为未初始化(不引向任何对象)。 </li>


  <li>
    <b>说明：</b>如果 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>已初始化且 *rhs 也是，则重绑定到新的对象。有关细节请见<span class="bold"><strong></strong></span> <a class="link" href="../index.html#optional_refassign">这里</a>。</li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="keyword">int</span> <span class="identifier">a</span> <span class="special">=</span> <span class="number">1</span> <span class="special">;</span><br><span class="keyword">int</span> <span class="identifier">b</span> <span class="special">=</span> <span class="number">2</span> <span class="special">;</span><br><span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">ra</span> <span class="special">=</span> <span class="identifier">a</span> <span class="special">;</span><br><span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">rb</span> <span class="special">=</span> <span class="identifier">b</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&amp;&gt;</span> <span class="identifier">def</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&amp;&gt;</span> <span class="identifier">ora</span><span class="special">(</span><span class="identifier">ra</span><span class="special">)</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&amp;&gt;</span> <span class="identifier">orb</span><span class="special">(</span><span class="identifier">rb</span><span class="special">)</span> <span class="special">;</span><br><span class="identifier">def</span> <span class="special">=</span> <span class="identifier">orb</span> <span class="special">;</span> <span class="comment">// 通过'orb'中包装的'rb'将'def'绑定到'b'<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">def</span> <span class="special">==</span> <span class="identifier">b</span> <span class="special">)</span> <span class="special">;</span><br><span class="special">*</span><span class="identifier">def</span> <span class="special">=</span> <span class="identifier">ora</span> <span class="special">;</span> <span class="comment">// 将'b'的值修改为'a'值的拷贝<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">b</span> <span class="special">==</span> <span class="identifier">a</span> <span class="special">)</span> <span class="special">;</span><br><span class="keyword">int</span> <span class="identifier">c</span> <span class="special">=</span> <span class="number">3</span><span class="special">;</span><br><span class="keyword">int</span><span class="special">&amp;</span> <span class="identifier">rc</span> <span class="special">=</span> <span class="identifier">c</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&amp;&gt;</span> <span class="identifier">orc</span><span class="special">(</span><span class="identifier">rc</span><span class="special">)</span> <span class="special">;</span><br><span class="identifier">ora</span> <span class="special">=</span> <span class="identifier">orc</span> <span class="special">;</span> <span class="comment">// 通过'rc'将ora重绑定到'c'<br></span><span class="identifier">c</span> <span class="special">=</span> <span class="number">4</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">ora</span> <span class="special">==</span> <span class="number">4</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_operator_equal_other_optional"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">template</span><span class="special">&lt;</span><span class="identifier">U</span><span class="special">&gt;</span>
  <span class="identifier">optional</span><span class="special">&amp;</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="keyword">operator</span><span class="special">=</span>
  <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">U</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">rhs</span> <span class="special">)</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>将另一个<span style="font-style: italic;">可转换的</span> <b>optional</b> 赋值给一个 
    <b>optional</b>. </li>


  <li>
    <b>后续条件：</b>如果 <code class="computeroutput"><span class="identifier">rhs </span></code>已初始化，则 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>也是已初始化的，且其值为&nbsp;<code class="computeroutput"><span class="identifier">rhs</span></code> 
    <i>转换</i>为类型 T 后的值的拷贝；否则 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>为未初始化。<span class="bold"><strong></strong></span> </li>


  <li>
    <b>抛出：</b>由&nbsp;<code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="keyword">operator</span><span class="special">=(</span>
    <span class="identifier">U</span> <span class="keyword">const</span><span class="special">&amp;</span>
    <span class="special">)</span></code> 或 <code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span> <span class="identifier">U</span>
    <span class="keyword">const</span><span class="special">&amp;</span> <span class="special">)</span></code> 抛出的任何异常。 </li>


  <li>
    <b>说明：</b>如果<code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>和 <b>rhs</b> 均已初始化，则使用&nbsp;<code class="computeroutput"><span class="identifier">T</span></code> 的 <i>赋值操作符</i> (from U)。如果 
    <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>已初始化而 <b>rhs</b> 未初始化，则调用&nbsp;<code class="computeroutput"><span class="identifier">T</span></code> 的 <i>析构函数</i>。如果 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>未初始化而 rhs 
已初始化，则调用&nbsp;<code class="computeroutput"><span class="identifier">T</span></code> 的 <i>转换构造函数</i> (从 <code class="computeroutput"><span class="identifier">U</span></code> 转换)。 </li>


  <li>
    <b>异常安全性：</b>发生异常时，<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 的初始化状态不改变，其值是不确定的直至 optional 被关联(由&nbsp;<code class="computeroutput"><span class="identifier">T</span></code> 的
    <code class="computeroutput"><span class="keyword">operator</span><span class="special">=()</span></code> 进行)。如果&nbsp;<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code><b></b> 原来是未初始化的而且 T 的 <i>转换构造函数</i> 失败，则&nbsp;<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 
保持为未初始化。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">v</span><span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">opt0</span><span class="special">(</span><span class="identifier">v</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">U</span><span class="special">&gt;</span> <span class="identifier">opt1</span><span class="special">;</span><br><span class="identifier">opt1</span> <span class="special">=</span> <span class="identifier">opt0</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">opt1</span> <span class="special">==</span> <span class="keyword">static_cast</span><span class="special">&lt;</span><span class="identifier">U</span><span class="special">&gt;(</span><span class="identifier">v</span><span class="special">)</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_reset_value"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">void</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">reset</span><span class="special">(</span>
  <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span>
  <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li><b>不建议使用：</b>相当于 <code class="computeroutput"><span class="keyword">operator</span><span class="special">=</span>
    <span class="special">(</span> <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">v</span><span class="special">)</span>
    <span class="special">;</span></code>
  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_reset"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">void</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">reset</span><span class="special">()</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li><b>不建议使用：</b>相当于&nbsp;<code class="computeroutput"><span class="keyword">operator</span><span class="special">=(</span>
    <span class="identifier">detail</span><span class="special">::</span><span class="identifier">none_t</span>
    <span class="special">);</span></code>
  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_get"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="keyword">operator</span><span class="special">*()</span>
  <span class="keyword">const</span> <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span><span class="special">&amp;</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="keyword">operator</span><span class="special">*();</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">get</span><span class="special">()</span>
  <span class="keyword">const</span> <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span><span class="special">&amp;</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">get</span><span class="special">()</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">inline</span> <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">get</span> <span class="special">(</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="special">)</span> <span class="special">;</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">inline</span> <span class="identifier">T</span><span class="special">&amp;</span>
  <span class="identifier">get</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;</span>
  <span class="special">&amp;)</span> <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>要求：</b><span class="bold"><strong></strong></span><code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>已初始化。 </li>


  <li>
    <b>返回：</b>所含值的引用。&nbsp; </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <b>说明：</b>以 <code class="computeroutput"><span class="identifier">BOOST_ASSERT</span><span class="special">()</span></code> 对前提条件进行断言。 </li>


  <li>
    <span style="font-weight: bold;">例子：</span><span class="bold"><strong></strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">v</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">opt</span> <span class="special">(</span> <span class="identifier">v</span> <span class="special">);</span><br><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">u</span> <span class="special">=</span> <span class="special">*</span><span class="identifier">opt</span><span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">u</span> <span class="special">==</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">T</span> <span class="identifier">w</span> <span class="special">;</span><br><span class="special">*</span><span class="identifier">opt</span> <span class="special">=</span> <span class="identifier">w</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">opt</span> <span class="special">==</span> <span class="identifier">w</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_get_value_or_value"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">get_value_or</span><span class="special">(</span> <span class="identifier">T</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="keyword">default</span><span class="special">)</span>
  <span class="keyword">const</span> <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span><span class="special">&amp;</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">get_value_or</span><span class="special">(</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="keyword">default</span> <span class="special">)</span> <span class="special">;</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">inline</span> <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">get_optional_value_or</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">o</span><span class="special">,</span>
  <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span>
  <span class="keyword">default</span> <span class="special">)</span> <span class="special">;</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">inline</span> <span class="identifier">T</span><span class="special">&amp;</span>
  <span class="identifier">get_optional_value_or</span>
  <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;&amp;</span>
  <span class="identifier">o</span><span class="special">,</span> <span class="identifier">T</span><span class="special">&amp;</span> <span class="keyword">default</span> <span class="special">)</span> <span class="special">;</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>返回：</b>如果有，则返回所含值(本身可以是引用)的引用, 否则返回&nbsp;<code class="computeroutput"><span class="keyword">default</span></code>.
  </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <span style="font-weight: bold;">例子：</span><span class="bold"><strong></strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">v</span><span class="special">,</span> <span class="identifier">z</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">def</span><span class="special">;</span><br><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">y</span> <span class="special">=</span> <span class="identifier">def</span><span class="special">.</span><span class="identifier">get_value_or</span><span class="special">(</span><span class="identifier">z</span><span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">y</span> <span class="special">==</span> <span class="identifier">z</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">opt</span> <span class="special">(</span> <span class="identifier">v</span> <span class="special">);</span><br><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">u</span> <span class="special">=</span> <span class="identifier">get_optional_value_or</span><span class="special">(</span><span class="identifier">opt</span><span class="special">,</span><span class="identifier">z</span><span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">u</span> <span class="special">==</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">u</span> <span class="special">!=</span> <span class="identifier">z</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;::</span><span class="keyword">operator</span><span class="special">*()</span>
  <span class="keyword">const</span> <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span> <span class="special">&amp;</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;::</span><span class="keyword">operator</span><span class="special">*();</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;::</span><span class="identifier">get</span><span class="special">()</span>
  <span class="keyword">const</span> <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span><span class="special">&amp;</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;::</span><span class="identifier">get</span><span class="special">()</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">inline</span> <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">get</span> <span class="special">(</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="special">)</span> <span class="special">;</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">inline</span> <span class="identifier">T</span><span class="special">&amp;</span>
  <span class="identifier">get</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span>
  <span class="special">&amp;)</span> <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>要求：</b><span class="bold"><strong></strong></span><code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>已初始化。 </li>


  <li>
    <b>返回：</b>所包含的引用。 </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <b>说明：</b>以&nbsp;<code class="computeroutput"><span class="identifier">BOOST_ASSERT</span><span class="special">()</span></code> 对前提条件进行断言。<span class="bold"><strong></strong></span> </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">v</span> <span class="special">;</span><br><span class="identifier">T</span><span class="special">&amp;</span> <span class="identifier">vref</span> <span class="special">=</span> <span class="identifier">v</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&amp;&gt;</span> <span class="identifier">opt</span> <span class="special">(</span> <span class="identifier">vref</span> <span class="special">);</span><br><span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">vref2</span> <span class="special">=</span> <span class="special">*</span><span class="identifier">opt</span><span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">vref2</span> <span class="special">==</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span><br><span class="special">++</span> <span class="identifier">v</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">opt</span> <span class="special">==</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_get_ptr"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span> <span class="keyword">const</span><span class="special">*</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">get_ptr</span><span class="special">()</span> <span class="keyword">const</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span><span class="special">*</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="identifier">get_ptr</span><span class="special">()</span> <span class="special">;</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">inline</span> <span class="identifier">T</span> <span class="keyword">const</span><span class="special">*</span> <span class="identifier">get_pointer</span>
  <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="special">)</span> <span class="special">;</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">inline</span> <span class="identifier">T</span><span class="special">*</span>
  <span class="identifier">get_pointer</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;</span>
  <span class="special">&amp;)</span> <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>返回：</b>如果 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>已初始化，则返回所含值的指针；否则返回 0 (<i>null</i>).&nbsp;<span class="bold"><strong></strong></span>
  </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <b>说明：</b>所含值被&nbsp;<code class="computeroutput"><span class="special">*</span><span class="keyword">this</span></code> 永久保留，所以你不能持有或删除该指针。<span class="bold"><strong></strong></span> </li>


  <li>
    <span style="font-weight: bold;">例子：</span><span class="bold"><strong></strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">v</span><span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">opt</span><span class="special">(</span><span class="identifier">v</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">const</span> <span class="identifier">copt</span><span class="special">(</span><span class="identifier">v</span><span class="special">);</span><br><span class="identifier">T</span><span class="special">*</span> <span class="identifier">p</span> <span class="special">=</span> <span class="identifier">opt</span><span class="special">.</span><span class="identifier">get_ptr</span><span class="special">()</span> <span class="special">;</span><br><span class="identifier">T</span> <span class="keyword">const</span><span class="special">*</span> <span class="identifier">cp</span> <span class="special">=</span> <span class="identifier">copt</span><span class="special">.</span><span class="identifier">get_ptr</span><span class="special">();</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">p</span> <span class="special">==</span> <span class="identifier">get_pointer</span><span class="special">(</span><span class="identifier">opt</span><span class="special">)</span> <span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">cp</span> <span class="special">==</span> <span class="identifier">get_pointer</span><span class="special">(</span><span class="identifier">copt</span><span class="special">)</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_operator_arrow"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span> <span class="keyword">const</span><span class="special">*</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="keyword">operator</span> <span class="special">-&gt;()</span> <span class="keyword">const</span> <span class="special">;</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">T</span><span class="special">*</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;::</span><span class="keyword">operator</span> <span class="special">-&gt;()</span> <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>要求：</b><span class="bold"><strong></strong></span><code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>已初始化。 </li>


  <li>
    <b>返回：</b>所含值的指针。 </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <span style="font-weight: bold;">说明</span><b>：</b>以&nbsp;<code class="computeroutput"><span class="identifier">BOOST_ASSERT</span><span class="special">()</span></code> 对前提条件进行断言。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="keyword">struct</span> <span class="identifier">X</span> <span class="special">{</span> <span class="keyword">int</span> <span class="identifier">mdata</span> <span class="special">;</span> <span class="special">}</span> <span class="special">;</span><br><span class="identifier">X</span> <span class="identifier">x</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">X</span><span class="special">&gt;</span> <span class="identifier">opt</span> <span class="special">(</span><span class="identifier">x</span><span class="special">);</span><br><span class="identifier">opt</span><span class="special">-&gt;</span><span class="identifier">mdata</span> <span class="special">=</span> <span class="number">2</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_operator_bool"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="keyword">operator</span> </code><span class="emphasis"><em>unspecified-bool-type</em></span><code class="computeroutput"><span class="special">()</span>
  <span class="keyword">const</span> <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>返回：</b>一个未明确规定的值，该值可用于布尔上下文中，等同于&nbsp; (<code class="computeroutput"><span class="identifier">get</span><span class="special">()</span>
    <span class="special">!=</span> <span class="number">0</span></code>) </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">def</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">def</span> <span class="special">==</span> <span class="number">0</span> <span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">opt</span> <span class="special">(</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">opt</span> <span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">opt</span> <span class="special">!=</span> <span class="number">0</span> <span class="special">);</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_operator_not"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">bool</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="keyword">operator</span><span class="special">!()</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>返回：</b>如果 <code class="computeroutput"><span class="special">*</span><span class="keyword">this </span></code>未初始化，则返回&nbsp;<code class="computeroutput"><span class="keyword">true</span></code>; 否则返回 <span class="bold"><strong></strong></span><code class="computeroutput"><span class="keyword">false</span></code>.
  </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <span class="bold"><strong>说明</strong></span><b>：</b>该操作提供给那些不能在布尔上下文中使用 <i>unspecified-bool-type</i> 操作符的编译器使用。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">opt</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">!</span><span class="identifier">opt</span> <span class="special">);</span><br><span class="special">*</span><span class="identifier">opt</span> <span class="special">=</span> <span class="identifier">some_T</span> <span class="special">;</span><br><span class="comment">// 注意这里的 "double-bang" 用法。<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="special">!!</span><span class="identifier">opt</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_optional_is_initialized"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">bool</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">is_initialized</span><span class="special">()</span> <span class="keyword">const</span>
  <span class="special">;</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>返回：</b><span class="bold"><strong></strong></span><code class="computeroutput"><span class="keyword">true</span></code> 如果 <code class="computeroutput"><span class="identifier">optional </span></code>已初始化，否则 <code class="computeroutput"><span class="keyword">false</span></code>&nbsp;. </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <span style="font-weight: bold;">例子：</span><span class="bold"><strong></strong></span>
    
    <pre class="programlisting"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">def</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">!</span><span class="identifier">def</span><span class="special">.</span><span class="identifier">is_initialized</span><span class="special">()</span> <span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">opt</span> <span class="special">(</span> <span class="identifier">v</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">opt</span><span class="special">.</span><span class="identifier">is_initialized</span><span class="special">()</span> <span class="special">);</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="boost_optional.detailed_semantics.free_functions"></a>
<h4><a name="id2653594"></a> <a class="link" href="detailed_semantics.html#boost_optional.detailed_semantics.free_functions">Free
functions</a> </h4>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_make_optional_value"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;</span>
  <span class="identifier">make_optional</span><span class="special">(</span> <span class="identifier">T</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">v</span> <span class="special">)</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>返回：</b><code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;(</span><span class="identifier">v</span><span class="special">)</span></code>，从 <code>v</code> 推断类型 <code class="computeroutput"><span class="identifier">T</span></code> .
  </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">void</span> <span class="identifier">foo</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">opt</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">foo</span> <span class="special">(</span> <span class="identifier">make_optional</span><span class="special">(</span><span class="number">1</span><span class="special">+</span><span class="number">1</span><span class="special">)</span> <span class="special">)</span> <span class="special">;</span> <span class="comment">// 创建一个 optional&lt;int&gt;<br></span></pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_make_optional_bool_value"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span></code> <span class="emphasis"><em>(not a ref)</em></span><code class="computeroutput"><span class="special">&gt;</span>
  <span class="identifier">make_optional</span><span class="special">(</span> <span class="keyword">bool</span>
  <span class="identifier">condition</span><span class="special">,</span> <span class="identifier">T</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">v</span> <span class="special">)</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    </li>
  <li>
    <b>返回：</b><code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;(</span><span class="identifier"></span></code><code class="computeroutput"><span class="identifier">condition</span><span class="special">,</span></code><code class="computeroutput"><span class="identifier">v</span><span class="special">)</span></code>，从 <code>v</code> 推断类型 <code class="computeroutput"><span class="identifier">T</span></code> .
  </li>
  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">optional</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;</span> <span class="identifier">calculate_foo</span><span class="special">()</span><br><span class="special">{</span><br><span class="keyword">double</span> <span class="identifier">val</span> <span class="special">=</span> <span class="identifier">compute_foo</span><span class="special">();</span><br><span class="keyword">return</span> <span class="identifier">make_optional</span><span class="special">(</span><span class="identifier">is_not_nan_and_finite</span><span class="special">(</span><span class="identifier">val</span><span class="special">),</span><span class="identifier">val</span><span class="special">);</span><br><span class="special">}</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="keyword">double</span><span class="special">&gt;</span> <span class="identifier">v</span> <span class="special">=</span> <span class="identifier">calculate_foo</span><span class="special">();</span><br><span class="keyword">if</span> <span class="special">(</span> <span class="special">!</span><span class="identifier">v</span> <span class="special">)</span><br><span class="identifier">error</span><span class="special">(</span><span class="string">"foo wasn't computed"</span><span class="special">);</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_operator_compare_equal_optional_optional"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">bool</span> <span class="keyword">operator</span>
  <span class="special">==</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">x</span><span class="special">,</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">y</span> <span class="special">);</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>返回：</b>如果&nbsp;<code class="computeroutput"><span class="identifier">x</span></code> 和 <code class="computeroutput"><span class="identifier">y</span></code><b></b> 均已初始化，则返回 <code>(*x == *y)</code>. 如果只有 <code class="computeroutput"><span class="identifier">x</span></code> 或 <code class="computeroutput"><span class="identifier">y</span></code> 
已初始化，则返回&nbsp;<code class="computeroutput"><span class="keyword">false</span></code>. 如果均未初始化，则返回&nbsp;<code class="computeroutput"><span class="keyword">true</span></code>. </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <span style="font-weight: bold;">说明</span><b>：</b>指针的比较操作符是"浅比较"的，而 <code class="computeroutput"><span class="identifier">optional </span></code>是"深比较"的。不要在使用 <code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span></code> 
或指针的泛型代码中直接使用 <code class="computeroutput"><span class="keyword">operator</span>
    <span class="special">==</span></code>；应使用&nbsp;<a href="../../utility/OptionalPointee.html#equal"> </a><a href="../../../../utility/OptionalPointee.html#equal" target="_top"><code class="computeroutput"><span class="identifier">equal_pointees</span><span class="special">()</span></code></a> 来替代。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">x</span><span class="special">(</span><span class="number">12</span><span class="special">);</span><br><span class="identifier">T</span> <span class="identifier">y</span><span class="special">(</span><span class="number">12</span><span class="special">);</span><br><span class="identifier">T</span> <span class="identifier">z</span><span class="special">(</span><span class="number">21</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">def0</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">def1</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">optX</span><span class="special">(</span><span class="identifier">x</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">optY</span><span class="special">(</span><span class="identifier">y</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">optZ</span><span class="special">(</span><span class="identifier">z</span><span class="special">);</span><br><span class="comment">// 总是保持同一性<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">def0</span> <span class="special">==</span> <span class="identifier">def0</span> <span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">optX</span> <span class="special">==</span> <span class="identifier">optX</span> <span class="special">);</span><br><span class="comment">// 未初始化的对象是相等的<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">def0</span> <span class="special">==</span> <span class="identifier">def1</span> <span class="special">);</span><br><span class="comment">// 只有一个初始化对象则是不等的<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">def0</span> <span class="special">!=</span> <span class="identifier">optX</span> <span class="special">);</span><br><span class="comment">// 已初始化的对象则要比较 (*lhs == *rhs)<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">optX</span> <span class="special">==</span> <span class="identifier">optY</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">optX</span> <span class="special">!=</span> <span class="identifier">optZ</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_operator_compare_less_optional_optional"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">bool</span> <span class="keyword">operator</span>
  <span class="special">&lt;</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">x</span><span class="special">,</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">y</span> <span class="special">);</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li><b>返回：</b>如果 <code class="computeroutput"><span class="identifier">y</span></code><b></b> 未初始化，则返回&nbsp;<code class="computeroutput"><span class="keyword">false</span></code>. 如果 <code class="computeroutput"><span class="identifier">y</span></code><b></b> 已初始而 <code class="computeroutput"><span class="identifier">x </span></code>未初始化，则返回&nbsp;<code class="computeroutput"><span class="keyword">true</span></code>. 如果&nbsp;<code class="computeroutput"><span class="identifier">x</span></code> 和 <code class="computeroutput"><span class="identifier">y</span></code> 均已初始化，则返回 <code>(*x &lt; 
*y)</code>. </li>


  <li>
    <b>抛出：</b>无。 </li>


  <li>
    <span class="bold"><strong>说明</strong></span><b>：</b>指针的比较操作符是"浅比较"的，而 <code class="computeroutput"><span class="identifier">optional </span></code>是"深比较"的。不要在使用&nbsp;<code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span></code> 
或指针的泛型代码中直接使用 <code class="computeroutput"><span class="keyword">operator</span>
    <span class="special">&lt;</span></code>；应使用 <a href="../../../../utility/OptionalPointee.html#less" target="_top"><code class="computeroutput"><span class="identifier">less_pointees</span><span class="special">()</span></code></a> 来替代。 </li>


  <li>
    <span class="bold"><strong>例子：</strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">x</span><span class="special">(</span><span class="number">12</span><span class="special">);</span><br><span class="identifier">T</span> <span class="identifier">y</span><span class="special">(</span><span class="number">34</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">def</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">optX</span><span class="special">(</span><span class="identifier">x</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">optY</span><span class="special">(</span><span class="identifier">y</span><span class="special">);</span><br><span class="comment">// 总是保持同一性<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="special">!(</span><span class="identifier">def</span> <span class="special">&lt;</span> <span class="identifier">def</span><span class="special">)</span> <span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">optX</span> <span class="special">==</span> <span class="identifier">optX</span> <span class="special">);</span><br><span class="comment">// 两个未初始化对象是相等的<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">def0</span> <span class="special">==</span> <span class="identifier">def1</span> <span class="special">);</span><br><span class="comment">// 只有一个已初始化对象则是不等的<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">def0</span> <span class="special">!=</span> <span class="identifier">optX</span> <span class="special">);</span><br><span class="comment">// 两个已初始化对象则要比较 (*lhs == *rhs)<br></span><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">optX</span> <span class="special">==</span> <span class="identifier">optY</span> <span class="special">)</span> <span class="special">;</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="identifier">optX</span> <span class="special">!=</span> <span class="identifier">optZ</span> <span class="special">)</span> <span class="special">;</span>
    </pre>


  </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_operator_compare_not_equal_optional_optional"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">bool</span> <span class="keyword">operator</span>
  <span class="special">!=</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">x</span><span class="special">,</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">y</span> <span class="special">);</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <span style="font-weight: bold;">返回：</span><span class="bold"><strong></strong></span><code class="computeroutput"><span class="special">!(</span>
    <span class="identifier">x</span> <span class="special">==</span> <span class="identifier">y</span>
    <span class="special">);</span></code>
  </li>


  <li>
    <span class="bold"><strong>抛出：</strong></span>无。 </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_operator_compare_greater_optional_optional"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">bool</span> <span class="keyword">operator</span>
  <span class="special">&gt;</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">x</span><span class="special">,</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">y</span> <span class="special">);</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <span style="font-weight: bold;">返回：</span><span class="bold"><strong></strong></span><code class="computeroutput"><span class="special">(</span>
    <span class="identifier">y</span> <span class="special">&lt;</span> <span class="identifier">x</span> <span class="special">);</span></code>
  </li>


  <li>
    <span class="bold"><strong>抛出：</strong></span>无。 </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_operator_compare_less_or_equal_optional_optional"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">bool</span> <span class="keyword">operator</span>
  <span class="special">&lt;=</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">x</span><span class="special">,</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">y</span> <span class="special">);</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <span style="font-weight: bold;">返回：</span><span class="bold"><strong></strong></span><code class="computeroutput"><span class="special">!(</span>
    <span class="identifier">y</span><span class="special">&lt;</span><span class="identifier">x</span> <span class="special">);</span></code>
  </li>


  <li>
    <span class="bold"><strong>抛出：</strong></span>无。 </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_operator_compare_greater_or_equal_optional_optional"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">bool</span> <span class="keyword">operator</span>
  <span class="special">&gt;=</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">x</span><span class="special">,</span>
  <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span>
  <span class="keyword">const</span><span class="special">&amp;</span> <span class="identifier">y</span> <span class="special">);</span></code>
  </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <span style="font-weight: bold;">返回：</span><span class="bold"><strong></strong></span><code class="computeroutput"><span class="special">!(</span>
    <span class="identifier">x</span><span class="special">&lt;</span><span class="identifier">y</span> <span class="special">);</span></code>
  </li>


  <li>
    <span class="bold"><strong>抛出：</strong></span>无。 </li>


</ul>


</div>


<p> <span class="inlinemediaobject"><img src="../images/space.png" alt="space"></span> </p>


<a name="reference_swap_optional_optional"></a>
<p> </p>


<div class="blockquote">
<blockquote class="blockquote">
  
  <p> </p>


  
  <p> <code class="computeroutput"><span class="keyword">void</span> <span class="identifier">swap</span> <span class="special">(</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;&amp;</span>
  <span class="identifier">x</span><span class="special">,</span> <span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;&amp;</span>
  <span class="identifier">y</span> <span class="special">);</span></code> </p>


  
  <p> </p>


</blockquote>


</div>


<div class="itemizedlist">
<ul type="disc">


  <li>
    <b>作用：</b>如果 <code class="computeroutput"><span class="identifier">x</span></code> 和 <code class="computeroutput"><span class="identifier">y</span></code> 均已初始化，则调用&nbsp;<code>swap(*x,*y)</code>，使用 <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">swap</span></code>. 如果只有一个已初始化，如 <code class="computeroutput"><span class="identifier">x</span></code>, 则调用：<code>y = *x; x = 
boost:none;</code><br>
如果均未初始化，则为空操作。<span class="bold"><strong></strong></span> </li>


  <li>
    <b>后续条件：</b><code class="computeroutput"><span class="identifier">x</span></code> 和 <code class="computeroutput"><span class="identifier">y</span></code> 的状态被交换。 </li>


  <li>
    <b>抛出：</b>如果均已初始化，则抛出&nbsp;<code class="computeroutput"><span class="identifier">swap</span><span class="special">(</span><span class="identifier">T</span><span class="special">&amp;,</span><span class="identifier">T</span><span class="special">&amp;)</span></code> 所抛出的任何异常。如果只有一个已初始化，则抛出&nbsp;<code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span>
    <span class="special">(</span> <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span> <span class="special">)</span></code> 所抛出的任何异常。 </li>


  <li>
    <span style="font-weight: bold;">说明</span><b>：</b>如果均已初始化，则使用未限定的&nbsp;<code class="computeroutput"><span class="identifier">swap</span><span class="special">(</span><span class="identifier">T</span><span class="special">&amp;,</span><span class="identifier">T</span><span class="special">&amp;)</span></code>，不过&nbsp;<code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">swap</span></code> 
被引入到当前域中。如果只有一个已初始化，则调用 <code class="computeroutput"><span class="identifier">T</span><span class="special">::~</span><span class="identifier">T</span><span class="special">()</span></code> 和 <code class="computeroutput"><span class="identifier">T</span><span class="special">::</span><span class="identifier">T</span><span class="special">(</span>
    <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span>
    <span class="special">)</span></code>&nbsp;. </li>


  <li>
    <b>异常安全性：</b>如果均已初始化，则该操作具有 <code class="computeroutput"><span class="identifier">swap</span><span class="special">(</span><span class="identifier">T</span><span class="special">&amp;,</span><span class="identifier">T</span><span class="special">&amp;) </span></code>的异常安全性保证。如果只有一个已初始化，则该操作具有和&nbsp;<code class="computeroutput"><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;::</span><span class="identifier">reset</span><span class="special">(</span>
    <span class="identifier">T</span> <span class="keyword">const</span><span class="special">&amp;</span>
    <span class="special">)</span></code> 一样的基本保证。<span class="bold"><strong></strong></span> </li>


  <li>
    <span style="font-weight: bold;">例子：</span><span class="bold"><strong></strong></span>
    
    <pre class="programlisting"><span class="identifier">T</span> <span class="identifier">x</span><span class="special">(</span><span class="number">12</span><span class="special">);</span><br><span class="identifier">T</span> <span class="identifier">y</span><span class="special">(</span><span class="number">21</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">def0</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">def1</span> <span class="special">;</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">optX</span><span class="special">(</span><span class="identifier">x</span><span class="special">);</span><br><span class="identifier">optional</span><span class="special">&lt;</span><span class="identifier">T</span><span class="special">&gt;</span> <span class="identifier">optY</span><span class="special">(</span><span class="identifier">y</span><span class="special">);</span><br><span class="identifier">boost</span><span class="special">::</span><span class="identifier">swap</span><span class="special">(</span><span class="identifier">def0</span><span class="special">,</span><span class="identifier">def1</span><span class="special">);</span> <span class="comment">// no-op<br></span><br><span class="identifier">boost</span><span class="special">::</span><span class="identifier">swap</span><span class="special">(</span><span class="identifier">def0</span><span class="special">,</span><span class="identifier">optX</span><span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">def0</span> <span class="special">==</span> <span class="identifier">x</span> <span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">!</span><span class="identifier">optX</span> <span class="special">);</span><br><span class="identifier">boost</span><span class="special">::</span><span class="identifier">swap</span><span class="special">(</span><span class="identifier">def0</span><span class="special">,</span><span class="identifier">optX</span><span class="special">);</span> <span class="comment">// Get back to original values<br></span><br><span class="identifier">boost</span><span class="special">::</span><span class="identifier">swap</span><span class="special">(</span><span class="identifier">optX</span><span class="special">,</span><span class="identifier">optY</span><span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">optX</span> <span class="special">==</span> <span class="identifier">y</span> <span class="special">);</span><br><span class="identifier">assert</span> <span class="special">(</span> <span class="special">*</span><span class="identifier">optY</span> <span class="special">==</span> <span class="identifier">x</span> <span class="special">);</span>
    </pre>


  </li>


</ul>


</div>


</div>


<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%">


  <tbody>


    <tr>


      <td align="left"></td>


      <td align="right">
      
      <div class="copyright-footer">Copyright &copy;
2003 -2007 Fernando Luis Cacciola Carballal
      
      <p> Distributed under the Boost Software License, Version
1.0. (See accompanying file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>


      </div>


      </td>


    </tr>


  
  </tbody>
</table>


<hr>
<div class="spirit-nav"><a accesskey="p" href="synopsis.html"><img src="../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="examples.html"><img src="../../../../../doc/html/images/next.png" alt="Next"></a>
</div>


</body>
</html>
