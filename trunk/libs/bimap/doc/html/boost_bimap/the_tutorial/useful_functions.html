<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Useful functions &#26377;&#29992;&#30340;&#20989;&#25968;</title>
<link rel="stylesheet" href="../../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
<link rel="home" href="../../index.html" title="Chapter&#160;1.&#160;Boost.Bimap">
<link rel="up" href="../the_tutorial.html" title="The tutorial &#25351;&#21335;">
<link rel="prev" href="differences_with_standard_maps.html" title="Differences with standard maps &#19982;&#26631;&#20934;map&#30340;&#24046;&#24322;">
<link rel="next" href="bimaps_with_user_defined_names.html" title="Bimaps with user defined names &#29992;&#25143;&#33258;&#23450;&#20041;&#21517;&#23383;&#30340;Bimap">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../../boost.png"></td>
<td align="center"><a href="../../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="differences_with_standard_maps.html"><img src="../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../the_tutorial.html"><img src="../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="bimaps_with_user_defined_names.html"><img src="../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_bimap.the_tutorial.useful_functions"></a><a class="link" href="useful_functions.html" title="Useful functions &#26377;&#29992;&#30340;&#20989;&#25968;"> Useful functions
      &#26377;&#29992;&#30340;&#20989;&#25968;</a>
</h3></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="useful_functions.html#boost_bimap.the_tutorial.useful_functions.projection_of_iterators">
        Projection of iterators &#36845;&#20195;&#22120;&#30340;&#25237;&#23556;</a></span></dt>
<dt><span class="section"><a href="useful_functions.html#boost_bimap.the_tutorial.useful_functions.replace_and_modify">
        replace and modify &#26367;&#25442;&#21644;&#20462;&#25913;</a></span></dt>
<dt><span class="section"><a href="useful_functions.html#boost_bimap.the_tutorial.useful_functions.retrieval_of_ranges">
        Retrieval of ranges &#21306;&#38388;&#30340;&#21462;&#22238;</a></span></dt>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost_bimap.the_tutorial.useful_functions.projection_of_iterators"></a><a class="link" href="useful_functions.html#boost_bimap.the_tutorial.useful_functions.projection_of_iterators" title="Projection of iterators &#36845;&#20195;&#22120;&#30340;&#25237;&#23556;">
        Projection of iterators &#36845;&#20195;&#22120;&#30340;&#25237;&#23556;</a>
</h4></div></div></div>
<p>
          Iterators can be projected to any of the three views of the bimap. A bimap
          provides three member functions to cope with projection: <code class="computeroutput"><span class="identifier">project_left</span></code>, <code class="computeroutput"><span class="identifier">project_right</span></code>
          and <code class="computeroutput"><span class="identifier">project_up</span></code>, with projects
          iterators to the <span class="emphasis"><em>left map view</em></span>, the <span class="emphasis"><em>right
          map view</em></span> and the <span class="emphasis"><em>collection of relations view</em></span>.
          These functions take any iterator from the bimap and retrieve an iterator
          over the projected view pointing to the same element.<br> &#36845;&#20195;&#22120;&#21487;&#20197;&#34987;&#25237;&#23556;&#21040;
          bimap &#30340;&#19977;&#20010;&#35270;&#22270;&#20013;&#30340;&#20219;&#19968;&#20010;&#12290;bimap &#25552;&#20379;&#20102;&#19977;&#20010;&#25104;&#21592;&#20989;&#25968;&#26469;&#25191;&#34892;&#25237;&#23556;&#65306;<code class="computeroutput"><span class="identifier">project_left</span></code>, <code class="computeroutput"><span class="identifier">project_right</span></code>
          &#21644; <code class="computeroutput"><span class="identifier">project_up</span></code>, &#20998;&#21035;&#23558;&#36845;&#20195;&#22120;&#25237;&#23556;&#21040;
          <span class="emphasis"><em>&#24038;&#26144;&#23556;&#35270;&#22270;</em></span>&#12289;<span class="emphasis"><em>&#21491;&#26144;&#23556;&#35270;&#22270;</em></span>
          &#21644; <span class="emphasis"><em>&#20851;&#31995;&#32452;&#21512;&#35270;&#22270;</em></span>&#12290; &#36825;&#20123;&#20989;&#25968;&#20174; bimap &#25509;&#21463;&#19968;&#20010;&#36845;&#20195;&#22120;&#65292;&#24182;&#36820;&#22238;&#19968;&#20010;&#25351;&#21521;&#21516;&#19968;&#20803;&#32032;&#30340;&#34987;&#25237;&#23556;&#35270;&#22270;&#30340;&#36845;&#20195;&#22120;&#12290;
        </p>
<p>
          Here is an example that uses projection:<br> &#20197;&#19979;&#26159;&#19968;&#20010;&#20351;&#29992;&#25237;&#23556;&#30340;&#20363;&#23376;&#65306;
        </p>
<p>
          <a href="../../../../example/projection.cpp" target="_top">Go to source code &#23519;&#30475;&#28304;&#20195;&#30721;</a>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <span class="identifier">bimap</span><span class="special">&lt;</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">,</span><span class="identifier">multiset_of</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">greater</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">&gt;</span> <span class="special">&gt;</span> <span class="special">&gt;</span> <span class="identifier">bm_type</span><span class="special">;</span>

<span class="identifier">bm_type</span> <span class="identifier">bm</span><span class="special">;</span>
<span class="identifier">bm</span><span class="special">.</span><span class="identifier">insert</span><span class="special">(</span> <span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">value_type</span><span class="special">(</span><span class="string">"John"</span> <span class="special">,</span><span class="number">34</span><span class="special">)</span> <span class="special">);</span>
<span class="identifier">bm</span><span class="special">.</span><span class="identifier">insert</span><span class="special">(</span> <span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">value_type</span><span class="special">(</span><span class="string">"Peter"</span><span class="special">,</span><span class="number">24</span><span class="special">)</span> <span class="special">);</span>
<span class="identifier">bm</span><span class="special">.</span><span class="identifier">insert</span><span class="special">(</span> <span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">value_type</span><span class="special">(</span><span class="string">"Mary"</span> <span class="special">,</span><span class="number">12</span><span class="special">)</span> <span class="special">);</span>

<span class="comment">// Find the name of the next younger person after Peter
</span>
<span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">left_const_iterator</span> <span class="identifier">name_iter</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">find</span><span class="special">(</span><span class="string">"Peter"</span><span class="special">);</span>

<span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">right_const_iterator</span> <span class="identifier">years_iter</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">project_right</span><span class="special">(</span><span class="identifier">name_iter</span><span class="special">);</span>

<span class="special">++</span><span class="identifier">years_iter</span><span class="special">;</span>

<span class="identifier">std</span><span class="special">::</span><span class="identifier">cout</span> <span class="special">&lt;&lt;</span> <span class="string">"The next younger person after Peter is "</span> <span class="special">&lt;&lt;</span> <span class="identifier">years_iter</span><span class="special">-&gt;</span><span class="identifier">second</span><span class="special">;</span>
</pre>
<p>
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost_bimap.the_tutorial.useful_functions.replace_and_modify"></a><a class="link" href="useful_functions.html#boost_bimap.the_tutorial.useful_functions.replace_and_modify" title="replace and modify &#26367;&#25442;&#21644;&#20462;&#25913;">
        replace and modify &#26367;&#25442;&#21644;&#20462;&#25913;</a>
</h4></div></div></div>
<p>
          These functions are members of the views of a bimap that are not founded
          in their standard counterparts.<br> &#36825;&#20123;&#20989;&#25968;&#26159; bimap &#35270;&#22270;&#30340;&#25104;&#21592;&#20989;&#25968;&#65292;&#20294;&#22312;&#26631;&#20934;&#30340;&#23545;&#29031;&#29289;&#20013;&#26159;&#27809;&#26377;&#30340;&#12290;
        </p>
<p>
          The <code class="computeroutput"><span class="identifier">replace</span></code> family member
          functions performs in-place replacement of a given element as the following
          example shows:<br> <code class="computeroutput"><span class="identifier">replace</span></code>
          &#26063;&#25104;&#21592;&#20989;&#25968;&#23545;&#19968;&#20010;&#32508;&#21512;&#20803;&#32032;&#25191;&#34892;&#23601;&#22320;&#26367;&#25442;&#65292;&#22914;&#19979;&#21015;&#25152;&#31034;&#65306;
        </p>
<p>
          <a href="../../../../example/tutorial_modify_and_replace.cpp" target="_top">Go to source
          code &#23519;&#30475;&#28304;&#20195;&#30721;</a>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <span class="identifier">bimap</span><span class="special">&lt;</span> <span class="keyword">int</span><span class="special">,</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="special">&gt;</span> <span class="identifier">bm_type</span><span class="special">;</span>
<span class="identifier">bm_type</span> <span class="identifier">bm</span><span class="special">;</span>

<span class="identifier">bm</span><span class="special">.</span><span class="identifier">insert</span><span class="special">(</span> <span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">value_type</span><span class="special">(</span><span class="number">1</span><span class="special">,</span><span class="string">"one"</span><span class="special">)</span> <span class="special">);</span>

<span class="comment">// Replace (1,"one") with (1,"1") using the right map view
</span><span class="special">{</span>
    <span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">right_iterator</span> <span class="identifier">it</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">right</span><span class="special">.</span><span class="identifier">find</span><span class="special">(</span><span class="string">"one"</span><span class="special">);</span>

    <span class="keyword">bool</span> <span class="identifier">successful_replace</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">right</span><span class="special">.</span><span class="identifier">replace_key</span><span class="special">(</span> <span class="identifier">it</span><span class="special">,</span> <span class="string">"1"</span> <span class="special">);</span>

    <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">successful_replace</span> <span class="special">);</span>
<span class="special">}</span>

<span class="identifier">bm</span><span class="special">.</span><span class="identifier">insert</span><span class="special">(</span> <span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">value_type</span><span class="special">(</span><span class="number">2</span><span class="special">,</span><span class="string">"two"</span><span class="special">)</span> <span class="special">);</span>

<span class="comment">// Fail to replace (1,"1") with (1,"two") using the left map view
</span><span class="special">{</span>
    <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">2</span> <span class="special">);</span>

    <span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">left_iterator</span> <span class="identifier">it</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">find</span><span class="special">(</span><span class="number">1</span><span class="special">);</span>

    <span class="keyword">bool</span> <span class="identifier">successful_replace</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">replace_data</span><span class="special">(</span> <span class="identifier">it</span><span class="special">,</span> <span class="string">"two"</span> <span class="special">);</span>

    <a class="co" name="boost_bimap9co" href="useful_functions.html#boost_bimap9"><img src="../../../../../../doc/src/images/callouts/1.png" alt="1" border="0"></a><span class="identifier">assert</span><span class="special">(</span> <span class="special">!</span> <span class="identifier">successful_replace</span> <span class="special">);</span>
    <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">2</span> <span class="special">);</span>
<span class="special">}</span>
</pre>
<p>
        </p>
<p>
          </p>
<div class="calloutlist"><table border="0" summary="Callout list"><tr>
<td width="5%" valign="top" align="left"><p><a name="boost_bimap9"></a><a href="#boost_bimap9co"><img src="../../../../../../doc/src/images/callouts/1.png" alt="1" border="0"></a> </p></td>
<td valign="top" align="left"><p> <code class="computeroutput"><span class="identifier">it</span></code> is still valid here,
          and the bimap was left unchanged </p></td>
</tr></table></div>
<p>
        </p>
<p>
          <code class="computeroutput"><span class="identifier">replace</span></code> functions performs
          this substitution in such a manner that:<br> <code class="computeroutput"><span class="identifier">replace</span></code>
          &#20989;&#25968;&#25353;&#20197;&#19979;&#26041;&#24335;&#25191;&#34892;&#26367;&#25442;&#65306;
        </p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem">
              The complexity is constant time if the changed element retains its
              original order with respect to all views; it is logarithmic otherwise.<br>
              &#22914;&#26524;&#34987;&#26367;&#25442;&#20803;&#32032;&#23545;&#20110;&#25152;&#26377;&#35270;&#22270;&#37117;&#20445;&#25345;&#21407;&#26377;&#39034;&#24207;&#65292;&#21017;&#22797;&#26434;&#24230;&#20026;&#24120;&#37327;&#26102;&#38388;&#65307;&#21542;&#21017;&#20026;&#23545;&#25968;&#26102;&#38388;&#12290;
            </li>
<li class="listitem">
              Iterator and reference validity are preserved.<br> &#36845;&#20195;&#22120;&#21644;&#24341;&#29992;&#30340;&#26377;&#25928;&#24615;&#34987;&#20445;&#25345;&#12290;
            </li>
<li class="listitem">
              The operation is strongly exception-safe, i.e. the <code class="computeroutput"><span class="identifier">bimap</span></code>
              remains unchanged if some exception (originated by the system or the
              user's data types) is thrown.<br> &#35813;&#25805;&#20316;&#26159;&#24378;&#24322;&#24120;&#23433;&#20840;&#30340;&#65292;&#21363;&#22914;&#26524;&#26377;&#24322;&#24120;&#25243;&#20986;(&#30001;&#31995;&#32479;&#25110;&#29992;&#25143;&#25968;&#25454;&#31867;&#22411;&#20135;&#29983;)&#65292;&#21017;
              <code class="computeroutput"><span class="identifier">bimap</span></code> &#20445;&#25345;&#19981;&#21464;&#12290;
            </li>
</ul></div>
<p>
          <code class="computeroutput"><span class="identifier">replace</span></code> functions are powerful
          operations not provided by standard STL containers, and one that is specially
          handy when strong exception-safety is required.<br> <code class="computeroutput"><span class="identifier">replace</span></code>
          &#20989;&#25968;&#26159;&#26631;&#20934;STL&#23481;&#22120;&#27809;&#26377;&#25552;&#20379;&#30340;&#24378;&#22823;&#25805;&#20316;&#65292;&#24403;&#38656;&#35201;&#24378;&#24322;&#24120;&#23433;&#20840;&#26102;&#65292;&#23427;&#23588;&#20854;&#26041;&#20415;&#12290;
        </p>
<p>
          The observant reader might have noticed that the convenience of replace
          comes at a cost: namely the whole element has to be copied <span class="emphasis"><em>twice</em></span>
          to do the updating (when retrieving it and inside <code class="computeroutput"><span class="identifier">replace</span></code>).
          If elements are expensive to copy, this may be quite a computational cost
          for the modification of just a tiny part of the object. To cope with this
          situation, Boost.Bimap provides an alternative updating mechanism: <code class="computeroutput"><span class="identifier">modify</span></code> functions.<br> &#32454;&#24515;&#30340;&#35835;&#32773;&#21487;&#33021;&#24050;&#32463;&#27880;&#24847;&#21040;&#65292;&#26367;&#25442;&#25805;&#20316;&#30340;&#26041;&#20415;&#24615;&#26159;&#26377;&#20195;&#20215;&#30340;&#65306;&#21363;&#22312;&#36827;&#34892;&#26356;&#26032;&#26102;&#65292;&#25972;&#20010;&#20803;&#32032;&#24517;&#39035;&#34987;&#22797;&#21046;<span class="emphasis"><em>&#20004;&#27425;</em></span>
          (&#19968;&#27425;&#21462;&#20986;&#65292;&#19968;&#27425;&#20869;&#37096; <code class="computeroutput"><span class="identifier">replace</span></code>)&#12290;&#22914;&#26524;&#20803;&#32032;&#30340;&#22797;&#21046;&#24456;&#26114;&#36149;&#65292;&#37027;&#20040;&#21363;&#20351;&#26159;&#23545;&#23545;&#35937;&#30340;&#19968;&#23567;&#37096;&#20998;&#36827;&#34892;&#20462;&#25913;&#20063;&#38656;&#35201;&#36739;&#22823;&#30340;&#20195;&#20215;&#12290;
          &#20026;&#20102;&#24212;&#20184;&#36825;&#19968;&#24773;&#20917;&#65292;Boost.Bimap &#25552;&#20379;&#20102;&#21478;&#19968;&#20010;&#26356;&#26032;&#26426;&#21046;&#65306;<code class="computeroutput"><span class="identifier">modify</span></code> &#20989;&#25968;&#12290;
        </p>
<p>
          <code class="computeroutput"><span class="identifier">modify</span></code> functions accepts
          a functor (or pointer to function) taking a reference to the data to be
          changed, thus eliminating the need for spurious copies. Like <code class="computeroutput"><span class="identifier">replace</span></code> functions, <code class="computeroutput"><span class="identifier">modify</span></code>
          functions does preserve the internal orderings of all the indices of the
          <code class="computeroutput"><span class="identifier">bimap</span></code>. However, the semantics
          of modify functions are not entirely equivalent to replace functions. Consider
          what happens if a collision occurs as a result of modifying the element,
          i.e. the modified element clashes with another with respect to some unique
          view. In the case of <code class="computeroutput"><span class="identifier">replace</span></code>
          functions, the original value is kept and the method returns without altering
          the container, but <code class="computeroutput"><span class="identifier">modify</span></code>
          functions cannot afford such an approach, since the modifying functor leaves
          no trace of the previous value of the element. Integrity constraints thus
          lead to the following policy: when a collision happens in the process of
          calling a modify functions, the element is erased and the method returns
          false. This difference in behavior between <code class="computeroutput"><span class="identifier">replace</span></code>
          and <code class="computeroutput"><span class="identifier">modify</span></code> functions has
          to be considered by the programmer on a case-by-case basis.<br> <code class="computeroutput"><span class="identifier">modify</span></code> &#20989;&#25968;&#25509;&#21463;&#19968;&#20010;&#20989;&#25968;&#23545;&#35937;(&#25110;&#20989;&#25968;&#25351;&#38024;)&#21644;&#19968;&#20010;&#34987;&#20462;&#25913;&#25968;&#25454;&#30340;&#24341;&#29992;&#65292;&#20174;&#32780;&#28040;&#38500;&#22810;&#20313;&#30340;&#22797;&#21046;&#12290;
          &#35937; <code class="computeroutput"><span class="identifier">replace</span></code> &#20989;&#25968;&#19968;&#26679;&#65292;<code class="computeroutput"><span class="identifier">modify</span></code> &#20989;&#25968;&#20445;&#25345; <code class="computeroutput"><span class="identifier">bimap</span></code>
          &#30340;&#25152;&#26377;&#32034;&#24341;&#30340;&#20869;&#37096;&#26377;&#24207;&#24615;&#12290;&#20294;&#26159;&#65292; &#20462;&#25913;&#20989;&#25968;&#30340;&#35821;&#20041;&#24182;&#19981;&#23436;&#20840;&#31561;&#21516;&#20110;&#26367;&#25442;&#20989;&#25968;&#12290;&#32771;&#34385;&#19968;&#19979;&#22914;&#26524;&#20462;&#25913;&#26576;&#20010;&#20803;&#32032;&#20250;&#21457;&#29983;&#20914;&#31361;&#65292;
          &#21363;&#20462;&#25913;&#21518;&#30340;&#20803;&#32032;&#19982;&#26576;&#20010;&#21807;&#19968;&#35270;&#22270;&#30340;&#21478;&#19968;&#20010;&#20803;&#32032;&#20914;&#31361;&#65292;&#37027;&#20040;&#20250;&#21457;&#29983;&#20160;&#20040;&#65311;&#22312;
          <code class="computeroutput"><span class="identifier">replace</span></code> &#20989;&#25968;&#20013;&#65292; &#21407;&#20540;&#23558;&#34987;&#20445;&#30041;&#65292;&#20989;&#25968;&#36820;&#22238;&#26102;&#27809;&#26377;&#23545;&#23481;&#22120;&#36827;&#34892;&#20462;&#25913;&#65292;&#32780;
          <code class="computeroutput"><span class="identifier">modify</span></code> &#20989;&#25968;&#21017;&#19981;&#25552;&#20379;&#36825;&#19968;&#26041;&#24335;&#65292;
          &#22240;&#20026;&#20462;&#25913;&#29992;&#30340;&#20989;&#25968;&#23545;&#35937;&#24182;&#27809;&#26377;&#20445;&#23384;&#20803;&#32032;&#30340;&#21407;&#26469;&#20540;&#12290;&#25152;&#20197;&#65292;&#23436;&#25972;&#24615;&#32422;&#26463;&#23558;&#23548;&#33268;&#20197;&#19979;&#31574;&#30053;&#65306;
          &#22312;&#35843;&#29992;&#20462;&#25913;&#20989;&#25968;&#30340;&#36807;&#31243;&#20013;&#22914;&#26524;&#21457;&#29983;&#20914;&#31361;&#65292;&#34987;&#20462;&#25913;&#20803;&#32032;&#23558;&#34987;&#21024;&#38500;&#32780;&#20989;&#25968;&#36820;&#22238;
          false&#12290; <code class="computeroutput"><span class="identifier">replace</span></code> &#21644; <code class="computeroutput"><span class="identifier">modify</span></code> &#20989;&#25968;&#38388;&#30340;&#34892;&#20026;&#24046;&#24322;&#24517;&#39035;&#30001;&#31243;&#24207;&#21592;&#26681;&#25454;&#23454;&#38469;&#24773;&#20917;&#26469;&#32771;&#34385;&#20351;&#29992;&#12290;
        </p>
<p>
          Boost.Bimap defines new placeholders named <code class="computeroutput"><span class="identifier">_key</span></code>
          and <code class="computeroutput"><span class="identifier">_data</span></code> to allow a sounder
          solution. You have to include <code class="computeroutput"><span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">bimap</span><span class="special">/</span><span class="identifier">support</span><span class="special">/</span><span class="identifier">lambda</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span></code>
          to use them.<br> Boost.Bimap &#23450;&#20041;&#20102;&#26032;&#30340;&#21344;&#20301;&#31526; <code class="computeroutput"><span class="identifier">_key</span></code>
          &#21644; <code class="computeroutput"><span class="identifier">_data</span></code>&#65292;&#20197;&#25552;&#20379;&#26356;&#28418;&#20142;&#30340;&#35299;&#20915;&#26041;&#26696;&#12290;
          &#35201;&#20351;&#29992;&#23427;&#20204;&#65292;&#20320;&#24517;&#39035;&#21253;&#21547; <code class="computeroutput"><span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">bimap</span><span class="special">/</span><span class="identifier">support</span><span class="special">/</span><span class="identifier">lambda</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span></code>.
        </p>
<p>
          <a href="../../../../example/tutorial_modify_and_replace.cpp" target="_top">Go to source
          code &#23519;&#30475;&#28304;&#20195;&#30721;</a>
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <span class="identifier">bimap</span><span class="special">&lt;</span> <span class="keyword">int</span><span class="special">,</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span> <span class="special">&gt;</span> <span class="identifier">bm_type</span><span class="special">;</span>
<span class="identifier">bm_type</span> <span class="identifier">bm</span><span class="special">;</span>
<span class="identifier">bm</span><span class="special">.</span><span class="identifier">insert</span><span class="special">(</span> <span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">value_type</span><span class="special">(</span><span class="number">1</span><span class="special">,</span><span class="string">"one"</span><span class="special">)</span> <span class="special">);</span>

<span class="comment">// Modify (1,"one") to (1,"1") using the right map view
</span><span class="special">{</span>
    <span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">right_iterator</span> <span class="identifier">it</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">right</span><span class="special">.</span><span class="identifier">find</span><span class="special">(</span><span class="string">"one"</span><span class="special">);</span>

    <span class="keyword">bool</span> <span class="identifier">successful_modify</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">right</span><span class="special">.</span><span class="identifier">modify_key</span><span class="special">(</span> <span class="identifier">it</span> <span class="special">,</span> <span class="identifier">_key</span> <span class="special">=</span> <span class="string">"1"</span> <span class="special">);</span>

    <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">successful_modify</span> <span class="special">);</span>
<span class="special">}</span>

<span class="identifier">bm</span><span class="special">.</span><span class="identifier">insert</span><span class="special">(</span> <span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">value_type</span><span class="special">(</span><span class="number">2</span><span class="special">,</span><span class="string">"two"</span><span class="special">)</span> <span class="special">);</span>

<span class="comment">// Fail to modify (1,"1") to (1,"two") using the left map view
</span><span class="special">{</span>
    <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">2</span> <span class="special">);</span>

    <span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">left_iterator</span> <span class="identifier">it</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">find</span><span class="special">(</span><span class="number">1</span><span class="special">);</span>

    <span class="keyword">bool</span> <span class="identifier">successful_modify</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">modify_data</span><span class="special">(</span> <span class="identifier">it</span><span class="special">,</span> <span class="identifier">_data</span> <span class="special">=</span> <span class="string">"two"</span> <span class="special">);</span>

    <a class="co" name="boost_bimap10co" href="useful_functions.html#boost_bimap10"><img src="../../../../../../doc/src/images/callouts/1.png" alt="1" border="0"></a><span class="identifier">assert</span><span class="special">(</span> <span class="special">!</span> <span class="identifier">successful_modify</span> <span class="special">);</span>
    <span class="identifier">assert</span><span class="special">(</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">size</span><span class="special">()</span> <span class="special">==</span> <span class="number">1</span> <span class="special">);</span>
<span class="special">}</span>
</pre>
<p>
        </p>
<p>
          </p>
<div class="calloutlist"><table border="0" summary="Callout list"><tr>
<td width="5%" valign="top" align="left"><p><a name="boost_bimap10"></a><a href="#boost_bimap10co"><img src="../../../../../../doc/src/images/callouts/1.png" alt="1" border="0"></a> </p></td>
<td valign="top" align="left"><p> <code class="computeroutput"><span class="identifier">it</span></code> is not longer valid
          and <code class="computeroutput"><span class="special">(</span><span class="number">1</span><span class="special">,</span><span class="string">"1"</span><span class="special">)</span></code> is removed from the bimap </p></td>
</tr></table></div>
<p>
        </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h4 class="title">
<a name="boost_bimap.the_tutorial.useful_functions.retrieval_of_ranges"></a><a class="link" href="useful_functions.html#boost_bimap.the_tutorial.useful_functions.retrieval_of_ranges" title="Retrieval of ranges &#21306;&#38388;&#30340;&#21462;&#22238;">
        Retrieval of ranges &#21306;&#38388;&#30340;&#21462;&#22238;</a>
</h4></div></div></div>
<p>
          Standard <code class="computeroutput"><span class="identifier">lower_bound</span></code> and
          <code class="computeroutput"><span class="identifier">upper_bound</span></code> functions can
          be used to lookup for all the elements in a given range.<br> &#26631;&#20934;&#30340;
          <code class="computeroutput"><span class="identifier">lower_bound</span></code> &#21644; <code class="computeroutput"><span class="identifier">upper_bound</span></code> &#20989;&#25968;&#21487;&#20197;&#29992;&#20110;&#32473;&#23450;&#33539;&#22260;&#30340;&#25152;&#26377;&#20803;&#32032;&#12290;
        </p>
<p>
          Suppose we want to retrieve the elements from a <code class="computeroutput"><span class="identifier">bimap</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">&gt;</span></code> where the left value is in the range
          <code class="computeroutput"><span class="special">[</span><span class="number">20</span><span class="special">,</span><span class="number">50</span><span class="special">]</span></code><br>
          &#20551;&#35774;&#25105;&#20204;&#24819;&#20174;&#19968;&#20010; <code class="computeroutput"><span class="identifier">bimap</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">&gt;</span></code> &#20013;&#21462;&#20986;&#33539;&#22260;&#20026; <code class="computeroutput"><span class="special">[</span><span class="number">20</span><span class="special">,</span><span class="number">50</span><span class="special">]</span></code> &#30340;&#24038;&#20540;
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <span class="identifier">bimap</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">&gt;</span> <span class="identifier">bm_type</span><span class="special">;</span>
<span class="identifier">bm_type</span> <span class="identifier">bm</span><span class="special">;</span>

<span class="comment">// ...
</span>
<span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">left_iterator</span> <span class="identifier">iter_first</span>  <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">lower_bound</span><span class="special">(</span><span class="number">20</span><span class="special">);</span>
<span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">left_iterator</span> <span class="identifier">iter_second</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">upper_bound</span><span class="special">(</span><span class="number">50</span><span class="special">);</span>

<span class="comment">// range [iter_first,iter_second) contains the elements in [20,50]
</span></pre>
<p>
        </p>
<p>
          Subtle changes to the code are required when strict inequalities are considered.
          To retrieve the elements greater than 20 and less than 50, the code has
          to be rewritten as<br> &#22914;&#26524;&#35201;&#27714;&#20005;&#26684;&#30340;&#19981;&#31561;&#24615;&#65292;&#21017;&#38656;&#35201;&#19968;&#20123;&#20462;&#25913;&#12290;&#27604;&#22914;&#65292;&#35201;&#21462;&#20986;&#22823;&#20110;20&#23567;&#20110;50&#30340;&#20803;&#32032;&#65292;&#20195;&#30721;&#35201;&#25913;&#20026;
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">left_iterator</span> <span class="identifier">iter_first</span>  <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">upper_bound</span><span class="special">(</span><span class="number">20</span><span class="special">);</span>
<span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">left_iterator</span> <span class="identifier">iter_second</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">lower_bound</span><span class="special">(</span><span class="number">50</span><span class="special">);</span>

<span class="comment">// range [iter_first,iter_second) contains the elements in (20,50)
</span></pre>
<p>
        </p>
<p>
          To add to this complexity, the careful programmer has to take into account
          that the lower and upper bounds of the interval searched be compatible:
          for instance, if the lower bound is 50 and the upper bound is 20, the iterators
          <code class="computeroutput"><span class="identifier">iter_first</span></code> and <code class="computeroutput"><span class="identifier">iter_second</span></code> produced by the code above
          will be in reverse order, with possibly catastrophic results if a traversal
          from <code class="computeroutput"><span class="identifier">iter_first</span></code> to <code class="computeroutput"><span class="identifier">iter_second</span></code> is tried. All these details
          make range searching a tedious and error prone task.<br> &#30001;&#20110;&#22686;&#21152;&#20102;&#36825;&#19968;&#22797;&#26434;&#24615;&#65292;&#32454;&#24515;&#30340;&#31243;&#24207;&#21592;&#24517;&#39035;&#32771;&#34385;&#26597;&#25214;&#21306;&#38388;&#30340;&#19979;&#30028;&#21644;&#19978;&#30028;&#24517;&#39035;&#20860;&#23481;&#65306;&#20363;&#22914;&#65292;&#22914;&#26524;&#19979;&#30028;&#26159;50&#26159;&#19978;&#30028;&#26159;20&#65292;
          &#21017;&#20197;&#19978;&#20195;&#30721;&#20135;&#29983;&#30340;&#36845;&#20195;&#22120; <code class="computeroutput"><span class="identifier">iter_first</span></code>
          &#21644; <code class="computeroutput"><span class="identifier">iter_second</span></code> &#26159;&#21453;&#24207;&#30340;&#65292;&#22914;&#26524;&#23581;&#35797;&#20174;
          <code class="computeroutput"><span class="identifier">iter_first</span></code> &#21040; <code class="computeroutput"><span class="identifier">iter_second</span></code> &#36827;&#34892;&#36941;&#21382;&#65292; &#23601;&#21487;&#33021;&#20135;&#29983;&#31354;&#38590;&#24615;&#30340;&#21518;&#26524;&#12290;&#25152;&#26377;&#36825;&#20123;&#32454;&#33410;&#20351;&#24471;&#21306;&#38388;&#26597;&#25214;&#25104;&#20026;&#20102;&#19968;&#20214;&#20047;&#21619;&#32780;&#26131;&#38169;&#30340;&#24037;&#20316;&#12290;
        </p>
<p>
          The range member function, often in combination with lambda expressions,
          can greatly help alleviate this situation:<br> range &#25104;&#21592;&#20989;&#25968;&#65292;&#36890;&#24120;&#19982;
          lambda &#34920;&#36798;&#24335;&#19968;&#36215;&#20351;&#29992;&#65292;&#21487;&#20197;&#26497;&#22823;&#22320;&#36991;&#20813;&#36825;&#19968;&#24773;&#24418;&#65306;
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="keyword">typedef</span> <span class="identifier">bimap</span><span class="special">&lt;</span><span class="keyword">int</span><span class="special">,</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">&gt;</span> <span class="identifier">bm_type</span><span class="special">;</span>
<span class="identifier">bm_type</span> <span class="identifier">bm</span><span class="special">;</span>

<span class="comment">// ...
</span>
<a class="co" name="boost_bimap11co" href="useful_functions.html#boost_bimap11"><img src="../../../../../../doc/src/images/callouts/1.png" alt="1" border="0"></a><span class="identifier">bm_type</span><span class="special">::</span><span class="identifier">left_range_type</span> <span class="identifier">r</span><span class="special">;</span>

<a class="co" name="boost_bimap12co" href="useful_functions.html#boost_bimap12"><img src="../../../../../../doc/src/images/callouts/2.png" alt="2" border="0"></a><span class="identifier">r</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">range</span><span class="special">(</span> <span class="number">20</span> <span class="special">&lt;=</span> <span class="identifier">_key</span><span class="special">,</span> <span class="identifier">_key</span> <span class="special">&lt;=</span> <span class="number">50</span> <span class="special">);</span> <span class="comment">// [20,50]
</span>
<span class="identifier">r</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">range</span><span class="special">(</span> <span class="number">20</span> <span class="special">&lt;</span>  <span class="identifier">_key</span><span class="special">,</span> <span class="identifier">_key</span> <span class="special">&lt;</span>  <span class="number">50</span> <span class="special">);</span> <span class="comment">// (20,50)
</span>
<span class="identifier">r</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">range</span><span class="special">(</span> <span class="number">20</span> <span class="special">&lt;=</span> <span class="identifier">_key</span><span class="special">,</span> <span class="identifier">_key</span> <span class="special">&lt;</span>  <span class="number">50</span> <span class="special">);</span> <span class="comment">// [20,50)
</span></pre>
<p>
        </p>
<p>
          </p>
<div class="calloutlist"><table border="0" summary="Callout list">
<tr>
<td width="5%" valign="top" align="left"><p><a name="boost_bimap11"></a><a href="#boost_bimap11co"><img src="../../../../../../doc/src/images/callouts/1.png" alt="1" border="0"></a> </p></td>
<td valign="top" align="left"><p> <code class="computeroutput"><span class="identifier">range_type</span></code> is a handy typedef
          equal to <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">pair</span><span class="special">&lt;</span><span class="identifier">iterator</span><span class="special">,</span><span class="identifier">iterator</span><span class="special">&gt;</span></code>.
          <code class="computeroutput"><span class="identifier">const_range_type</span></code> is provided
          too, and it is equal to <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">pair</span><span class="special">&lt;</span><span class="identifier">const_iterator</span><span class="special">,</span><span class="identifier">const_iterator</span><span class="special">&gt;</span></code> </p></td>
</tr>
<tr>
<td width="5%" valign="top" align="left"><p><a name="boost_bimap12"></a><a href="#boost_bimap12co"><img src="../../../../../../doc/src/images/callouts/2.png" alt="2" border="0"></a> </p></td>
<td valign="top" align="left"><p> _key is a Boost.Lambda placeholder.
          To use it you have to include <code class="computeroutput"><span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">bimap</span><span class="special">/</span><span class="identifier">support</span><span class="special">/</span><span class="identifier">lambda</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span></code>
          </p></td>
</tr>
</table></div>
<p>
        </p>
<p>
          <code class="computeroutput"><span class="identifier">range</span></code> simply accepts predicates
          specifying the lower and upper bounds of the interval searched. Please
          consult the reference for a detailed explanation of the permissible predicates
          passed to range.<br> <code class="computeroutput"><span class="identifier">range</span></code>
          &#21482;&#25509;&#21463;&#29992;&#20110;&#25351;&#23450;&#34987;&#26597;&#25214;&#21306;&#38388;&#30340;&#19979;&#30028;&#21644;&#19978;&#30028;&#30340;&#35859;&#35789;&#12290;&#26377;&#20851;&#20256;&#36882;&#32473;
          range &#30340;&#21487;&#29992;&#35859;&#35789;&#30340;&#35814;&#32454;&#35299;&#37322;&#65292;&#35831;&#30475;&#30456;&#20851;&#21442;&#32771;&#12290;
        </p>
<p>
          One or both bounds can be omitted with the special unbounded marker:<br>
          &#21333;&#20010;&#25110;&#20004;&#20010;&#36793;&#30028;&#22343;&#21487;&#36890;&#36807;&#29305;&#23450;&#30340;&#26080;&#30028;&#26631;&#21495;&#26469;&#30465;&#30053;&#65306;
        </p>
<p>
          
</p>
<pre class="programlisting"><span class="identifier">r</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">range</span><span class="special">(</span> <span class="number">20</span> <span class="special">&lt;=</span> <span class="identifier">_key</span><span class="special">,</span> <span class="identifier">unbounded</span> <span class="special">);</span> <span class="comment">// [20,inf)
</span>
<span class="identifier">r</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">range</span><span class="special">(</span> <span class="identifier">unbounded</span> <span class="special">,</span> <span class="identifier">_key</span> <span class="special">&lt;</span> <span class="number">50</span> <span class="special">);</span> <span class="comment">// (-inf,50)
</span>
<a class="co" name="boost_bimap13co" href="useful_functions.html#boost_bimap13"><img src="../../../../../../doc/src/images/callouts/1.png" alt="1" border="0"></a><span class="identifier">r</span> <span class="special">=</span> <span class="identifier">bm</span><span class="special">.</span><span class="identifier">left</span><span class="special">.</span><span class="identifier">range</span><span class="special">(</span> <span class="identifier">unbounded</span> <span class="special">,</span> <span class="identifier">unbounded</span> <span class="special">);</span> <span class="comment">// (-inf,inf)
</span></pre>
<p>
        </p>
<p>
          </p>
<div class="calloutlist"><table border="0" summary="Callout list"><tr>
<td width="5%" valign="top" align="left"><p><a name="boost_bimap13"></a><a href="#boost_bimap13co"><img src="../../../../../../doc/src/images/callouts/1.png" alt="1" border="0"></a> </p></td>
<td valign="top" align="left"><p> This is equivalent to std::make_pair(s.begin(),s.end()) </p></td>
</tr></table></div>
<p>
        </p>
<p>
          <a href="../../../../example/tutorial_range.cpp" target="_top">Go to source code &#23519;&#30475;&#28304;&#20195;&#30721;</a>
        </p>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2006 -2007 Matias Capeletto<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="differences_with_standard_maps.html"><img src="../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../the_tutorial.html"><img src="../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../../index.html"><img src="../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="bimaps_with_user_defined_names.html"><img src="../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
</body>
</html>
