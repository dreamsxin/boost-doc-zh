<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Numeric Converter Policy Classes &#25968;&#23383;&#36716;&#25442;&#22120;&#31574;&#30053;&#31867;</title>
<link rel="stylesheet" href="../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.75.2">
<link rel="home" href="../index.html" title="Chapter&#160;1.&#160;Boost.NumericConversion">
<link rel="up" href="../index.html" title="Chapter&#160;1.&#160;Boost.NumericConversion">
<link rel="prev" href="conversion_traits___traits_class.html" title="conversion_traits&lt;&gt; traits class">
<link rel="next" href="improved_numeric_cast__.html" title="Improved numeric_cast&lt;&gt; &#25913;&#36827;&#30340;numeric_cast&lt;&gt;">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../../boost.png"></td>
<td align="center"><a href="../../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="conversion_traits___traits_class.html"><img src="../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="improved_numeric_cast__.html"><img src="../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="boost_numericconversion.numeric_converter_policy_classes"></a><a class="link" href="numeric_converter_policy_classes.html" title="Numeric Converter Policy Classes &#25968;&#23383;&#36716;&#25442;&#22120;&#31574;&#30053;&#31867;">
    Numeric Converter Policy Classes &#25968;&#23383;&#36716;&#25442;&#22120;&#31574;&#30053;&#31867;</a>
</h2></div></div></div>
<div class="toc"><dl>
<dt><span class="section"><a href="numeric_converter_policy_classes.html#boost_numericconversion.numeric_converter_policy_classes.enum_range_check_result">enum
      range_check_result</a></span></dt>
<dt><span class="section"><a href="numeric_converter_policy_classes.html#boost_numericconversion.numeric_converter_policy_classes.policy_overflowhandler">
      Policy OverflowHandler &#31574;&#30053;OverflowHandler</a></span></dt>
<dt><span class="section"><a href="numeric_converter_policy_classes.html#boost_numericconversion.numeric_converter_policy_classes.policy_float2introunder">
      Policy Float2IntRounder &#31574;&#30053;Float2IntRounder </a></span></dt>
<dt><span class="section"><a href="numeric_converter_policy_classes.html#boost_numericconversion.numeric_converter_policy_classes.policy_rawconverter">
      Policy RawConverter &#31574;&#30053;RawConverter</a></span></dt>
<dt><span class="section"><a href="numeric_converter_policy_classes.html#boost_numericconversion.numeric_converter_policy_classes.policy_userrangechecker">
      Policy UserRangeChecker &#31574;&#30053;UserRangeChecker </a></span></dt>
</dl></div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_numericconversion.numeric_converter_policy_classes.enum_range_check_result"></a><a class="link" href="numeric_converter_policy_classes.html#boost_numericconversion.numeric_converter_policy_classes.enum_range_check_result" title="enum range_check_result">enum
      range_check_result</a>
</h3></div></div></div>
<pre class="programlisting"><span class="keyword">namespace</span> <span class="identifier">boost</span> <span class="special">{</span> <span class="keyword">namespace</span> <span class="identifier">numeric</span> <span class="special">{</span>

    <span class="keyword">enum</span> <span class="identifier">range_check_result</span>
    <span class="special">{</span>
        <span class="identifier">cInRange</span>     <span class="special">,</span>
        <span class="identifier">cNegOverflow</span> <span class="special">,</span>
        <span class="identifier">cPosOverflow</span>
    <span class="special">}</span> <span class="special">;</span>

<span class="special">}</span> <span class="special">}</span>
</pre>
<p>
        Defines the values returned by <code class="computeroutput"><span class="identifier">boost</span><span class="special">::</span><span class="identifier">numeric</span><span class="special">::</span><span class="identifier">converter</span><span class="special">&lt;&gt;::</span><span class="identifier">out_of_range</span><span class="special">()</span></code><br> &#23450;&#20041;&#30001; <code class="computeroutput"><span class="identifier">boost</span><span class="special">::</span><span class="identifier">numeric</span><span class="special">::</span><span class="identifier">converter</span><span class="special">&lt;&gt;::</span><span class="identifier">out_of_range</span><span class="special">()</span></code> &#36820;&#22238;&#30340;&#20540;&#12290;
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_numericconversion.numeric_converter_policy_classes.policy_overflowhandler"></a><a class="link" href="numeric_converter_policy_classes.html#boost_numericconversion.numeric_converter_policy_classes.policy_overflowhandler" title="Policy OverflowHandler &#31574;&#30053;OverflowHandler">
      Policy OverflowHandler &#31574;&#30053;OverflowHandler</a>
</h3></div></div></div>
<p>
        This <span class="emphasis"><em>stateless</em></span> non-template policy class must be a
        <span class="emphasis"><em>function object</em></span> and is called to administrate the result
        of the range checking. It can throw an exception if overflow has been detected
        by the range checking as indicated by its argument. If it throws, is is recommended
        that it be <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">bad_cast</span></code> or derived.<br> &#36825;&#20010;<span class="emphasis"><em>&#26080;&#29366;&#24577;</em></span>&#38750;&#27169;&#26495;&#31574;&#30053;&#31867;&#24517;&#39035;&#26159;&#19968;&#20010;<span class="emphasis"><em>&#20989;&#25968;&#23545;&#35937;</em></span>&#65292;&#23427;&#34987;&#35843;&#29992;&#26469;&#23545;&#33539;&#22260;&#26816;&#26597;&#30340;&#32467;&#26524;&#36827;&#34892;&#22788;&#29702;&#12290;
        &#22914;&#26524;&#33539;&#22260;&#26816;&#26597;&#24050;&#26816;&#27979;&#20986;&#28322;&#20986;&#24182;&#36890;&#36807;&#35843;&#29992;&#23454;&#21442;&#26469;&#34920;&#31034;&#65292;&#21017;&#23427;&#21487;&#20197;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#12290;&#22914;&#26524;&#35201;&#25243;&#20986;&#24322;&#24120;&#65292;&#24314;&#35758;&#20351;&#29992;
        <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">bad_cast</span></code> &#25110;&#20854;&#27966;&#29983;&#31867;&#12290;
      </p>
<p>
        It must have the following interface (it does not has to be a template class):<br>
        &#23427;&#24517;&#39035;&#20855;&#26377;&#20197;&#19979;&#25509;&#21475;(&#19981;&#24517;&#26159;&#27169;&#26495;&#31867;)&#65306;
      </p>
<pre class="programlisting"><span class="keyword">struct</span> <span class="identifier">YourOverflowHandlerPolicy</span>
<span class="special">{</span>
    <span class="keyword">void</span> <span class="keyword">operator</span><span class="special">()</span> <span class="special">(</span> <span class="identifier">boost</span><span class="special">::</span><span class="identifier">range_check_result</span> <span class="special">)</span> <span class="special">;</span> <span class="comment">// throw bad_cast or derived
</span><span class="special">}</span> <span class="special">;</span>
</pre>
<p>
        It is called with the result of the converter's <code class="computeroutput"><span class="identifier">out_of_range</span><span class="special">()</span></code> inside <code class="computeroutput"><span class="identifier">validate_range</span><span class="special">()</span></code>.<br> &#35813;&#20989;&#25968;&#20989;&#25968;&#34987;&#20197; <code class="computeroutput"><span class="identifier">validate_range</span><span class="special">()</span></code>
        &#20869;&#30340;&#36716;&#25442;&#22120;&#30340; <code class="computeroutput"><span class="identifier">out_of_range</span><span class="special">()</span></code> &#20026;&#21442;&#25968;&#35843;&#29992;&#12290;
      </p>
<p>
        These are the two overflow handler classes provided by the library:<br>
        &#26412;&#24211;&#25552;&#20379;&#20102;&#20004;&#20010;&#37325;&#36733;&#30340;&#22788;&#29702;&#31867;&#65306;
      </p>
<pre class="programlisting"><span class="keyword">namespace</span> <span class="identifier">boost</span> <span class="special">{</span> <span class="keyword">namespace</span> <span class="identifier">numeric</span> <span class="special">{</span>

    <span class="keyword">struct</span> <span class="identifier">def_overflow_handler</span>
    <span class="special">{</span>
        <span class="keyword">void</span> <span class="keyword">operator</span><span class="special">()</span> <span class="special">(</span> <span class="identifier">range_check_result</span> <span class="identifier">r</span> <span class="special">)</span> <span class="comment">// throw bad_numeric_conversion derived
</span>                                                 <span class="comment">// &#25243;&#20986; bad_numeric_conversion &#30340;&#27966;&#29983;&#31867;
</span>        <span class="special">{</span>
            <span class="keyword">if</span> <span class="special">(</span> <span class="identifier">r</span> <span class="special">==</span> <span class="identifier">cNegOverflow</span> <span class="special">)</span>
                <span class="keyword">throw</span> <span class="identifier">negative_overflow</span><span class="special">()</span> <span class="special">;</span>
            <span class="keyword">else</span> <span class="keyword">if</span> <span class="special">(</span> <span class="identifier">r</span> <span class="special">==</span> <span class="identifier">cPosOverflow</span> <span class="special">)</span>
                <span class="keyword">throw</span> <span class="identifier">positive_overflow</span><span class="special">()</span> <span class="special">;</span>
        <span class="special">}</span>
    <span class="special">}</span> <span class="special">;</span>

    <span class="keyword">struct</span> <span class="identifier">silent_overflow_handler</span>
    <span class="special">{</span>
        <span class="keyword">void</span> <span class="keyword">operator</span><span class="special">()</span> <span class="special">(</span> <span class="identifier">range_check_result</span> <span class="special">)</span> <span class="comment">// no-throw &#26080;&#25243;&#20986;
</span>        <span class="special">{}</span>
    <span class="special">}</span> <span class="special">;</span>

<span class="special">}</span> <span class="special">}</span>
</pre>
<p>
        And these are the Exception Classes thrown by the default overflow handler
        <a class="link" href="numeric_converter_policy_classes.html#numeric_conversion_policy_overflow_handler_important_note">(see
        IMPORTANT note)</a><br> &#20197;&#19979;&#26159;&#34987;&#32570;&#30465;&#30340;&#28322;&#20986;&#22788;&#29702;&#22120;&#25152;&#25243;&#20986;&#30340;&#24322;&#24120;&#31867;<a class="link" href="numeric_converter_policy_classes.html#numeric_conversion_policy_overflow_handler_important_note">(&#35831;&#35265;&#37325;&#35201;&#35828;&#26126;)</a>
      </p>
<a name="numeric_conversion_bad_numeric_cast"></a><a name="numeric_conversion_negative_overflow"></a><a name="numeric_conversion_possitive_overflow"></a><pre class="programlisting"><span class="keyword">namespace</span> <span class="identifier">boost</span> <span class="special">{</span> <span class="keyword">namespace</span> <span class="identifier">numeric</span> <span class="special">{</span>

    
    <span class="keyword">class</span> <span class="identifier">bad_numeric_cast</span> <span class="special">:</span> <span class="keyword">public</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">bad_cast</span>
    <span class="special">{</span>
        <span class="keyword">public</span><span class="special">:</span>
        <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span> <span class="special">*</span><span class="identifier">what</span><span class="special">()</span> <span class="keyword">const</span> <span class="comment">// throw()
</span>        <span class="special">{</span>
            <span class="keyword">return</span> <span class="string">"bad numeric conversion: overflow"</span><span class="special">;</span>
        <span class="special">}</span>

    <span class="special">};</span>

    
    <span class="keyword">class</span> <span class="identifier">negative_overflow</span> <span class="special">:</span> <span class="keyword">public</span> <span class="identifier">bad_numeric_cast</span>
    <span class="special">{</span>
        <span class="keyword">public</span><span class="special">:</span>
        <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span> <span class="special">*</span><span class="identifier">what</span><span class="special">()</span> <span class="keyword">const</span> <span class="comment">// throw()
</span>        <span class="special">{</span>
            <span class="keyword">return</span> <span class="string">"bad numeric conversion: negative overflow"</span><span class="special">;</span>
        <span class="special">}</span>
    <span class="special">};</span>

    
    <span class="keyword">class</span> <span class="identifier">positive_overflow</span> <span class="special">:</span> <span class="keyword">public</span> <span class="identifier">bad_numeric_cast</span>
    <span class="special">{</span>
        <span class="keyword">public</span><span class="special">:</span>
        <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keyword">char</span> <span class="special">*</span><span class="identifier">what</span><span class="special">()</span> <span class="keyword">const</span> <span class="comment">// throw()
</span>        <span class="special">{</span>
            <span class="keyword">return</span> <span class="string">"bad numeric conversion: positive overflow"</span><span class="special">;</span>
        <span class="special">}</span>
    <span class="special">};</span>


<span class="special">}</span> <span class="special">}</span>
</pre>
<a name="numeric_conversion_policy_overflow_handler_important_note"></a><div class="important"><table border="0" summary="Important">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Important]" src="../../../../../../doc/src/images/important.png"></td>
<th align="left">Important</th>
</tr>
<tr><td align="left" valign="top"><p>
          <span class="bold"><strong>RELEASE NOTE for 1.33</strong></span> Previous to boost
          version 1.33, the exception class <code class="computeroutput"><span class="identifier">bad_numeric_cast</span></code>
          was named <code class="computeroutput"><span class="identifier">bad_numeric_conversion</span></code>.
          However, in 1.33, the old function <code class="computeroutput"><span class="identifier">numeric_cast</span><span class="special">&lt;&gt;</span></code> from <code class="computeroutput"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">cast</span><span class="special">.</span><span class="identifier">hpp</span></code>
          was completly replaced by the new <code class="computeroutput"><span class="identifier">numeric_cast</span><span class="special">&lt;&gt;</span></code> in <code class="computeroutput"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">numeric</span><span class="special">/</span><span class="identifier">conversion</span><span class="special">/</span><span class="identifier">cast</span><span class="special">.</span><span class="identifier">hpp</span></code>
          (and <code class="computeroutput"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">cast</span><span class="special">.</span><span class="identifier">hpp</span></code> is including <code class="computeroutput"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">numeric</span><span class="special">/</span><span class="identifier">conversion</span><span class="special">/</span><span class="identifier">cast</span><span class="special">.</span><span class="identifier">hpp</span></code>
          now). That old function which existed in boost for quite some time used
          the <code class="computeroutput"><span class="identifier">bad_numeric_cast</span></code> as
          its exception type so I decided to avoid backward compatibility problems
          by adopting it (guessing that the user base for the old code is wider than
          for the new code).<br> <span class="bold"><strong>&#23545;1.33&#29256;&#26412;&#30340;&#35828;&#26126;</strong></span>
          &#22312; boost &#29256;&#26412; 1.33 &#20043;&#21069;&#65292;&#24322;&#24120;&#31867; <code class="computeroutput"><span class="identifier">bad_numeric_cast</span></code>
          &#21629;&#21517;&#20026; <code class="computeroutput"><span class="identifier">bad_numeric_conversion</span></code>&#12290;
          &#20294;&#26159;&#65292;&#22312; 1.33 &#20013;&#65292;&#26469;&#33258; <code class="computeroutput"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">cast</span><span class="special">.</span><span class="identifier">hpp</span></code>
          &#30340;&#26087;&#20989;&#25968; <code class="computeroutput"><span class="identifier">numeric_cast</span><span class="special">&lt;&gt;</span></code> &#24050;&#23436;&#20840;&#34987; <code class="computeroutput"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">numeric</span><span class="special">/</span><span class="identifier">conversion</span><span class="special">/</span><span class="identifier">cast</span><span class="special">.</span><span class="identifier">hpp</span></code>
          &#20013;&#30340;&#26032; <code class="computeroutput"><span class="identifier">numeric_cast</span><span class="special">&lt;&gt;</span></code> &#25152;&#26367;&#20195;(&#32780;&#19988;&#29616;&#22312; <code class="computeroutput"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">cast</span><span class="special">.</span><span class="identifier">hpp</span></code> &#34987;&#21253;&#21547;&#22312; <code class="computeroutput"><span class="identifier">boost</span><span class="special">/</span><span class="identifier">numeric</span><span class="special">/</span><span class="identifier">conversion</span><span class="special">/</span><span class="identifier">cast</span><span class="special">.</span><span class="identifier">hpp</span></code>
          &#20013;)&#12290; &#37027;&#20123;&#22312; boost &#20013;&#24050;&#32463;&#23384;&#22312;&#20102;&#19968;&#27573;&#26102;&#38388;&#30340;&#26087;&#20989;&#25968;&#26159;&#25226;
          <code class="computeroutput"><span class="identifier">bad_numeric_cast</span></code> &#29992;&#20316;&#20854;&#24322;&#24120;&#31867;&#22411;&#30340;&#65292;
          &#25152;&#20197;&#25105;&#20915;&#23450;&#36890;&#36807;&#37319;&#29992;&#36825;&#20010;&#24322;&#24120;&#31867;&#20197;&#36991;&#20813;&#21518;&#21521;&#20860;&#23481;&#24615;&#30340;&#38382;&#39064;(&#25105;&#29468;&#27979;&#22522;&#20110;&#26087;&#20195;&#30721;&#30340;&#29992;&#25143;&#32463;&#22810;&#20110;&#22522;&#20110;&#26032;&#20195;&#30721;&#30340;)&#12290;
        </p></td></tr>
</table></div>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_numericconversion.numeric_converter_policy_classes.policy_float2introunder"></a><a class="link" href="numeric_converter_policy_classes.html#boost_numericconversion.numeric_converter_policy_classes.policy_float2introunder" title="Policy Float2IntRounder &#31574;&#30053;Float2IntRounder">
      Policy Float2IntRounder &#31574;&#30053;Float2IntRounder </a>
</h3></div></div></div>
<p>
        This <span class="emphasis"><em>stateless</em></span> template policy class specifies the rounding
        mode used for <span class="underline">float to integral</span> conversions.
        It supplies the <code class="computeroutput"><span class="identifier">nearbyint</span><span class="special">()</span></code> static member function exposed by the converter,
        which means that it <span class="underline">publicly inherits from this
        policy</span>.<br> &#36825;&#20010;<span class="emphasis"><em>&#26080;&#29366;&#24577;</em></span>&#27169;&#26495;&#31574;&#30053;&#31867;&#25351;&#23450;&#29992;&#20110;
        <span class="underline">&#28014;&#28857;&#33267;&#25972;&#22411;</span> &#36716;&#25442;&#30340;&#33293;&#20837;&#26041;&#24335;&#12290;&#23427;&#25552;&#20379;&#20102;&#30001;&#36716;&#25442;&#22120;&#26292;&#38706;&#20986;&#26469;&#30340;
        <code class="computeroutput"><span class="identifier">nearbyint</span><span class="special">()</span></code>
        &#38745;&#24577;&#25104;&#21592;&#20989;&#25968;&#65292; &#21363;&#36716;&#25442;&#22120;&#35201; <span class="underline">&#20844;&#26377;&#22320;&#32487;&#25215;&#33258;&#36825;&#20010;&#31574;&#30053;</span>&#12290;
      </p>
<p>
        The policy must have the following interface:<br> &#35813;&#31574;&#30053;&#24517;&#39035;&#20855;&#26377;&#20197;&#19979;&#25509;&#21475;&#65306;
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">S</span><span class="special">&gt;</span>
<span class="keyword">struct</span> <span class="identifier">YourFloat2IntRounderPolicy</span>
<span class="special">{</span>
    <span class="keyword">typedef</span> <span class="identifier">S</span>               <span class="identifier">source_type</span> <span class="special">;</span>
    <span class="keyword">typedef</span> <span class="special">{</span><span class="identifier">S</span> <span class="keyword">or</span> <span class="identifier">S</span> <span class="keyword">const</span><span class="special">&amp;}</span> <span class="identifier">argument_type</span> <span class="special">;</span>

    <span class="keyword">static</span> <span class="identifier">source_type</span> <span class="identifier">nearbyint</span> <span class="special">(</span> <span class="identifier">argument_type</span> <span class="identifier">s</span> <span class="special">)</span> <span class="special">{</span> <span class="special">...</span> <span class="special">}</span>

    <span class="keyword">typedef</span> <span class="identifier">mpl</span><span class="special">::</span><span class="identifier">integral_c</span><span class="special">&lt;</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">float_round_style</span><span class="special">,</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">round_</span><span class="special">...&gt;</span> <span class="identifier">round_style</span> <span class="special">;</span>

<span class="special">}</span> <span class="special">;</span>
</pre>
<p>
        These are the rounder classes provided by the library (only the specific
        parts are shown, see the general policy form above)<br> &#26412;&#24211;&#25552;&#20379;&#20102;&#20960;&#20010;&#33293;&#20837;&#22120;&#31867;(&#20197;&#19979;&#20165;&#23637;&#31034;&#35268;&#26684;&#37096;&#20998;&#65292;&#21442;&#35265;&#19978;&#38754;&#30340;&#36890;&#29992;&#31574;&#30053;&#24418;&#24335;)
      </p>
<div class="note"><table border="0" summary="Note">
<tr>
<td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../../../../../../doc/src/images/note.png"></td>
<th align="left">Note</th>
</tr>
<tr><td align="left" valign="top"><p>
          These classes are not intended to be general purpose rounding functions
          but specific policies for <code class="computeroutput"><span class="identifier">converter</span><span class="special">&lt;&gt;</span></code>. This is why they are not function
          objects.<br> &#36825;&#20123;&#31867;&#24182;&#19981;&#26159;&#36890;&#29992;&#30340;&#33293;&#20837;&#20989;&#25968;&#65292;&#32780;&#26159;&#19987;&#38376;&#29992;&#20110;
          <code class="computeroutput"><span class="identifier">converter</span><span class="special">&lt;&gt;</span></code>
          &#30340;&#31574;&#30053;&#12290;&#36825;&#27491;&#26159;&#20026;&#20160;&#20040;&#23427;&#20204;&#19981;&#26159;&#20989;&#25968;&#23545;&#35937;&#30340;&#21407;&#22240;&#12290;
        </p></td></tr>
</table></div>
<pre class="programlisting"><span class="keyword">namespace</span> <span class="identifier">boost</span> <span class="special">{</span> <span class="keyword">namespace</span> <span class="identifier">numeric</span> <span class="special">{</span>


    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">S</span><span class="special">&gt;</span>
    <span class="keyword">struct</span> <span class="identifier">Trunc</span>
    <span class="special">{</span>
        <span class="keyword">static</span> <span class="identifier">source_type</span> <span class="identifier">nearbyint</span> <span class="special">(</span> <span class="identifier">argument_type</span> <span class="identifier">s</span> <span class="special">)</span>
        <span class="special">{</span>
            <span class="keyword">using</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">floor</span> <span class="special">;</span>
            <span class="keyword">using</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">ceil</span>  <span class="special">;</span>

            <span class="keyword">return</span> <span class="identifier">s</span> <span class="special">&gt;=</span> <span class="keyword">static_cast</span><span class="special">&lt;</span><span class="identifier">S</span><span class="special">&gt;(</span><span class="number">0</span><span class="special">)</span> <span class="special">?</span> <span class="identifier">floor</span><span class="special">(</span><span class="identifier">s</span><span class="special">)</span> <span class="special">:</span> <span class="identifier">ceil</span><span class="special">(</span><span class="identifier">s</span><span class="special">)</span> <span class="special">;</span>
        <span class="special">}</span>

        <span class="keyword">typedef</span> <span class="identifier">mpl</span><span class="special">::</span><span class="identifier">integral_c</span><span class="special">&lt;</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">float_round_style</span><span class="special">,</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">round_toward_zero</span><span class="special">&gt;</span> <span class="identifier">round_style</span> <span class="special">;</span>
    <span class="special">}</span> <span class="special">;</span>


    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">S</span><span class="special">&gt;</span>
    <span class="keyword">struct</span> <span class="identifier">RoundEven</span>
    <span class="special">{</span>
        <span class="keyword">static</span> <span class="identifier">source_type</span> <span class="identifier">nearbyint</span> <span class="special">(</span> <span class="identifier">argument_type</span> <span class="identifier">s</span> <span class="special">)</span>
        <span class="special">{</span>
            <span class="keyword">return</span> <span class="identifier">impl</span><span class="special">-</span><span class="identifier">defined</span><span class="special">-</span><span class="identifier">value</span> <span class="special">;</span>
        <span class="special">}</span>

        <span class="keyword">typedef</span> <span class="identifier">mpl</span><span class="special">::</span><span class="identifier">integral_c</span><span class="special">&lt;</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">float_round_style</span><span class="special">,</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">round_to_nearest</span><span class="special">&gt;</span> <span class="identifier">round_style</span> <span class="special">;</span>
    <span class="special">}</span> <span class="special">;</span>


    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">S</span><span class="special">&gt;</span>
    <span class="keyword">struct</span> <span class="identifier">Ceil</span>
    <span class="special">{</span>
        <span class="keyword">static</span> <span class="identifier">source_type</span> <span class="identifier">nearbyint</span> <span class="special">(</span> <span class="identifier">argument_type</span> <span class="identifier">s</span> <span class="special">)</span>
        <span class="special">{</span>
            <span class="keyword">using</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">ceil</span> <span class="special">;</span>
            <span class="keyword">return</span> <span class="identifier">ceil</span><span class="special">(</span><span class="identifier">s</span><span class="special">)</span> <span class="special">;</span>
        <span class="special">}</span>

        <span class="keyword">typedef</span> <span class="identifier">mpl</span><span class="special">::</span><span class="identifier">integral_c</span><span class="special">&lt;</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">float_round_style</span><span class="special">,</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">round_toward_infinity</span><span class="special">&gt;</span> <span class="identifier">round_style</span> <span class="special">;</span>
    <span class="special">}</span> <span class="special">;</span>


    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">S</span><span class="special">&gt;</span>
    <span class="keyword">struct</span> <span class="identifier">Floor</span>
    <span class="special">{</span>
        <span class="keyword">static</span> <span class="identifier">source_type</span> <span class="identifier">nearbyint</span> <span class="special">(</span> <span class="identifier">argument_type</span> <span class="identifier">s</span> <span class="special">)</span>
        <span class="special">{</span>
            <span class="keyword">using</span> <span class="identifier">std</span><span class="special">::</span><span class="identifier">floor</span> <span class="special">;</span>
            <span class="keyword">return</span> <span class="identifier">floor</span><span class="special">(</span><span class="identifier">s</span><span class="special">)</span> <span class="special">;</span>
        <span class="special">}</span>
        <span class="keyword">typedef</span> <span class="identifier">mpl</span><span class="special">::</span><span class="identifier">integral_c</span><span class="special">&lt;</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">float_round_style</span><span class="special">,</span><span class="identifier">std</span><span class="special">::</span><span class="identifier">round_toward_neg_infinity</span><span class="special">&gt;</span> <span class="identifier">round_style</span> <span class="special">;</span>
    <span class="special">}</span> <span class="special">;</span>

<span class="special">}</span> <span class="special">}</span> <span class="comment">// namespace numeric, namespace boost
</span></pre>
<a name="boost_numericconversion.numeric_converter_policy_classes.policy_float2introunder.math_functions_used_by_the_rounder_policies________________________________________"></a><h5>
<a name="id5122243"></a>
        <a class="link" href="numeric_converter_policy_classes.html#boost_numericconversion.numeric_converter_policy_classes.policy_float2introunder.math_functions_used_by_the_rounder_policies________________________________________">Math
        Functions used by the rounder policies &#33293;&#20837;&#22120;&#31574;&#30053;&#25152;&#20351;&#29992;&#30340;&#25968;&#23398;&#20989;&#25968;</a>
      </h5>
<p>
        The rounder policies supplied by this header use math functions <code class="computeroutput"><span class="identifier">floor</span><span class="special">()</span></code>
        and <code class="computeroutput"><span class="identifier">ceil</span><span class="special">()</span></code>.
        The standard versions of these functions are introduced in context by a using
        directive, so in normal conditions, the standard functions will be used.<br>
        &#36825;&#20010;&#22836;&#25991;&#20214;&#25152;&#25552;&#20379;&#30340;&#33293;&#20837;&#22120;&#31574;&#30053;&#20351;&#29992;&#20102;&#25968;&#23398;&#20989;&#25968; <code class="computeroutput"><span class="identifier">floor</span><span class="special">()</span></code>
        &#21644; <code class="computeroutput"><span class="identifier">ceil</span><span class="special">()</span></code>&#12290;
        &#36825;&#20123;&#20989;&#25968;&#30340;&#26631;&#20934;&#29256;&#26412;&#26159;&#36890;&#36807;&#19968;&#20010; using &#25351;&#20196;&#24341;&#20837;&#21040;&#19978;&#19979;&#25991;&#20013;&#30340;&#65292;&#25152;&#20197;&#22312;&#27491;&#24120;&#24773;&#20917;&#19979;&#65292;&#23558;&#20351;&#29992;&#26631;&#20934;&#20989;&#25968;&#12290;
      </p>
<p>
        However, if there are other visible corresponding overloads an ambiguity
        could arise. In this case, the user can supply her own rounder policy which
        could, for instance, use a fully qualified call.<br> &#20294;&#26159;&#65292;&#22914;&#26524;&#23384;&#22312;&#20854;&#23427;&#21487;&#35265;&#30340;&#37325;&#36733;&#20989;&#25968;&#65292;&#23558;&#21457;&#29983;&#27495;&#20041;&#12290;&#36825;&#31181;&#24773;&#20917;&#19979;&#65292;&#29992;&#25143;&#21487;&#20197;&#25552;&#20379;&#33258;&#24049;&#30340;&#33293;&#20837;&#22120;&#31574;&#30053;&#65292;&#20363;&#22914;&#20351;&#29992;&#19968;&#20010;&#20840;&#38480;&#23450;&#35843;&#29992;&#12290;
      </p>
<p>
        This technique allows the default rounder policies to be used directly with
        user defined types. The user only requires that suitable overloads of <code class="computeroutput"><span class="identifier">floor</span><span class="special">()</span></code>
        and <code class="computeroutput"><span class="identifier">ceil</span><span class="special">()</span></code>
        be visible. See also <a class="link" href="type_requirements_and_user_defined_types_support.html" title="Type Requirements and User-defined-types support &#31867;&#22411;&#35201;&#27714;&#21644;&#29992;&#25143;&#33258;&#23450;&#20041;&#31867;&#22411;&#25903;&#25345;">User
        Defined Numeric Types</a> support.<br> &#36825;&#19968;&#25216;&#26415;&#20801;&#35768;&#32570;&#30465;&#30340;&#33293;&#20837;&#22120;&#31574;&#30053;&#30452;&#25509;&#29992;&#20110;&#29992;&#25143;&#33258;&#23450;&#20041;&#31867;&#22411;&#12290;&#29992;&#25143;&#21482;&#35201;&#27714;&#36866;&#24403;&#30340;
        <code class="computeroutput"><span class="identifier">floor</span><span class="special">()</span></code>
        &#21644; <code class="computeroutput"><span class="identifier">ceil</span><span class="special">()</span></code>
        &#37325;&#36733;&#26159;&#21487;&#35265;&#30340;&#12290; &#35831;&#21442;&#35265; <a class="link" href="type_requirements_and_user_defined_types_support.html" title="Type Requirements and User-defined-types support &#31867;&#22411;&#35201;&#27714;&#21644;&#29992;&#25143;&#33258;&#23450;&#20041;&#31867;&#22411;&#25903;&#25345;">&#29992;&#25143;&#33258;&#23450;&#20041;&#25968;&#23383;&#31867;&#22411;&#30340;&#25903;&#25345;</a>&#12290;
      </p>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_numericconversion.numeric_converter_policy_classes.policy_rawconverter"></a><a class="link" href="numeric_converter_policy_classes.html#boost_numericconversion.numeric_converter_policy_classes.policy_rawconverter" title="Policy RawConverter &#31574;&#30053;RawConverter">
      Policy RawConverter &#31574;&#30053;RawConverter</a>
</h3></div></div></div>
<p>
        This <span class="emphasis"><em>stateless</em></span> template policy class is used to perform
        the actual conversion from Source to Target. It supplies the <code class="computeroutput"><span class="identifier">low_level_convert</span><span class="special">()</span></code>
        static member function exposed by the converter, which means that it publicly
        inherits from this policy.<br> &#36825;&#20010;<span class="emphasis"><em>&#26080;&#29366;&#24577;</em></span>&#27169;&#26495;&#31574;&#30053;&#31867;&#29992;&#20110;&#25191;&#34892;&#20174;&#28304;&#31867;&#22411;&#21040;&#30446;&#26631;&#31867;&#22411;&#30340;&#23454;&#38469;&#36716;&#25442;&#12290;&#23427;&#25552;&#20379;&#20102;&#30001;&#36716;&#25442;&#22120;&#25152;&#26292;&#38706;&#30340;
        <code class="computeroutput"><span class="identifier">low_level_convert</span><span class="special">()</span></code>
        &#38745;&#24577;&#25104;&#21592;&#20989;&#25968;&#65292; &#21363;&#36716;&#25442;&#22120;&#26159;&#20844;&#26377;&#22320;&#32487;&#25215;&#33258;&#35813;&#31574;&#30053;&#30340;&#12290;
      </p>
<p>
        The policy must have the following interface:<br> &#35813;&#31574;&#30053;&#24517;&#39035;&#20855;&#26377;&#20197;&#19979;&#25509;&#21475;&#65306;
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">Traits</span><span class="special">&gt;</span>
<span class="keyword">struct</span> <span class="identifier">YourRawConverterPolicy</span>
<span class="special">{</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">Traits</span><span class="special">::</span><span class="identifier">result_type</span>   <span class="identifier">result_type</span>   <span class="special">;</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">Traits</span><span class="special">::</span><span class="identifier">argument_type</span> <span class="identifier">argument_type</span> <span class="special">;</span>

    <span class="keyword">static</span> <span class="identifier">result_type</span> <span class="identifier">low_level_convert</span> <span class="special">(</span> <span class="identifier">argument_type</span> <span class="identifier">s</span> <span class="special">)</span> <span class="special">{</span> <span class="keyword">return</span> <span class="special">&lt;</span><span class="identifier">impl</span> <span class="identifier">defined</span><span class="special">&gt;</span> <span class="special">;</span> <span class="special">}</span>
<span class="special">}</span> <span class="special">;</span>
</pre>
<p>
        This policy is mostly provided as a hook for user defined types which don't
        support <code class="computeroutput"><span class="keyword">static_cast</span><span class="special">&lt;&gt;</span></code>
        conversions to some types<br> &#23545;&#20110;&#19981;&#25903;&#25345; <code class="computeroutput"><span class="keyword">static_cast</span><span class="special">&lt;&gt;</span></code> &#36716;&#25442;&#20026;&#26576;&#20123;&#31867;&#22411;&#30340;&#29992;&#25143;&#33258;&#23450;&#20041;&#31867;&#22411;&#65292;&#36890;&#24120;&#23558;&#36825;&#19968;&#31574;&#30053;&#20316;&#20026;&#19968;&#20010;&#21514;&#38057;&#25552;&#20379;&#12290;
      </p>
<p>
        This is the only raw converter policy class provided by the library:<br>
        &#20197;&#19979;&#26159;&#26412;&#24211;&#25552;&#20379;&#30340;&#21807;&#19968;&#19968;&#20010;&#21407;&#22987;&#36716;&#25442;&#22120;&#31574;&#30053;&#31867;&#65306;
      </p>
<pre class="programlisting"><span class="keyword">namespace</span> <span class="identifier">boost</span> <span class="special">{</span> <span class="keyword">namespace</span> <span class="identifier">numeric</span> <span class="special">{</span>

    <span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">Traits</span><span class="special">&gt;</span>
    <span class="keyword">struct</span> <span class="identifier">raw_numeric_converter</span>
    <span class="special">{</span>
        <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">Traits</span><span class="special">::</span><span class="identifier">result_type</span>   <span class="identifier">result_type</span>   <span class="special">;</span>
        <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">Traits</span><span class="special">::</span><span class="identifier">argument_type</span> <span class="identifier">argument_type</span> <span class="special">;</span>

        <span class="keyword">static</span> <span class="identifier">result_type</span> <span class="identifier">low_level_convert</span> <span class="special">(</span> <span class="identifier">argument_type</span> <span class="identifier">s</span> <span class="special">)</span>
        <span class="special">{</span>
            <span class="keyword">return</span> <span class="keyword">static_cast</span><span class="special">&lt;</span><span class="identifier">result_type</span><span class="special">&gt;(</span><span class="identifier">s</span><span class="special">)</span> <span class="special">;</span> 
        <span class="special">}</span>
    <span class="special">}</span> <span class="special">;</span>

<span class="special">}</span> <span class="special">}</span>
</pre>
</div>
<div class="section">
<div class="titlepage"><div><div><h3 class="title">
<a name="boost_numericconversion.numeric_converter_policy_classes.policy_userrangechecker"></a><a class="link" href="numeric_converter_policy_classes.html#boost_numericconversion.numeric_converter_policy_classes.policy_userrangechecker" title="Policy UserRangeChecker &#31574;&#30053;UserRangeChecker">
      Policy UserRangeChecker &#31574;&#30053;UserRangeChecker </a>
</h3></div></div></div>
<p>
        This <span class="emphasis"><em>stateless</em></span> template policy class is used <span class="underline">only if supplied</span> to <span class="bold"><strong>override</strong></span>
        the internal range checking logic.<br> &#36825;&#20010;<span class="emphasis"><em>&#26080;&#29366;&#24577;</em></span>&#27169;&#26495;&#31574;&#30053;&#31867;<span class="underline">&#20165;&#24403;</span>&#35201;<span class="bold"><strong>&#37325;&#36733;</strong></span>&#20869;&#37096;&#30340;&#33539;&#22260;&#26816;&#26597;&#36923;&#36753;&#26102;&#20351;&#29992;&#12290;
      </p>
<p>
        It supplies the <code class="computeroutput"><span class="identifier">validate_range</span><span class="special">()</span></code> static member function exposed by the converter,
        which means that it publicly inherits from this policy.<br> &#23427;&#25552;&#20379;&#20102;&#30001;&#36716;&#25442;&#22120;&#25152;&#26292;&#38706;&#30340;
        <code class="computeroutput"><span class="identifier">validate_range</span><span class="special">()</span></code>
        &#38745;&#24577;&#25104;&#21592;&#20989;&#25968;&#65292;&#21363;&#36716;&#25442;&#22120;&#26159;&#20844;&#26377;&#22320;&#32487;&#25215;&#33258;&#35813;&#31574;&#30053;&#30340;&#12290;
      </p>
<p>
        The policy must have the following interface:<br> &#35813;&#31574;&#30053;&#24517;&#39035;&#20855;&#26377;&#20197;&#19979;&#25509;&#21475;&#65306;
      </p>
<pre class="programlisting"><span class="keyword">template</span><span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">Traits</span><span class="special">&gt;</span>
<span class="keyword">struct</span> <span class="identifier">YourRangeCheckerPolicy</span>
<span class="special">{</span>
    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="identifier">Traits</span><span class="special">::</span><span class="identifier">argument_type</span> <span class="identifier">argument_type</span> <span class="special">;</span>

    <span class="comment">// Determines if the value 's' fits in the range of the Target type.
</span>    <span class="comment">// &#21028;&#26029;&#20540; 's' &#26159;&#21542;&#36866;&#21512;&#30446;&#26631;&#31867;&#22411;&#30340;&#33539;&#22260;
</span>    <span class="keyword">static</span> <span class="identifier">range_check_result</span> <span class="identifier">out_of_range</span> <span class="special">(</span> <span class="identifier">argument_type</span> <span class="identifier">s</span> <span class="special">)</span> <span class="special">;</span>

    <span class="comment">// Checks whether the value 's' is out_of_range()
</span>    <span class="comment">// and passes the result of the check to the OverflowHandler policy.
</span>    <span class="comment">// &#26816;&#26597;&#20540; 's' &#26159;&#21542;&#20026; out_of_range()&#65292;&#24182;&#23558;&#26816;&#26597;&#32467;&#26524;&#20256;&#36882;&#32473; OverflowHandler &#31574;&#30053;&#12290;
</span>    <span class="keyword">static</span> <span class="keyword">void</span> <span class="identifier">validate_range</span> <span class="special">(</span> <span class="identifier">argument_type</span> <span class="identifier">s</span> <span class="special">)</span>
    <span class="special">{</span>
        <span class="identifier">OverflowHandler</span><span class="special">()(</span> <span class="identifier">out_of_range</span><span class="special">(</span><span class="identifier">s</span><span class="special">)</span> <span class="special">)</span> <span class="special">;</span>
    <span class="special">}</span>
<span class="special">}</span> <span class="special">;</span>
</pre>
<p>
        This policy is <span class="bold"><strong>only</strong></span> provided as a hook for
        user defined types which require range checking (which is disabled by default
        when a UDT is involved). The library provides a class: <code class="computeroutput"><span class="identifier">UseInternalRangeChecker</span><span class="special">{}</span></code>; which is a <span class="emphasis"><em>fake</em></span>
        <code class="computeroutput"><span class="identifier">RangeChecker</span></code> policy used
        to signal the converter to use its internal range checking implementation.<br>
        &#35813;&#31574;&#30053;<span class="bold"><strong>&#20165;</strong></span>&#23545;&#38656;&#35201;&#33539;&#22260;&#26816;&#26597;(&#24403;&#28041;&#21450;UDT&#26102;&#65292;&#32570;&#30465;&#26159;&#31105;&#29992;&#33539;&#22260;&#26816;&#26597;&#30340;)&#30340;&#29992;&#25143;&#33258;&#23450;&#20041;&#31867;&#22411;&#20316;&#20026;&#19968;&#20010;&#21514;&#38057;&#25552;&#20379;&#12290;
        &#26412;&#24211;&#25552;&#20379;&#20102;&#19968;&#20010;&#31867;&#65306;<code class="computeroutput"><span class="identifier">UseInternalRangeChecker</span><span class="special">{}</span></code>; &#23427;&#26159;&#19968;&#20010;<span class="emphasis"><em>&#20551;&#30340;</em></span>
        <code class="computeroutput"><span class="identifier">RangeChecker</span></code> &#31574;&#30053;&#65292;&#29992;&#20110;&#36890;&#30693;&#36716;&#25442;&#22120;&#20351;&#29992;&#20869;&#37096;&#30340;&#33539;&#22260;&#26816;&#26597;&#23454;&#29616;&#12290;
      </p>
</div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2004 -2007 Fernando Luis Cacciola Carballal<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="conversion_traits___traits_class.html"><img src="../../../../../../doc/src/images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../../../../../../doc/src/images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../../../../../../doc/src/images/home.png" alt="Home"></a><a accesskey="n" href="improved_numeric_cast__.html"><img src="../../../../../../doc/src/images/next.png" alt="Next"></a>
</div>
</body>
</html>
