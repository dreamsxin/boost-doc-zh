<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Noncentral Chi-Squared Distribution</title>
<link rel="stylesheet" href="../../../../../../../../../doc/html/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_2006-12-17_0120">
<link rel="start" href="../../../../index.html" title="Math Toolkit">
<link rel="up" href="../dists.html" title="Distributions">
<link rel="prev" href="nc_beta_dist.html" title="Noncentral Beta Distribution">
<link rel="next" href="nc_f_dist.html" title="Noncentral F Distribution">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../../../../../boost.png"></td>
<td align="center"><a href="../../../../../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="nc_beta_dist.html"><img src="../../../../../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../dists.html"><img src="../../../../../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../../../../index.html"><img src="../../../../../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="nc_f_dist.html"><img src="../../../../../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div>
  <h5 class="title">
<a name="math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist"></a><a href="nc_chi_squared_dist.html" title="Noncentral Chi-Squared Distribution">
          非中心χ方形分布(Noncentral Chi-Squared Distribution)</a>
</h5>
</div></div></div>
<p>
            
</p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">math</span><span class="special">/</span><span class="identifier">distributions</span><span class="special">/</span><span class="identifier">non_central_chi_squared</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span></pre>
<p>
  </p>
<pre class="programlisting"><span class="keyword">namespace</span> <span class="identifier">boost</span><span class="special">{</span> <span class="keyword">namespace</span> <span class="identifier">math</span><span class="special">{</span> 

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">RealType</span> <span class="special">=</span> <span class="keyword">double</span><span class="special">,</span> 
          <span class="keyword">class</span> <a href="../../../policy.html" title="Policies">Policy</a>   <span class="special">=</span> <a href="../../../policy/pol_ref/pol_ref_ref.html" title="Policy Class Reference">policies::policy&lt;&gt;</a> <span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">non_central_chi_squared_distribution</span><span class="special">;</span>

<span class="keyword">typedef</span> <span class="identifier">non_central_chi_squared_distribution</span><span class="special">&lt;&gt;</span> <span class="identifier">non_central_chi_squared</span><span class="special">;</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">RealType</span><span class="special">,</span> <span class="keyword">class</span> <a href="../../../policy.html" title="Policies">Policy</a><span class="special">&gt;</span>
<span class="keyword">class</span> <span class="identifier">non_central_chi_squared_distribution</span>
<span class="special">{</span>
<span class="keyword">public</span><span class="special">:</span>
   <span class="keyword">typedef</span> <span class="identifier">RealType</span>  <span class="identifier">value_type</span><span class="special">;</span>
   <span class="keyword">typedef</span> <span class="identifier">Policy</span>    <span class="identifier">policy_type</span><span class="special">;</span>

   <span class="comment">// 构造函数:
</span>   <span class="identifier">non_central_chi_squared_distribution</span><span class="special">(</span><span class="identifier">RealType</span> <span class="identifier">v</span><span class="special">,</span> <span class="identifier">RealType</span> <span class="identifier">lambda</span><span class="special">);</span>

   <span class="comment">// 自由度(degree of freedom)参数v访问函数(Accessor):
</span>   <span class="identifier">RealType</span> <span class="identifier">degrees_of_freedom</span><span class="special">()</span><span class="keyword">const</span><span class="special">;</span>

   <span class="comment">// 非中心(non centrality)参数lambda访问函数(Accessor):
</span>   <span class="identifier">RealType</span> <span class="identifier">non_centrality</span><span class="special">()</span><span class="keyword">const</span><span class="special">;</span>

   <span class="comment">// 参数查找:
</span>   <span class="keyword">static</span> <span class="identifier">RealType</span> <span class="identifier">find_degrees_of_freedom</span><span class="special">(</span><span class="identifier">RealType</span> <span class="identifier">lambda</span><span class="special">,</span> <span class="identifier">RealType</span> <span class="identifier">x</span><span class="special">,</span> <span class="identifier">RealType</span> <span class="identifier">p</span><span class="special">);</span>
   <span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">A</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">B</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">C</span><span class="special">&gt;</span>
   <span class="keyword">static</span> <span class="identifier">RealType</span> <span class="identifier">find_degrees_of_freedom</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">complemented3_type</span><span class="special">&lt;</span><span class="identifier">A</span><span class="special">,</span><span class="identifier">B</span><span class="special">,</span><span class="identifier">C</span><span class="special">&gt;&amp;</span> <span class="identifier">c</span><span class="special">);</span>
   
   <span class="keyword">static</span> <span class="identifier">RealType</span> <span class="identifier">find_non_centrality</span><span class="special">(</span><span class="identifier">RealType</span> <span class="identifier">v</span><span class="special">,</span> <span class="identifier">RealType</span> <span class="identifier">x</span><span class="special">,</span> <span class="identifier">RealType</span> <span class="identifier">p</span><span class="special">);</span>
   <span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">A</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">B</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">C</span><span class="special">&gt;</span>
   <span class="keyword">static</span> <span class="identifier">RealType</span> <span class="identifier">find_non_centrality</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">complemented3_type</span><span class="special">&lt;</span><span class="identifier">A</span><span class="special">,</span><span class="identifier">B</span><span class="special">,</span><span class="identifier">C</span><span class="special">&gt;&amp;</span> <span class="identifier">c</span><span class="special">);</span>
<span class="special">};</span>

<span class="special">}}</span> <span class="comment">// namespaces
</span></pre>
<p>
            非中心χ方形分布(noncentral chi-squared distribution) 是<a href="chi_squared_dist.html" title="Chi Squared Distribution">χ方形分布(Chi Squared
            Distribution)</a>的一般化。如果 X<sub>i</sub> 是 &#957; 相互独立的，均值(mean)为&#956;<sub>i</sub>，方差(variances)为 &#963;<sub>i</sub><sup>2</sup>的正规分布的随机变量，那么随机变量：</p>
<p>
            <span class="inlinemediaobject"><img src="../../../../../equations/nc_chi_squ_ref1.png"></span>
  </p>
<p>
  依照非中心χ方形分布( noncentral chi-squared distributio)进行分布。</p>
<p>
  非中心χ方形分布( noncentral chi-squared distributio)有两个参数：&#957; 指定自由度(degree of freedom)(也就是X<sub>i</sub>的个数)，&#955; 与随机变量 X<sub>i</sub> 的均值(mean)通过下面的等式联系起来：</p>
<p>
            <span class="inlinemediaobject"><img src="../../../../../equations/nc_chi_squ_ref2.png"></span>
  </p>
<p>
            (注意：一些资料中将&#955; 定义为上面和的一半)。</p>
<p>
            产生的PDF(概率分布函数)函数为：</p>
<p>
            <span class="inlinemediaobject"><img src="../../../../../equations/nc_chi_squ_ref3.png"></span>
  </p>
<p>
            其中<span class="emphasis"><em>f(x;k)</em></span> 是中心χ方形分布PDF函数(central chi-squared distribution
            PDF)，而<span class="emphasis"><em>I<sub>v</sub>(x)</em></span> 第一类修正贝赛尔函数( Bessel function)。</p>
<p>
  下面的图像显示了对于不同的&#955;值，分布是如何变化的：</p>
<p>
            <span class="inlinemediaobject"><img src="../../../../../graphs/nccs_pdf.png" align="middle"></span>
  </p>
<a name="math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.member_functions"></a>
<h5>
<a name="id630202"></a>
            <a href="nc_chi_squared_dist.html#math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.member_functions">成员函数</a>
  </h5>
<pre class="programlisting"><span class="identifier">non_central_chi_squared_distribution</span><span class="special">(</span><span class="identifier">RealType</span> <span class="identifier">v</span><span class="special">,</span> <span class="identifier">RealType</span> <span class="identifier">lambda</span><span class="special">);</span>
</pre>
<p>
            使用自由度(degree of freedom)<span class="emphasis"><em>v</em></span> 和非中心参数(non-centrality parameter)<span class="emphasis"><em>lambda</em></span>来构造一个非中心χ方形分布(Noncentral Chi-Squared Distribution)。</p>
<p>
            要求 v &gt; 0 且 lambda &gt;= 0，否则调用<a href="../../../main_overview/error_handling.html#domain_error">定义域错误</a>。</p>
<pre class="programlisting"><span class="identifier">RealType</span> <span class="identifier">degrees_of_freedom</span><span class="special">()</span><span class="keyword">const</span><span class="special">;</span>
</pre>
<p>
            返回构造分布的参数<span class="emphasis"><em>v</em></span>。</p>
<pre class="programlisting"><span class="identifier">RealType</span> <span class="identifier">non_centrality</span><span class="special">()</span><span class="keyword">const</span><span class="special">;</span>
</pre>
<p>
            返回构造分布的参数<span class="emphasis"><em>lambda</em></span> 。 </p>
<pre class="programlisting"><span class="keyword">static</span> <span class="identifier">RealType</span> <span class="identifier">find_degrees_of_freedom</span><span class="special">(</span><span class="identifier">RealType</span> <span class="identifier">lambda</span><span class="special">,</span> <span class="identifier">RealType</span> <span class="identifier">x</span><span class="special">,</span> <span class="identifier">RealType</span> <span class="identifier">p</span><span class="special">);</span>
</pre>
<p>
            这个函数返回自由度( degrees of freedom )<span class="emphasis"><em>v</em></span>满足：<code class="computeroutput"><span class="identifier">cdf</span><span class="special">(</span><span class="identifier">non_central_chi_squared</span><span class="special">&lt;</span><span class="identifier">RealType</span><span class="special">,</span>
            <span class="identifier">Policy</span><span class="special">&gt;(</span><span class="identifier">v</span><span class="special">,</span> <span class="identifier">lambda</span><span class="special">),</span>
            <span class="identifier">x</span><span class="special">)</span>
            <span class="special">==</span> <span class="identifier">p</span></code>
  </p>
<pre class="programlisting"><span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">A</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">B</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">C</span><span class="special">&gt;</span>
<span class="keyword">static</span> <span class="identifier">RealType</span> <span class="identifier">find_degrees_of_freedom</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">complemented3_type</span><span class="special">&lt;</span><span class="identifier">A</span><span class="special">,</span><span class="identifier">B</span><span class="special">,</span><span class="identifier">C</span><span class="special">&gt;&amp;</span> <span class="identifier">c</span><span class="special">);</span>
</pre>
<p>
  当使用<code class="computeroutput"><span class="identifier">boost</span><span class="special">::</span><span class="identifier">math</span><span class="special">::</span><span class="identifier">complement</span><span class="special">(</span><span class="identifier">lambda</span><span class="special">,</span> <span class="identifier">x</span><span class="special">,</span> <span class="identifier">q</span><span class="special">)</span></code> 参数来调用这个函数的时候，这个函数返回自由度(degree of freedom)<span class="emphasis"><em>v</em></span> 满足：</p>
<p>
            <code class="computeroutput"><span class="identifier">cdf</span><span class="special">(</span><span class="identifier">complement</span><span class="special">(</span><span class="identifier">non_central_chi_squared</span><span class="special">&lt;</span><span class="identifier">RealType</span><span class="special">,</span>
            <span class="identifier">Policy</span><span class="special">&gt;(</span><span class="identifier">v</span><span class="special">,</span> <span class="identifier">lambda</span><span class="special">),</span>
            <span class="identifier">x</span><span class="special">))</span>
            <span class="special">==</span> <span class="identifier">q</span></code>.
  </p>
<pre class="programlisting"><span class="keyword">static</span> <span class="identifier">RealType</span> <span class="identifier">find_non_centrality</span><span class="special">(</span><span class="identifier">RealType</span> <span class="identifier">v</span><span class="special">,</span> <span class="identifier">RealType</span> <span class="identifier">x</span><span class="special">,</span> <span class="identifier">RealType</span> <span class="identifier">p</span><span class="special">);</span>
</pre>
<p>
            这个函数返回非中心参数( non centrality parameter) <span class="emphasis"><em>lambda</em></span>
            满足：</p>
<p>
            <code class="computeroutput"><span class="identifier">cdf</span><span class="special">(</span><span class="identifier">non_central_chi_squared</span><span class="special">&lt;</span><span class="identifier">RealType</span><span class="special">,</span>
            <span class="identifier">Policy</span><span class="special">&gt;(</span><span class="identifier">v</span><span class="special">,</span> <span class="identifier">lambda</span><span class="special">),</span>
            <span class="identifier">x</span><span class="special">)</span>
            <span class="special">==</span> <span class="identifier">p</span></code>
  </p>
<pre class="programlisting"><span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">A</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">B</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">C</span><span class="special">&gt;</span>
<span class="keyword">static</span> <span class="identifier">RealType</span> <span class="identifier">find_non_centrality</span><span class="special">(</span><span class="keyword">const</span> <span class="identifier">complemented3_type</span><span class="special">&lt;</span><span class="identifier">A</span><span class="special">,</span><span class="identifier">B</span><span class="special">,</span><span class="identifier">C</span><span class="special">&gt;&amp;</span> <span class="identifier">c</span><span class="special">);</span>
</pre>
<p>
            当使用<code class="computeroutput"><span class="identifier">boost</span><span class="special">::</span><span class="identifier">math</span><span class="special">::</span><span class="identifier">complement</span><span class="special">(</span><span class="identifier">v</span><span class="special">,</span> <span class="identifier">x</span><span class="special">,</span> <span class="identifier">q</span><span class="special">)</span></code> 参数来调用这个函数的时候，这个函数返回非中心参数( non centrality
            parameter) <span class="emphasis"><em>lambda</em></span> 满足：</p>
<p>
            <code class="computeroutput"><span class="identifier">cdf</span><span class="special">(</span><span class="identifier">complement</span><span class="special">(</span><span class="identifier">non_central_chi_squared</span><span class="special">&lt;</span><span class="identifier">RealType</span><span class="special">,</span>
            <span class="identifier">Policy</span><span class="special">&gt;(</span><span class="identifier">v</span><span class="special">,</span> <span class="identifier">lambda</span><span class="special">),</span>
            <span class="identifier">x</span><span class="special">))</span>
            <span class="special">==</span> <span class="identifier">q</span></code>.
  </p>
<a name="math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.non_member_accessors"></a>
<h5>
<a name="id631438"></a><a href="nc_chi_squared_dist.html#math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.non_member_accessors">非成员访问函数(Non-member
            Accessors)</a>
  </h5>
<p>
            支持所有的分布都通用的            <a href="../nmp.html" title="Non-Member Properties">常见的非成员访问函数</a> ： <a href="../nmp.html#math.dist.cdf">累积分布函数(Cumulative Distribution Function)</a>，<a href="../nmp.html#math.dist.pdf">概率密度函数(Probability Density Function)</a>，<a href="../nmp.html#math.dist.quantile">分位点(Quantile)</a>， <a href="../nmp.html#math.dist.hazard">故障率函数(Hazard Function)</a>， <a href="../nmp.html#math.dist.chf">累积危险函数(Cumulative Hazard Function)</a>， <a href="../nmp.html#math.dist.mean">均值(mean)</a>， <a href="../nmp.html#math.dist.median">中位数(median)</a>， <a href="../nmp.html#math.dist.mode">众数(mode)</a>， <a href="../nmp.html#math.dist.variance">方差(variance)</a>， <a href="../nmp.html#math.dist.sd">标准差(standard deviation)</a>， <a href="../nmp.html#math.dist.skewness">偏斜(skewness)</a>， <a href="../nmp.html#math.dist.kurtosis">峰态(kurtosis)</a>， <a href="../nmp.html#math.dist.kurtosis_excess">峰态超越(kurtosis_excess)</a>， <a href="../nmp.html#math.dist.range">值域(range)</a> 以及 <a href="../nmp.html#math.dist.support">支持(support)</a>。</p>
<p>
            随机变量的定义域为： [0, +&#8734;]。</p>
<a name="math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.examples"></a>
<h5>
<a name="id631609"></a>
            <a href="nc_chi_squared_dist.html#math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.examples">例子</a>
  </h5>
<p>
            非中心χ方形分布( noncentral chi-squared distribution)有一个<a href="../../stat_tut/weg/nccs_eg.html" title="Non Central Chi Squared Example">可执行的例子</a> 。  </p>
<a name="math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.accuracy"></a>
<h5>
<a name="id631649"></a>
            <a href="nc_chi_squared_dist.html#math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.accuracy">精确度</a>
  </h5>
<p>
            下面的表显示了在不同的平台上使用不同的浮点类型的峰值误差(peak error)(单位为10的-5次方(<a href="http://en.wikipedia.org/wiki/Machine_epsilon" target="_top">epsilon</a>))，以及与<a href="http://www.r-project.org/" target="_top">R-2.5.1 Math
            library</a>库的比较。除非另外指定，任何的比这里显示的浮点类型更窄的浮点类型具有<a href="../../../backgrounders/relative_error.html#zero_error">有效零误差(effectively
            zero error)</a>。</p>
<div class="table">
<a name="id631697"></a>
<p class="title"><b>表4.非中心χ方形分布( Noncentral Chi-Squared)的CDF函数的误差</b></p>
<div class="table-contents"><table class="table" summary="Errors In CDF of the Noncentral Chi-Squared">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
                <p>
                  有效数字位数</p>
            </th>
<th>
                <p>
                  平台和编译器</p>
            </th>
<th>
                <p>
                  &#957;,&#955; &lt; 200
                </p>
            </th>
<th>
                <p>
                  &#957;,&#955; &gt; 200
                </p>
            </th>
</tr></thead>
<tbody>
<tr>
<td>
                <p>
                  53
                </p>
            </td>
<td>
                <p>
                  Win32, Visual C++ 8
                </p>
            </td>
<td>
                <p>
                  峰值=50 均值=9.9
                </p>
                <p>
                  R 峰值=685 均值=109
                </p>
            </td>
<td>
                <p>
                  峰值=9780 均值=718
                </p>
                <p>
                  R 峰值=3x10<sup>8</sup> 均值=2x10<sup>7</sup>
                </p>
            </td>
</tr>
<tr>
<td>
                <p>
                  64
                </p>
            </td>
<td>
                <p>
                  RedHat Linux IA32, gcc-4.1.1
                </p>
            </td>
<td>
                <p>
                  峰值=270 均值=27
                </p>
            </td>
<td>
                <p>
                  峰值=7900 均值=900
                </p>
            </td>
</tr>
<tr>
<td>
                <p>
                  64
                </p>
            </td>
<td>
                <p>
                  Redhat Linux IA64, gcc-3.4.4
                </p>
            </td>
<td>
                <p>
                  峰值=107 均值=17
                </p>
            </td>
<td>
                <p>
                  峰值=5000 均值=630
                </p>
            </td>
</tr>
<tr>
<td>
                <p>
                  113
                </p>
            </td>
<td>
                <p>
                  HPUX IA64, aCC A.06.06
                </p>
            </td>
<td>
                <p>
                  峰值=270 均值=20
                </p>
            </td>
<td>
                <p>
                  峰值=4600 均值=560
                </p>
            </td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break">
<p>
          CDF函数的补集与分位点(quantile)函数的误差率大体上是相同的。需要特别提及一下众数(mode)函数： 这个分布并没有闭型(closed form)，因此众数是通过在数值上查找PDF函数的最大值来计算的：在原理上，这无法产生一个比machine epsilon的平方根更高的精确度。</p>
<a name="math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.tests"></a>
<h5>
<a name="id631931"></a>
            <a href="nc_chi_squared_dist.html#math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.tests">测试</a>
  </h5>
<p>
            有两种类别的测试数据来验证这个库的实现：首先我们与发表的数据(published data)进行比较，例如与表6"Self-Validating
            Computations of Probabilities for Selected Central and Noncentral Univariate
            Probability Functions", Morgan C. Wang and William J. Kennedy, Journal
            of the American Statistical Association, Vol. 89, No. 427. (Sep., 1994),
  pp. 878-887。然后，我们有多个表的数据，使用这个库以及使用区间算术进行计算－这些数据的精度至少为50个十进制数字－被用于我们的精度测试。</p>
<a name="math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.implementation"></a>
<h5>
<a name="id631973"></a>
            <a href="nc_chi_squared_dist.html#math_toolkit.dist.dist_ref.dists.nc_chi_squared_dist.implementation">实现</a>
  </h5>
<p>
  CDF函数以及其补集使用下面的方法计算：</p>
<p>
            首先我们判定这个两个值(CDF 或其补集( complement ))
            哪一个更小一些：对于这一点我们可以使用Temme发明的关系式(参考"Asymptotic and Numerical Aspects of the Noncentral Chi-Square
            Distribution", N. M. Temme, Computers Math. Applic. Vol 25, No.
            5, 55-63, 1993) ： </p>
<p>
            F(&#957;,&#955;;&#957;+&#955;) &#8776; 0.5
  </p>
<p>
  因此，当随机变量小于&#957;+&#955;时计算 CDF，当随机变量大于&#957;+&#955;时计算它的补集。如果需要的话，然后用1减去计算的结果来获得期望的结果(CDF或其补集(complement))。</p>
<p>
            对于较小值的非中心变量(non centrality parameter)，使用Ding方法(method of Ding)来计算CDF (参考"Algorithm AS 275: Computing the Non-Central
            #2 Distribution Function", Cherng G. Ding, Applied Statistics, Vol.
  41, No. 2. (1992), pp. 478-482). 使用下面的级数表示：</p>
<p>
            <span class="inlinemediaobject"><img src="../../../../../equations/nc_chi_squ_ref4.png"></span>
  </p>
<p>
            这只需要调用<a href="../../../special/sf_gamma/gamma_derivatives.html" title="Derivative of the Incomplete Gamma Function">gamma_p_derivative</a>
            一次，后面的项可以通过上面显示的递归关系来计算。</p>
<p>
  对于较大值的非中心变量(non centrality parameter)，在达到收敛(convergence)之前，Ding方法(Ding's method) 会带有不合理数量的项。更进一步，最大的项不是第一项，因此在极端情况下，第一项可能是0，即使真值(true value)不为0，也会导致产生为0的结果。</p>
<p>
            因此，当非中心参数(non-centrality parameter)大于200时，使用由 Krishnamoorthy发明的算法 (参考"Computing discrete mixtures of
            continuous distributions: noncentral chisquare, noncentral t and the
            distribution of the square of the sample multiple correlation coefficient",
            Denise Benton and K. Krishnamoorthy, Computational Statistics &amp; Data
            Analysis, 43, (2003), 249-267) ： </p>
<p>
  这个算法使用著名的求和公式 ：</p>
<p>
            <span class="inlinemediaobject"><img src="../../../../../equations/nc_chi_squ_ref5.png"></span>
  </p>
<p>
            其中 P<sub>a</sub>(x) 是不完全γ函数。</p>
<p>
            这种算法从第&#955;th 项开始，泊松权重函数( Poisson weighting
            function)在这一项处达到它的极大值，虽然这并不一定是总体最大项(largest overall term)。后面的项用不完全γ函数的一般递归关系(normal
  recurrence relations)来计算，迭代从向前和向后两个方向进行直到达到足够的精度。应当指出的是：P<sub>a</sub>(x)在几前方向上的迭代在数值上是不稳定的。然而，因为我们永远都从都中的最大项<span class="emphasis"><em>之后</em></span> 开始，数值不稳定性( numeric instability )的引入(introduced)比级数的收敛更慢。</p>
<p>
            CDF补集(complement)的计算使用扩展的 Krishnamoorthy方法，给定：</p>
<p>
            <span class="inlinemediaobject"><img src="../../../../../equations/nc_chi_squ_ref6.png"></span>
  </p>
<p>
  我们又可以从第&#955;'th 项开始并且在两个方向上进行直到达到足够的精度。这一次在不完全γ函数Q<sub>a</sub>(x)的向后递归上是不稳定的。然而，因为我们从最大项之前开始计算，所在，在实际中这不是一个问题。</p>
<p>
  函数PDF直接使用下面的关系计算：</p>
<p>
            <span class="inlinemediaobject"><img src="../../../../../equations/nc_chi_squ_ref3.png"></span>
  </p>
<p>
            其中<span class="emphasis"><em>f(x; v)</em></span> 是中心<a href="chi_squared_dist.html" title="Chi Squared Distribution">χ方形分布(Chi
            Squared Distribution)</a> 的PDF函数，并且<span class="emphasis"><em>I<sub>v</sub>(x)</em></span> 是修正贝赛尔函数(
            Bessel function)， 参考<a href="../../../special/bessel/mbessel.html" title="Modified Bessel Functions of the First and Second Kinds">cyl_bessel_i</a>。对于较小的非中心参数( non-centrality parameter)，使用<a href="../../../special/bessel/mbessel.html" title="Modified Bessel Functions of the First and Second Kinds">cyl_bessel_i</a>
            函数中的关系。然而，对于较大的非中心参数( non-centrality parameter)这种方法会导致失败，因此，在这种情况下无穷和(infinite sum)使用 Benton 和 Krishnamoorthy方法来计算，, 以及对于连续项(successive term)的一般递归关系(usual recurrence relations)。</p>
<p>
            分位点(quantile)函数使用数值版本的CDF反函数( numeric inversion of the CDF)。</p>
<p>
            对于非中心χ方形分布( noncentral chi-squared distribution )的众数(mode)没有<a href="http://en.wikipedia.org/wiki/Closed_form" target="_top">闭型(closed
  form)</a> ：它们通过在数值上查找函数PDF的极大值来计算的。类似地，中位数(median)是在数值上(numerically)使用分位点(quantile)函数来计算的。</p>
<p>
            剩下的非成员函数使用下面的方程式：</p>
<p>
            <span class="inlinemediaobject"><img src="../../../../../equations/nc_chi_squ_ref7.png"></span>
  </p>
<p>
            非中心分布( noncentral distributions)的一些解析属性(analytic propertiees) (特别是众数的单峰( unimodality )，以及 单翟(monotonicity)) 由：</p>
<p>
            Andrea van Aubel &amp; Wolfgang Gawronski, Applied Mathematics and Computation,
            141 (2003) 3-12.
</p>
<p>调查和总结。  </p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright ?2006 , 2007, 2008 John Maddock, Paul A. Bristow, Hubert
      Holin, Xiaogang Zhang and Bruno Lalande<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="nc_beta_dist.html"><img src="../../../../../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../dists.html"><img src="../../../../../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../../../../index.html"><img src="../../../../../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="nc_f_dist.html"><img src="../../../../../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
</body>
</html>
