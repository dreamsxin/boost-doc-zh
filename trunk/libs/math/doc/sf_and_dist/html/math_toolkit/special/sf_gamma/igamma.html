<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Incomplete Gamma Functions</title>
<link rel="stylesheet" href="../../../../../../../../doc/html/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_2006-12-17_0120">
<link rel="start" href="../../../index.html" title="Math Toolkit">
<link rel="up" href="../sf_gamma.html" title="Gamma Functions">
<link rel="prev" href="gamma_ratios.html" title="Ratios of Gamma Functions">
<link rel="next" href="igamma_inv.html" title="Incomplete Gamma Function Inverses">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../../../../boost.png"></td>
<td align="center"><a href="../../../../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="gamma_ratios.html"><img src="../../../../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../sf_gamma.html"><img src="../../../../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../../../index.html"><img src="../../../../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="igamma_inv.html"><img src="../../../../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div>
  <h4 class="title">
<a name="math_toolkit.special.sf_gamma.igamma"></a><a href="igamma.html" title="Incomplete Gamma Functions"> 不完全γ函数</a>
</h4>
</div></div></div>
<a name="math_toolkit.special.sf_gamma.igamma.synopsis"></a>
<h5>
<a name="id659609"></a>
          <a href="igamma.html#math_toolkit.special.sf_gamma.igamma.synopsis">概要</a>
  </h5>
<p>
          
</p>
<pre class="programlisting"><span class="preprocessor">#include</span> <span class="special">&lt;</span><span class="identifier">boost</span><span class="special">/</span><span class="identifier">math</span><span class="special">/</span><span class="identifier">special_functions</span><span class="special">/</span><span class="identifier">gamma</span><span class="special">.</span><span class="identifier">hpp</span><span class="special">&gt;</span>
</pre>
<p>
  </p>
<pre class="programlisting"><span class="keyword">namespace</span> <span class="identifier">boost</span><span class="special">{</span> <span class="keyword">namespace</span> <span class="identifier">math</span><span class="special">{</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">gamma_p</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">,</span> <span class="keyword">class</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">gamma_p</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">,</span> <span class="keyword">const</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&amp;);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">gamma_q</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">,</span> <span class="keyword">class</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">gamma_q</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">,</span> <span class="keyword">const</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&amp;);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">tgamma_lower</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">,</span> <span class="keyword">class</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">tgamma_lower</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">,</span> <span class="keyword">const</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&amp;);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">tgamma</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">,</span> <span class="keyword">class</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">tgamma</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">,</span> <span class="keyword">const</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&amp;);</span>

<span class="special">}}</span> <span class="comment">// namespaces
</span></pre>
<a name="math_toolkit.special.sf_gamma.igamma.description"></a>
<h5>
<a name="id660716"></a>
          <a href="igamma.html#math_toolkit.special.sf_gamma.igamma.description">说明</a>
  </h5>
<p>
          有四个<a href="http://mathworld.wolfram.com/IncompleteGammaFunction.html" target="_top">不完全γ函数</a>：两个是规范形式(也被称作规范不完全函数)，返回范围在[0, 1]区间内的值，而另外两个是不规则形式，返回值的范围为 [0, &#915;(a)]。对于统计应用感兴趣的用户应当使用 <a href="http://mathworld.wolfram.com/RegularizedGammaFunction.html" target="_top">规范形式 (gamma_p 和 gamma_q)</a>.</p>
<p>
          所有的这些函数要求<span class="emphasis"><em>a &gt; 0</em></span> 且 <span class="emphasis"><em>z
          &gt;= 0</em></span>, 否则返回<a href="../../main_overview/error_handling.html#domain_error">定义域错误</a>.
  </p>
<p>
  </p>
<p>
            最后一个<a href="../../policy.html" title="Policies">策略</a> 参数是可选的并且可以用来控制函数的行为: 如何处理错误, 使用哪种层次的精度等等. 参见<a href="../../policy.html" title="Policies">策略文档</a>了解更多信息。</p>
<p>
  </p>
<p>
          当T1和T2是不同类型的时候，函数返回值的类型使用<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>返回值推导法则</em></span></a>:来确定，
          否则返回值的类型是T1.
  </p>
<pre class="programlisting"><span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">gamma_p</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">Policy</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">gamma_p</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">,</span> <span class="keyword">const</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&amp;);</span>
</pre>
<p>
          返回a和z的规范的下半部不完全γ函数：</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/igamma4.png"></span>
  </p>
<p>
  围绕在点z==a处，函数很快地从0变化到1：</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../graphs/gamma_p.png" align="middle"></span>
  </p>
<pre class="programlisting"><span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">gamma_q</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">,</span> <span class="keyword">class</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">gamma_q</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">,</span> <span class="keyword">const</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&amp;);</span>
</pre>
<p>
          返回a和z的规范的上半部不完全γ函数：</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/igamma3.png"></span>
  </p>
<p>
          围绕在点z==a处，函数很快地从1变化到0：</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../graphs/gamma_q.png" align="middle"></span>
  </p>
<pre class="programlisting"><span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">tgamma_lower</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">,</span> <span class="keyword">class</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">tgamma_lower</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">,</span> <span class="keyword">const</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&amp;);</span>
</pre>
<p>
          返回完全的(非规范化) a和z的下半部不完全γ函数：</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/igamma2.png"></span>
  </p>
<pre class="programlisting"><span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">tgamma</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">,</span> <span class="keyword">class</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">tgamma</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">a</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">z</span><span class="special">,</span> <span class="keyword">const</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&amp;);</span>
</pre>
<p>
          返回完全的(非规范化) a和z的上半部不完全γ函数：</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/igamma1.png"></span>
  </p>
<a name="math_toolkit.special.sf_gamma.igamma.accuracy"></a>
<h5>
<a name="id662040"></a>
          <a href="igamma.html#math_toolkit.special.sf_gamma.igamma.accuracy">精确度</a>
  </h5>
<p>
          下面的图像显示了在a和z的不同的定义域上的函数的相对误差的峰值和均值，以及与<a href="http://www.gnu.org/software/gsl/" target="_top">GSL-1.9</a>
          库和<a href="http://www.netlib.org/cephes/" target="_top">Cephes</a> 库的比较.注意：在一些平台上使用窄浮点类型来表示宽浮点类型的唯一结果具有<a href="../../backgrounders/relative_error.html#zero_error">高效零误差</a>. </p>
<p>
  注意：当 <span class="emphasis"><em>a</em></span>增大时，误差也在增大 。</p>
<p>
  同样也要注意：对于80bit 精度和120-bit精度的高误差具有一些迷惑性：在64-bit期待为0的结果在更大的指数范围long double 可能不为零，但是会非常小，这些函数也因此反映了为这些类型构造的测试的更极限的属性。</p>
<p>
  所有的数据都是以epsilon(10的-5次方)为单位。</p>
<div class="table">
<a name="id662109"></a>
<p class="title"><b>表8.函数 gamma_p(a,z)的误差</b></p>
<div class="table-contents"><table class="table" summary="Errors In the Function gamma_p(a,z)">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
              <p>
                有效数字位数</p>
            </th>
<th>
              <p>
                平台和编译器</p>
            </th>
<th>
              <p>
                0.5 &lt; a &lt; 100
              </p>
              <p>
                且</p>
              <p>
                0.01*a &lt; z &lt; 100*a
              </p>
            </th>
<th>
              <p>
                1x10<sup>-12</sup> &lt; a &lt; 5x10<sup>-2</sup>
              </p>
              <p>
                且</p>
              <p>
                0.01*a &lt; z &lt; 100*a
              </p>
            </th>
<th>
              <p>
                1e-6 &lt; a &lt; 1.7x10<sup>6</sup>
              </p>
              <p>
                且</p>
              <p>
                1 &lt; z &lt; 100*a
              </p>
            </th>
</tr></thead>
<tbody>
<tr>
<td>
              <p>
                53
              </p>
            </td>
<td>
              <p>
                Win32, Visual C++ 8
              </p>
            </td>
<td>
              <p>
                峰值=36 均值=9.1
              </p>
              <p>
                (GSL 峰值=342 均值=46)
              </p>
              <p>
                (<a href="http://www.netlib.org/cephes/" target="_top">Cephes</a> 峰值=491
                均值=102)
              </p>
            </td>
<td>
              <p>
                峰值=4.5 均值=1.4
              </p>
              <p>
                (GSL 峰值=4.8 均值=0.76)
              </p>
              <p>
                (<a href="http://www.netlib.org/cephes/" target="_top">Cephes</a> 峰值=21
                均值=5.6)
              </p>
            </td>
<td>
              <p>
                峰值=244 均值=21
              </p>
              <p>
                (GSL 峰值=1022 均值=1054)
              </p>
              <p>
                (<a href="http://www.netlib.org/cephes/" target="_top">Cephes</a> 峰值~8x10<sup>6</sup> 均值~7x10<sup>4</sup>)
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                RedHat Linux IA32, gcc-3.3
              </p>
            </td>
<td>
              <p>
                峰值=241 均值=36
              </p>
            </td>
<td>
              <p>
                峰值=4.7 均值=1.5
              </p>
            </td>
<td>
              <p>
                峰值~30,220 均值=1929
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                Redhat Linux IA64, gcc-3.4
              </p>
            </td>
<td>
              <p>
                峰值=41 均值=10
              </p>
            </td>
<td>
              <p>
                峰值=4.7 均值=1.4
              </p>
            </td>
<td>
              <p>
                峰值~30,790 均值=1864
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                113
              </p>
            </td>
<td>
              <p>
                HPUX IA64, aCC A.06.06
              </p>
            </td>
<td>
              <p>
                峰值=40.2 均值=10.2
              </p>
            </td>
<td>
              <p>
                峰值=5 均值=1.6
              </p>
            </td>
<td>
              <p>
                峰值=5,476 均值=440
              </p>
            </td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><div class="table">
<a name="id662428"></a>
<p class="title"><b>表9.函数 gamma_q(a,z)的误差</b></p>
<div class="table-contents"><table class="table" summary="Errors In the Function gamma_q(a,z)">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
              <p>
                有效数字位数</p>            </th>
<th>
              <p>
                平台和编译器</p>            </th>
<th>
              <p>
                0.5 &lt; a &lt; 100
              </p>
              <p>
                且</p>
              <p>
                0.01*a &lt; z &lt; 100*a
              </p>
            </th>
<th>
              <p>
                1x10<sup>-12</sup> &lt; a &lt; 5x10<sup>-2</sup>
              </p>
              <p>
                且</p>
              <p>
                0.01*a &lt; z &lt; 100*a
              </p>
            </th>
<th>
              <p>
                1x10<sup>-6</sup> &lt; a &lt; 1.7x10<sup>6</sup>
              </p>
              <p>
                且</p>
              <p>
                1 &lt; z &lt; 100*a
              </p>
            </th>
</tr></thead>
<tbody>
<tr>
<td>
              <p>
                53
              </p>
            </td>
<td>
              <p>
                Win32, Visual C++ 8
              </p>
            </td>
<td>
              <p>
                峰值=28.3 均值=7.2
              </p>
              <p>
                (GSL 峰值=201 均值=13)
              </p>
              <p>
                (<a href="http://www.netlib.org/cephes/" target="_top">Cephes</a> 峰值=556
                均值=97)
              </p>
            </td>
<td>
              <p>
                峰值=4.8 均值=1.6
              </p>
              <p>
                (GSL 峰值~1.3x10<sup>10</sup> 均值=1x10<sup>+9</sup>)
              </p>
              <p>
                (<a href="http://www.netlib.org/cephes/" target="_top">Cephes</a> 峰值~3x10<sup>11</sup> 均值=4x10<sup>10</sup>)
              </p>
            </td>
<td>
              <p>
                峰值=469 均值=33
              </p>
              <p>
                (GSL 峰值=27,050 均值=2159)
              </p>
              <p>
                (<a href="http://www.netlib.org/cephes/" target="_top">Cephes</a> 峰值~8x10<sup>6</sup> 均值~7x10<sup>5</sup>)
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                RedHat Linux IA32, gcc-3.3
              </p>
            </td>
<td>
              <p>
                峰值=280 均值=33
              </p>
            </td>
<td>
              <p>
                峰值=4.1 均值=1.6
              </p>
            </td>
<td>
              <p>
                峰值=11,490 均值=732
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                Redhat Linux IA64, gcc-3.4
              </p>
            </td>
<td>
              <p>
                峰值=32 均值=9.4
              </p>
            </td>
<td>
              <p>
                峰值=4.7 均值=1.5
              </p>
            </td>
<td>
              <p>
                峰值=6815 均值=414
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                113
              </p>
            </td>
<td>
              <p>
                HPUX IA64, aCC A.06.06
              </p>
            </td>
<td>
              <p>
                峰值=37 均值=10
              </p>
            </td>
<td>
              <p>
                峰值=11.2 均值=2.0
              </p>
            </td>
<td>
              <p>
                峰值=4,999 均值=298
              </p>
            </td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><div class="table">
<a name="id662766"></a><p class="title"><b>Table?0.Function tgamma_lower(a,z)<b>误差</b></b></p>
<div class="table-contents"><table class="table" summary="Errors In the Function tgamma_lower(a,z)">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
              <p>
                有效数字位数</p>            </th>
<th>
              <p>
                平台和编译器</p>            </th>
<th>
              <p>
                0.5 &lt; a &lt; 100
              </p>
              <p>
                且</p>
              <p>
                0.01*a &lt; z &lt; 100*a
              </p>
            </th>
<th>
              <p>
                1x10<sup>-12</sup> &lt; a &lt; 5x10<sup>-2</sup>
              </p>
              <p>
                且</p>
              <p>
                0.01*a &lt; z &lt; 100*a
              </p>
            </th>
</tr></thead>
<tbody>
<tr>
<td>
              <p>
                53
              </p>
            </td>
<td>
              <p>
                Win32, Visual C++ 8
              </p>
            </td>
<td>
              <p>
                峰值=5.5 均值=1.4
              </p>
            </td>
<td>
              <p>
                峰值=3.6 均值=0.78
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                RedHat Linux IA32, gcc-3.3
              </p>
            </td>
<td>
              <p>
                峰值=402 均值=79
              </p>
            </td>
<td>
              <p>
                峰值=3.4 均值=0.8
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                Redhat Linux IA64, gcc-3.4
              </p>
            </td>
<td>
              <p>
                峰值=6.8 均值=1.4
              </p>
            </td>
<td>
              <p>
                峰值=3.4 均值=0.78
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                113
              </p>
            </td>
<td>
              <p>
                HPUX IA64, aCC A.06.06
              </p>
            </td>
<td>
              <p>
                峰值=6.1 均值=1.8
              </p>
            </td>
<td>
              <p>
                峰值=3.7 均值=0.89
              </p>
            </td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><div class="table">
<a name="id662979"></a>
<p class="title"><b>表10.函数 tgamma(a,z)的误差</b></p>
<div class="table-contents"><table class="table" summary="Errors In the Function tgamma(a,z)">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
              <p>
            有效数字位数</p>            </th>
<th>
              <p>
                平台和编译器</p>            </th>
<th>
              <p>
                0.5 &lt; a &lt; 100
              </p>
              <p>
                and
              </p>
              <p>
                0.01*a &lt; z &lt; 100*a
              </p>
            </th>
<th>
              <p>
                1x10<sup>-12</sup> &lt; a &lt; 5x10<sup>-2</sup>
              </p>
              <p>
                and
              </p>
              <p>
                0.01*a &lt; z &lt; 100*a
              </p>
            </th>
</tr></thead>
<tbody>
<tr>
<td>
              <p>
                53
              </p>
            </td>
<td>
              <p>
                Win32, Visual C++ 8
              </p>
            </td>
<td>
              <p>
                峰值=5.9 均值=1.5
              </p>
            </td>
<td>
              <p>
                峰值=1.8 均值=0.6
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                RedHat Linux IA32, gcc-3.3
              </p>
            </td>
<td>
              <p>
                峰值=596 均值=116
              </p>
            </td>
<td>
              <p>
                峰值=3.2 均值=0.84
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                Redhat Linux IA64, gcc-3.4.4
              </p>
            </td>
<td>
              <p>
                峰值=40.2 均值=2.5
              </p>
            </td>
<td>
              <p>
                峰值=3.2 均值=0.8
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                113
              </p>
            </td>
<td>
              <p>
                HPUX IA64, aCC A.06.06
              </p>
            </td>
<td>
              <p>
                峰值=364 均值=17.6
              </p>
            </td>
<td>
              <p>
                峰值=12.7 均值=1.8
              </p>
            </td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><a name="math_toolkit.special.sf_gamma.igamma.testing"></a>
<h5>
<a name="id663200"></a>
          <a href="igamma.html#math_toolkit.special.sf_gamma.igamma.testing">测试</a>
  </h5>
<p>
          有两种类型的测试：抽样测试的比较数据基于这个库的实现并使用<a href="http://functions.wolfram.com/GammaBetaErf/" target="_top">数学 世界在线计算器</a>
          用来进行一些基本的"合理性检查(sanity check)".精度的测试数据使用非常高精度的测试数据 (使用精度为1000-bit的 NTL's RR 类) ，使用一个60项的<a href="../../backgrounders/lanczos.html" title="The Lanczos Approximation">兰克泽斯逼近</a>产生非常高精度的数据,同时有一些但不是所有的特殊情况都被禁止了。这还不太令人满意：应当使用一个独立的方法，但是缺少这一些独立的方法。我们甚至不能故意单纯使用一个不对特殊情况进行处理的库实现，因为对于较小的a 和 z
  ，勒让德连分数是不稳定的。</p>
<a name="math_toolkit.special.sf_gamma.igamma.implementation"></a>
<h5>
<a name="id663258"></a>
          <a href="igamma.html#math_toolkit.special.sf_gamma.igamma.implementation">实现</a>
  </h5>
<p>
  这四个函数共同使用一个通用的实现，因为它们通过下面的关系联系起来：</p>
<p>
          1) <span class="inlinemediaobject"><img src="../../../../equations/igamma5.png"></span>
  </p>
<p>
          2) <span class="inlinemediaobject"><img src="../../../../equations/igamma6.png"></span>
  </p>
<p>
          3) <span class="inlinemediaobject"><img src="../../../../equations/igamma7.png"></span>
  </p>
<p>
  不完全γ函数的下半部使用它的级数表示来计算：</p>
<p>
          4) <span class="inlinemediaobject"><img src="../../../../equations/igamma8.png"></span>
  </p>
<p>
          或者当 <span class="emphasis"><em>x &gt; a 且 x &gt; 1.1</em></span>时从上半部积分中减去&#915;(a) 或 1.
  </p>
<p>
  上半部积分使用勒让德连分数表示来计算：</p>
<p>
          5) <span class="inlinemediaobject"><img src="../../../../equations/igamma9.png"></span>
  </p>
<p>
          当 <span class="emphasis"><em>x &lt; a </em></span>时从下半部积分中减去&#915;(a) 或 1.</p>
<p>
  对于<span class="emphasis"><em>x &lt; 1.1</em></span>，计算上半部积分有一些复杂，因为在这个区域内的连分数表示并不是连续的。然而还有另外一个级数表示可用于下半部积分： </p>
<p>
          6) <span class="inlinemediaobject"><img src="../../../../equations/igamma10.png"></span>
  </p>
<p>
          这就可以通过重组来计算上半部积分：</p>
<p>
          7) <span class="inlinemediaobject"><img src="../../../../equations/igamma11.png"></span>
  </p>
<p>
          参看<a href="../powers/powm1.html" title="powm1">powm1</a>
          和<a href="tgamma.html" title="Gamma">tgamma1pm1</a>了解这些函数的实现.注意： <a href="tgamma.html" title="Gamma">tgamma1pm1</a>
          的精度交叉于35个数字或与与T类型相关的<a href="../../backgrounders/lanczos.html" title="The Lanczos Approximation">兰克泽斯逼近</a> 相关- 如果有的话 - 无论哪一个更大一些. 这就为这个区域内的精度强加了一个类似的限制。</p>
<p>
          对于<span class="emphasis"><em>x &lt; 1.1</em></span> 结果~0.5的交叉点不会在x~y时出现。使用<span class="emphasis"><em>x
          * 1.1 &lt; a</em></span> 作为当 <span class="emphasis"><em>0.5 &lt;
          x &lt;= 1.1</em></span> 时的交叉准则保持最大的计算值在0.6附近。类似的，对于<span class="emphasis"><em>x &lt;=
          0.5</em></span> 使用<span class="emphasis"><em>-0.4 / log(x) &lt; a作为</em></span>交叉准则保持最大的计算值在0.7附近
          (不管是上半部积分还是下半部积分).
  </p>
<p>
          当a是一个整数或半整数的时候使用了两个特殊情况，且上面列举的交叉情况表明我们应当计算上半部积分Q。如果a是一个在范围<span class="emphasis"><em>1 &lt;=
          a &lt; 30</em></span> 中的值，那么使用下面的有限求和:
  </p>
<p>
          9) <span class="inlinemediaobject"><img src="../../../../equations/igamma1f.png"></span>
  </p>
<p>
          而对于在范围<span class="emphasis"><em>0.5 &lt;= a &lt; 30</em></span>
          内的值，使用下面的有限求和:
  </p>
<p>
          10) <span class="inlinemediaobject"><img src="../../../../equations/igamma2f.png"></span>
  </p>
<p>
  它们比连分数法更稳定也更高效一些。</p>
<p>
  当参数a很大时，且x~a，那么级数(4)和连分数(5)收敛得很慢，在这个区域使用坦普尔展开：</p>
<p>
          11) <span class="inlinemediaobject"><img src="../../../../equations/igamma16.png"></span>
  </p>
<p>
          12) <span class="inlinemediaobject"><img src="../../../../equations/igamma17.png"></span>
  </p>
<p>
          13) <span class="inlinemediaobject"><img src="../../../../equations/igamma18.png"></span>
  </p>
<p>
          14) <span class="inlinemediaobject"><img src="../../../../equations/igamma19.png"></span>
  </p>
<p>
  被截断为固定数目的项-用于产生一个指定的精确度-且作为一个多项式的式项式来求值。有高达128-bit精确度的函数版本：对于那些要求更高精度的类型不使用上面的展开方法。系数C<sub>k</sub><sup>n</sup> 由Temme给定的递推关系预先计算，使用这些展开方法为：</p>
<pre class="programlisting"><span class="special">(</span><span class="identifier">a</span> <span class="special">&gt;</span> <span class="number">20</span><span class="special">)</span> <span class="special">&amp;&amp;</span> <span class="special">(</span><span class="identifier">a</span> <span class="special">&lt;</span> <span class="number">200</span><span class="special">)</span> <span class="special">&amp;&amp;</span> <span class="identifier">fabs</span><span class="special">(</span><span class="identifier">x</span><span class="special">-</span><span class="identifier">a</span><span class="special">)/</span><span class="identifier">a</span> <span class="special">&lt;</span> <span class="number">0.4</span>
</pre>
<p>
          以及:
  </p>
<pre class="programlisting"><span class="special">(</span><span class="identifier">a</span> <span class="special">&gt;</span> <span class="number">200</span><span class="special">)</span> <span class="special">&amp;&amp;</span> <span class="special">(</span><span class="identifier">fabs</span><span class="special">(</span><span class="identifier">x</span><span class="special">-</span><span class="identifier">a</span><span class="special">)/</span><span class="identifier">a</span> <span class="special">&lt;</span> <span class="number">4.5</span><span class="special">/</span><span class="identifier">sqrt</span><span class="special">(</span><span class="identifier">a</span><span class="special">))</span>
</pre>
<p>
  后面的一个范围对于所有的高达128-bit精度的long double的类型都是合法的，并且被设计用来确保计算结果大于10<sup>-6</sup>，第一个范围只用于高达80-bit的long double类型。这些定义域比Temme 或 Didonato 和 Morris推荐的定义域都要窄。然而，使用一个范围导致更大的且更不精确(也就是说，计算的结果)的值被传递给函数exp和函数erfc,从而导致更大的误差率。换句话说，在效率和误差之间有一个权衡。当前的当前为保持被(4)和(5)要求的项数在double精度时不超过~20。</p>
<p>
          对于规范的不完全函数，计算前导幂系数是这个函数的精度的中心。对于小的a和x合并幂集项使用<a href="../../backgrounders/lanczos.html" title="The Lanczos Approximation">兰克泽斯逼近</a> 给出最大的精度:
  </p>
<p>
          15) <span class="inlinemediaobject"><img src="../../../../equations/igamma12.png"></span>
  </p>
<p>
  结果这会产生下溢和上溢，然后这个指数可以消去一个因子 la 并放在幂项里面</p>
<p>
          当a和x很大时，我们会得到一个非常大的指数，其基数接近于1：由幂函数来计算不会产生精确的结果，而简单地取对数导致消去误差。最严重的误差可以使用下面的方法来避免:
  </p>
<p>
          16) <span class="inlinemediaobject"><img src="../../../../equations/igamma13.png"></span>
  </p>
<p>
          当<span class="emphasis"><em>a-x</em></span> 很小而 a 和 x 很大 .这里仍然会有一个减法操作因此，会产生一些消去误差 - 因为项很小，所以绝对误差将会很小，是绝对误差而不是相对误差在函数exp中读数。注意，对于足够大的a和x,你仍然会得到误差，虽然与其它方法相比这会延迟这些误差不避免的误差。在这里使用<span class="emphasis"><em>log(1+x)-x</em></span> 是受到Temme 的启发(参看下面的参考资料).
  </p>
<a name="math_toolkit.special.sf_gamma.igamma.references"></a>
<h5>
<a name="id664286"></a>
          <a href="igamma.html#math_toolkit.special.sf_gamma.igamma.references">参考资料</a>
  </h5>
<div class="itemizedlist"><ul type="disc">
<li>
            N. M. Temme, A Set of Algorithms for the Incomplete Gamma Functions,
            Probability in the Engineering and Informational Sciences, 8, 1994.
      </li>
<li>
            N. M. Temme, The Asymptotic Expansion of the Incomplete Gamma Functions,
            Siam J. Math Anal. Vol 10 No 4, July 1979, p757.
      </li>
<li>
            A. R. Didonato and A. H. Morris, Computation of the Incomplete Gamma
            Function Ratios and their Inverse. ACM TOMS, Vol 12, No 4, Dec 1986,
            p377.
      </li>
<li>
            W. Gautschi, The Incomplete Gamma Functions Since Tricomi, In Tricomi's
            Ideas and Contemporary Applied Mathematics, Atti dei Convegni Lincei,
            n. 147, Accademia Nazionale dei Lincei, Roma, 1998, pp. 203--237. <a href="http://citeseer.ist.psu.edu/gautschi98incomplete.html" target="_top">http://citeseer.ist.psu.edu/gautschi98incomplete.html</a>
</li>
</ul></div>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright ?2006 , 2007, 2008 John Maddock, Paul A. Bristow, Hubert
      Holin, Xiaogang Zhang and Bruno Lalande<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="gamma_ratios.html"><img src="../../../../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../sf_gamma.html"><img src="../../../../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../../../index.html"><img src="../../../../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="igamma_inv.html"><img src="../../../../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
</body>
</html>
