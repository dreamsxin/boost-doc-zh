<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Modified Bessel Functions of the First and Second Kinds</title>
<link rel="stylesheet" href="../../../../../../../../doc/html/boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets Vsnapshot_2006-12-17_0120">
<link rel="start" href="../../../index.html" title="Math Toolkit">
<link rel="up" href="../bessel.html" title="Bessel Functions">
<link rel="prev" href="bessel.html" title="Bessel Functions of the First and Second Kinds">
<link rel="next" href="sph_bessel.html" title="Spherical Bessel Functions of the First and Second Kinds">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table cellpadding="2" width="100%"><tr>
<td valign="top"><img alt="Boost C++ Libraries" width="277" height="86" src="../../../../../../../../boost.png"></td>
<td align="center"><a href="../../../../../../../../index.html">Home</a></td>
<td align="center"><a href="../../../../../../../../libs/libraries.htm">Libraries</a></td>
<td align="center"><a href="http://www.boost.org/users/people.html">People</a></td>
<td align="center"><a href="http://www.boost.org/users/faq.html">FAQ</a></td>
<td align="center"><a href="../../../../../../../../more/index.htm">More</a></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="bessel.html"><img src="../../../../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../bessel.html"><img src="../../../../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../../../index.html"><img src="../../../../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="sph_bessel.html"><img src="../../../../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
<div class="section" lang="en">
<div class="titlepage"><div><div>
  <h4 class="title">
<a name="math_toolkit.special.bessel.mbessel"></a><a href="mbessel.html" title="Modified Bessel Functions of the First and Second Kinds"> 第一类修正贝赛尔函数和第二类修正贝赛尔函数 </a>
</h4>
</div></div></div>
<a name="math_toolkit.special.bessel.mbessel.synopsis"></a>
<h5>
<a name="id710103"></a>
          <a href="mbessel.html#math_toolkit.special.bessel.mbessel.synopsis">概要</a>
  </h5>
<pre class="programlisting"><span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">cyl_bessel_i</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">v</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">x</span><span class="special">);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">,</span> <span class="keyword">class</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">cyl_bessel_i</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">v</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">x</span><span class="special">,</span> <span class="keyword">const</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&amp;);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">cyl_bessel_k</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">v</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">x</span><span class="special">);</span>

<span class="keyword">template</span> <span class="special">&lt;</span><span class="keyword">class</span> <span class="identifier">T1</span><span class="special">,</span> <span class="keyword">class</span> <span class="identifier">T2</span><span class="special">,</span> <span class="keyword">class</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&gt;</span>
<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>calculated-result-type</em></span></a> <span class="identifier">cyl_bessel_k</span><span class="special">(</span><span class="identifier">T1</span> <span class="identifier">v</span><span class="special">,</span> <span class="identifier">T2</span> <span class="identifier">x</span><span class="special">,</span> <span class="keyword">const</span> <a href="../../policy.html" title="Policies">Policy</a><span class="special">&amp;);</span>
</pre>
<a name="math_toolkit.special.bessel.mbessel.description"></a>
<h5>
<a name="id710612"></a>
          <a href="mbessel.html#math_toolkit.special.bessel.mbessel.description">说明</a>
  </h5>
<p>
          函数<a href="mbessel.html" title="Modified Bessel Functions of the First and Second Kinds">cyl_bessel_i</a>
          和 函数<a href="mbessel.html" title="Modified Bessel Functions of the First and Second Kinds">cyl_bessel_k</a>
          分别返回第一类修正贝赛尔函数和第二类修正贝赛尔函数:
  </p>
<p>
          cyl_bessel_i(v, x) = I<sub>v</sub>(x)
  </p>
<p>
          cyl_bessel_k(v, x) = K<sub>v</sub>(x)
  </p>
<p>
          其中:
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel2.png"></span>
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel3.png"></span>
  </p>
<p>
          当T1和T2是不同类型的时候，函数的返回类型使用<a href="../../main_overview/result_type.html" title="Calculation of the Type of the Result"><span class="emphasis"><em>返回值类型推导法则</em></span></a> 来确定.
          这些函数也针对T1是整数的情况进行了优化.
  </p>
<p>
  </p>
<p>
            最后一个<a href="../../policy.html" title="Policies">策略</a> 参数是可选 的并且可以用来控制函数的行为:
            如何处理错误, 使用哪种层次的精度等等. 参见<a href="../../policy.html" title="Policies">策略文档</a>来了解更多信息。  </p>
<p>
  </p>
<p>
          当结果是未定义或是复数的时候函数返回<a href="../../main_overview/error_handling.html#domain_error">定义域错误</a>. 对于函数<a href="bessel.html" title="Bessel Functions of the First and Second Kinds">cyl_bessel_j</a>
          这会在<code class="computeroutput"><span class="identifier">x</span> <span class="special">&lt;</span>
          <span class="number">0</span></code> 且 v不是一个整数的情况下发生, 或者当<code class="computeroutput"><span class="identifier">x</span> <span class="special">==</span>
          <span class="number">0</span></code> 且 <code class="computeroutput"><span class="identifier">v</span>
          <span class="special">!=</span> <span class="number">0时发生</span></code>.
          对于函数<a href="bessel.html" title="Bessel Functions of the First and Second Kinds">cyl_neumann</a>
          这会在<code class="computeroutput"><span class="identifier">x</span> <span class="special">&lt;=</span>
          <span class="number">0</span></code>时发生。
  </p>
<p>
          下面的图像显示了 I<sub>v</sub> 的指数特性：
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../graphs/cyl_bessel_i.png" align="middle"></span>
  </p>
<p>
          下面的图像显示了 K<sub>v</sub>.的指数下降特性：</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../graphs/cyl_bessel_k.png" align="middle"></span>
  </p>
<a name="math_toolkit.special.bessel.mbessel.testing"></a>
<h5>
<a name="id711001"></a>
          <a href="mbessel.html#math_toolkit.special.bessel.mbessel.testing">测试</a>
  </h5>
<p>
          有两种测试数据: 使用<a href="http://functions.wolfram.com" target="_top">functions.wolfram.com</a>计算出的抽样测试数据以及使用这种实现的简化版本来计算出的数据量更大的测试数据 (去掉所有的对特殊情况的处理).</p>
<a name="math_toolkit.special.bessel.mbessel.accuracy"></a>
<h5>
<a name="id711040"></a>
          <a href="mbessel.html#math_toolkit.special.bessel.mbessel.accuracy">精确性</a>
  </h5>
<p>
          下面的表显示了这些函数在不同平台上的准确性的变化， 以及与 <a href="http://www.gnu.org/software/gsl/" target="_top">GSL-1.9</a> 和<a href="http://www.netlib.org/cephes/" target="_top">Cephes</a> 库的比较. 注意: 这些函数的周期性意味着它们具有无限个数的无理根: 一般来说当参数足够接近根的时候这些函数具在任意大的相对误差. 当然在这种情况下绝对误差永远都很小. 注意：在那些将宽浮点类型给定为窄浮点类型的系统上，函数的返回值具有<a href="../../backgrounders/relative_error.html#zero_error">有效的零误差</a>. 所有结果的相对误差都是10的-5次方数量级。</p>
<div class="table">
<a name="id711080"></a>
<p class="title"><b>表38. cyl_bessel_i出错率(Errors Rates)</b></p>
<div class="table-contents"><table class="table" summary="Errors Rates in cyl_bessel_i">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
              <p>
                有效数字位数</p>
            </th>
<th>
              <p>
                平台和编译器</p>
            </th>
<th>
              <p>
                I<sub>v</sub>
              </p>
            </th>
</tr></thead>
<tbody>
<tr>
<td>
              <p>
                53
              </p>
            </td>
<td>
              <p>
                Win32 / Visual C++ 8.0
              </p>
            </td>
<td>
              <p>
                峰值=10 均值=3.4 GSL 峰值=6000
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                Red Hat Linux IA64 / G++ 3.4
              </p>
            </td>
<td>
              <p>
                峰值=11 均值=3
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                SUSE Linux AMD64 / G++ 4.1
              </p>
            </td>
<td>
              <p>
                峰值=11 均值=4
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                113
              </p>
            </td>
<td>
              <p>
                HP-UX / HP aCC 6
              </p>
            </td>
<td>
              <p>
                峰值=15 圴值=4
              </p>
            </td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><div class="table">
<a name="id711235"></a>
<p class="title"><b>表39. cyl_bessel_k出错率<b>(Errors Rates)</b></b></p>
<div class="table-contents"><table class="table" summary="Errors Rates in cyl_bessel_k">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead><tr>
<th>
              <p>
                有效数字位数</p>            </th>
<th>
              <p>
                平台和编译器</p>
            </th>
<th>
              <p>
                K<sub>v</sub>
              </p>
            </th>
</tr></thead>
<tbody>
<tr>
<td>
              <p>
                53
              </p>
            </td>
<td>
              <p>
                Win32 / Visual C++ 8.0
              </p>
            </td>
<td>
              <p>
                峰值=9 均值=2
              </p>
              <p>
                GSL 峰值=9
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                Red Hat Linux IA64 / G++ 3.4
              </p>
            </td>
<td>
              <p>
                峰值=10 均值=2
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                64
              </p>
            </td>
<td>
              <p>
                SUSE Linux AMD64 / G++ 4.1
              </p>
            </td>
<td>
              <p>
                峰值=10 均值=2
              </p>
            </td>
</tr>
<tr>
<td>
              <p>
                113
              </p>
            </td>
<td>
              <p>
                HP-UX / HP aCC 6
              </p>
            </td>
<td>
              <p>
                峰值=12 均值=5
              </p>
            </td>
</tr>
</tbody>
</table></div>
</div>
<br class="table-break"><a name="math_toolkit.special.bessel.mbessel.implementation"></a>
<h5>
<a name="id711403"></a>
          <a href="mbessel.html#math_toolkit.special.bessel.mbessel.implementation">实现</a>
  </h5>
<p>
          下面的情况首先作为特殊情况进行处理:
  </p>
<p>
          当 <span class="emphasis"><em>x &lt; 0</em></span>时计算I<sub>v</sub> , &#957; 必须是一个整数
          否则会产生一个定义域错误. 如果&#957; 是一个整数, 那么当 &#957; 是奇数的时候函数是奇函数，当&#957; 是偶数的时候函数是偶函数, 这里要求符合<span class="emphasis"><em>x &gt; 0</em></span>.
  </p>
<p>
          对于 I<sub>v</sub> ，当 v等于 0, 1 或 0.5 时，作为特殊情况处理。</p>
<p>
          v = 0 和 v = 1的情况使用在有限和无限区间上的有理数极值逼近的方法. 系数来自于:
  </p>
<div class="itemizedlist"><ul type="disc">
<li>
            J.M. Blair and C.A. Edwards, <span class="emphasis"><em>Stable rational minimax approximations
            to the modified Bessel functions I_0(x) and I_1(x)</em></span>, Atomic
            Energy of Canada Limited Report 4928, Chalk River, 1974.
      </li>
<li>
            S. Moshier, <span class="emphasis"><em>Methods and Programs for Mathematical Functions</em></span>,
            Ellis Horwood Ltd, Chichester, 1989.
      </li>
</ul></div>
<p>
          而 v = 0.5 的情况是一个简单的三角函数:
  </p>
<p>
          I<sub>0.5</sub>(x) = sqrt(2 / &#960;x) * sinh(x)
  </p>
<p>
          对于 K<sub>v</sub> ，当 <span class="emphasis"><em>v</em></span> 是一个整数时, 结果使用递归关系来计算:
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel5.png"></span>
  </p>
<p>
          从 K<sub>0</sub> 和 K<sub>1</sub> 开始使用上面的有理数逼近来计算. 这些有理数逼近的精度为 19 个数字,
          因此仅当 T 的精度为不超过64个有效数字时才使用这种方法.
  </p>
<p>
          通常情况下, 我们首先使用反射方程将&#957;正规化到区间 [<code class="literal">0, [inf</code>])
          :
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel9.png"></span>
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel10.png"></span>
  </p>
<p>
          设&#956; = &#957; - floor(&#957; + 1/2), 那么&#956; 就是 &#957; 的小数部分且满足 |&#956;| &lt;=
          1/2 (我们需要这一点用于后面的收敛性). 这个思路是计算K<sub>&#956;</sub>(x)
          和 K<sub>&#956;+1</sub>(x), 然后用它们来计算I<sub>&#957;</sub>(x) 和 K<sub>&#957;</sub>(x).
  </p>
<p>
          这个算法求Temme 在 N.M. Temme, <span class="emphasis"><em>On the numerical
          evaluation of the modified bessel function of the third kind</em></span>,
          Journal of Computational Physics, vol 19, 324 (1975)中发表, 需要两个连分数以及Wronskian:
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel11.png"></span>
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel12.png"></span>
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel8.png"></span></p>
<p><span class="inlinemediaobject">连分数使用修正的 Lentz's 算法来获得 (W.J. Lentz, <span class="emphasis"><em>Generating Bessel functions in Mie scattering calculations using continued fractions</em></span>, Applied Optics, vol 15, 668 (1976)). 收敛半径依赖于<span class="emphasis"><em>x</em></span>,因此对于大数<span class="emphasis"><em>x</em></span> 和小数<span class="emphasis"><em>x</em></span>. 我们需要使用不同的策略</span></p>
<p>
          <span class="emphasis"><em>x &gt; v</em></span>, CF1 需要 O(<span class="emphasis"><em>x</em></span>)步来收敛, CF2 快速收敛</p>
<p>
          <span class="emphasis"><em>x &lt;= v</em></span>, CF1 快速收敛, 当 <span class="emphasis"><em>x</em></span> <code class="literal">-&gt;</code> 0 时，CF2不能收敛</p>
<p>
          当<span class="emphasis"><em>x</em></span> 较大时(<span class="emphasis"><em>x</em></span> &gt; 2), 连续分数收敛 (对于 大数 <span class="emphasis"><em>x </em></span>,CF1可能收敛很慢).
          K<sub>&#956;</sub> 和 K<sub>&#956;+1</sub>
可以通过下面的方程计算</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel13.png"></span>
  </p>
<p>
          其中</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel14.png"></span>
  </p>
<p>
          <span class="emphasis"><em>S</em></span>是一个与 CF2同时求和的级数,
          参见 I.J. Thompson and A.R. Barnett, <span class="emphasis"><em>Modified Bessel functions
          I_v and K_v of real order and complex argument to selected accuracy</em></span>,
          Computer Physics Communications, vol 47, 245 (1987).
  </p>
<p>
          当<span class="emphasis"><em>x</em></span> 较小 (<span class="emphasis"><em>x</em></span> &lt;= 2), CF2 可能无法收敛 (但 CF1 可以收敛). 解为 Temme 级数:
  </p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel15.png"></span>
  </p>
<p>
          其中</p>
<p>
          <span class="inlinemediaobject"><img src="../../../../equations/mbessel16.png"></span>
  </p>
<p>
          f<sub>k</sub> 和 h<sub>k</sub>
也使用递归来计算 (包括 γ 函数), 但是方程稍有些复杂, 读者可以参见 N.M. Temme,
  <span class="emphasis"><em>On the numerical evaluation of the modified Bessel function of the third kind</em></span>, Journal of Computational Physics, vol 19, 324 (1975). 注意 Temme 级数 仅对 |&#956;| &lt;= 1/2收敛.</p>
<p>
          K<sub>&#957;</sub>(x) 使用前向递归来计算, K<sub>&#957;+1</sub>(x)也是这样的.使用这两个值和 f<sub>&#957;</sub>, Wronskian 直接生成 I<sub>&#957;</sub>(x) .
  </p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright ?2006 , 2007, 2008 John Maddock, Paul A. Bristow, Hubert
      Holin, Xiaogang Zhang and Bruno Lalande<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="bessel.html"><img src="../../../../../../../../doc/html/images/prev.png" alt="Prev"></a><a accesskey="u" href="../bessel.html"><img src="../../../../../../../../doc/html/images/up.png" alt="Up"></a><a accesskey="h" href="../../../index.html"><img src="../../../../../../../../doc/html/images/home.png" alt="Home"></a><a accesskey="n" href="sph_bessel.html"><img src="../../../../../../../../doc/html/images/next.png" alt="Next"></a>
</div>
</body>
</html>
